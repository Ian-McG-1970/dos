     1                                  ; nasm cga_line_v7.asm -o cgaline.com -f bin
     2                                  
     3                                  
     4                                  ; list of next line tables - even values = +8192 odd values = -8192 - put into 2 registers - swap registers after each next line
     5                                  
     6                                  VIDEO_SEGMENT	equ	0b800h 	; display memory segment for true CGA graphics modes
     7                                  SW				equ 80 		; screen width
     8                                  SE				equ	0		; screen even start
     9                                  SO				equ	8192	; screen odd start
    10                                  
    11                                  INPUT_STATUS_1	equ	03dah	; VGA status register
    12                                  VSYNC_MASK	equ	08h	; vertical sync bit in status register 1
    13                                  DE_MASK		equ	01h	; display enable bit in status register 1
    14                                  
    15                                  MAP_MASK	equ	2		; SC map mask register
    16                                  SC_INDEX		equ	3c4h	; SC index register
    17                                   
    18                                  TOP_CC		equ	1
    19                                  BOTTOM_CC	equ	2
    20                                  LEFT_CC		equ	4
    21                                  RIGHT_CC		equ	8
    22                                  BEHIND_CC	equ	16
    23                                  MIDDLE_X		equ	160
    24                                  MIDDLE_Y		equ	100
    25                                  TOP_EDGE	equ	MIDDLE_Y-100
    26                                  BOTTOM_EDGE	equ	MIDDLE_Y+99
    27                                  LEFT_EDGE	equ	MIDDLE_X-160
    28                                  RIGHT_EDGE	equ	MIDDLE_X+159
    29                                  
    30                                  KEY_ESC	EQU 1bh
    31                                  KEY_Q	EQU 'q'
    32                                  KEY_W	EQU 'w'
    33                                  KEY_E	EQU 'e'
    34                                  KEY_R	EQU 'r'
    35                                  
    36                                  CPU 8086
    37                                  bits 16
    38                                  org 100h
    39                                  
    40                                  section .text
    41                                  
    42                                  start:
    43 00000000 E84900                  	call	BuildScreenTable
    44 00000003 B80500                  	mov	ax,05h ; 04h	; CGA 320 x 200 4 colors ; more 05 instead of mode 04
    45 00000006 CD10                    	int		10h
    46                                  
    47                                  ;	mov	ax,0Bh 	; Pallette
    48                                  ;	mov	bh,1
    49                                  ;	mov	bl,0
    50                                  ;	mov	bx,00000h ; pallette 0 high
    51                                  ;	int	10h 
    52                                  	
    53 00000008 B44A                    	mov	ah, 4ah
    54 0000000A BB0010                  	mov	bx, 1000h
    55 0000000D CD21                    	int	21h
    56 0000000F B448                    	mov	ah, 48h
    57 00000011 BB0010                  	mov	bx, 1000h
    58 00000014 CD21                    	int	21h
    59 00000016 A3[B681]                	mov	[BackBufferSeg], ax
    60                                  
    61 00000019 31C0                    	xor ax,ax
    62 0000001B A2[B881]                	mov	[Exit],al
    63 0000001E 83C002                  	add ax,2
    64 00000021 A3[9481]                	mov	[XAngle],ax
    65 00000024 83C002                  	add ax,2
    66 00000027 A3[9681]                	mov	[YAngle],ax	
    67                                  	
    68                                  ;	mov	[Test0],ax
    69                                  	
    70                                  MainLoop:
    71 0000002A E84602                  		call	WaitVSync
    72 0000002D E85102                  		call	CopyClearBackBuffer
    73                                  	
    74 00000030 8B1E[B681]              		mov		bx,[BackBufferSeg]
    75 00000034 8EC3                    		mov		es,bx
    76                                  
    77 00000036 E82F00                  		call	Horizon
    78                                  
    79                                  ;		mov		bl,0
    80                                  ;		mov		ax,[XAngle]
    81                                  ;		call	Hex16
    82                                  ;		mov		bl,1
    83                                  ;		mov		ax,[YAngle]
    84                                  ;		call	Hex16
    85                                  ;		mov		bl,3
    86                                  ;		mov		ax,[SinX]
    87                                  ;		call	Hex16
    88                                  ;		mov		bl,4
    89                                  ;		mov		ax,[CosX]
    90                                  ;		call	Hex16
    91                                  ;		mov		bl,6
    92                                  ;		mov		ax,[SinY]
    93                                  ;		call	Hex16
    94                                  ;		mov		bl,7
    95                                  ;		mov		ax,[CosY]
    96                                  ;		call	Hex16
    97                                  
    98                                  ;		mov		bl,9
    99                                  ;		mov		ax,[Test0]
   100                                  ;		call	Hex16
   101                                  ;		mov		bl,10
   102                                  ;		mov		ax,[Test1]
   103                                  ;		call	Hex16
   104                                  ;		mov		bl,11
   105                                  ;		mov		ax,[Test2]
   106                                  ;		call	Hex16
   107                                  ;		mov		bl,12
   108                                  ;		mov		ax,[Test3]
   109                                  ;		call	Hex16
   110                                  ;		mov		bl,13
   111                                  ;		mov		ax,[Test4]
   112                                  ;		call	Hex16
   113                                  ;		mov		bl,15
   114                                  ;		mov		ax,[Test5]
   115                                  ;		call	Hex16
   116                                  
   117                                  ;		mov		bl,22
   118                                  ;		mov		ax,[Test6]
   119                                  ;		call	Hex16
   120                                  ;		mov		bl,23
   121                                  ;		mov		ax,[Test7]
   122                                  ;		call	Hex16
   123                                  ;		mov		bl,24
   124                                  ;		mov		ax,[Test8]
   125                                  ;		call	Hex16
   126                                  ;		mov		bl,25
   127                                  ;		mov		ax,[Test9]
   128                                  ;		call	Hex16
   129                                  ;		mov		bl,26
   130                                  ;		mov		ax,[Test10]
   131                                  ;		call	Hex16
   132                                  
   133                                  ;		mov		bl,29
   134                                  ;		mov		ax,[BackBufferSeg]
   135                                  ;		call	Hex16
   136                                  
   137                                  ;		mov		bl,30
   138                                  ;		mov		ax,[Test11]
   139                                  ;		call	Hex16
   140                                  
   141                                  ;		call	BuildRotateMatrixV2
   142                                  
   143 00000039 E8E501                  		call	GetKey
   144                                  		
   145 0000003C A0[B881]                	mov		al,[Exit]
   146 0000003F 08C0                    	or	al,al
   147 00000041 74E7                    	je		MainLoop
   148                                  
   149 00000043 B80300                  Done:	mov		ax,3	; reset to text mode
   150 00000046 CD10                    		int		10h
   151 00000048 B44C                    		mov		ah,4ch	; exit to DOS
   152 0000004A CD21                    		int		21h
   153                                  
   154 0000004C 8D3E[0000]              BuildScreenTable:	lea		di,[BackBufferTable]
   155 00000050 31ED                    					xor		bp,bp	; even lines
   156 00000052 B96400                  					mov		cx,100
   157 00000055 892D                    .loop:					mov		[di],bp
   158 00000057 81C50020                						add		bp,8192
   159 0000005B 896D02                  						mov		[di+2],bp
   160 0000005E 81EDB01F                						sub		bp,8192-80
   161 00000062 83C704                  						add		di,4
   162 00000065 E2EE                    						loop	.loop
   163 00000067 C3                      					ret
   164                                  
   165                                  Horizon:
   166 00000068 8B2E[9481]              		mov		bp,[XAngle]	; roll
   167 0000006C E89002                  		call	SinCosV2
   168 0000006F 892E[9881]              		mov		[SinX],bp
   169 00000073 A3[9A81]                		mov		[CosX],ax
   170                                  		
   171 00000076 89C1                    		mov		cx,ax		; CosX
   172 00000078 B8A000                  		mov		ax,160
   173 0000007B F7ED                    		imul	bp			; *SinX - could be replaced with (bp*128) + (bp*32)
   174 0000007D F7F9                    		idiv	cx
   175 0000007F A3[A081]                		mov		[HorEdge],ax
   176                                  
   177 00000082 8B1E[9681]              		mov		bx,[YAngle]	; pitch
   178 00000086 81E3FE03                		and		bx,1022 	; = 511*2
   179 0000008A 8B9F[8007]              		mov		bx,[HorizonTable+bx]
   180                                  
   181 0000008E 892E[B481]              		mov		[HorDir],bp
   182 00000092 85ED                    		test	bp,bp
   183 00000094 780D                    		js		.slpe_n
   184                                  
   185 00000096 89DD                    .slpe_p		mov		bp,bx
   186 00000098 01C3                    			add		bx,ax
   187 0000009A 29C5                    			sub		bp,ax
   188                                  
   189 0000009C 31D2                    			xor		dx,dx
   190 0000009E B93F01                  			mov		cx,RIGHT_EDGE
   191                                  
   192 000000A1 EB0B                    			jmp		.slpe_c
   193                                  
   194 000000A3 89DD                    .slpe_n		mov		bp,bx
   195 000000A5 01C5                    			add		bp,ax
   196 000000A7 29C3                    			sub		bx,ax
   197                                  
   198 000000A9 31C9                    			xor		cx,cx
   199 000000AB BA3F01                  			mov		dx,RIGHT_EDGE
   200                                  		
   201 000000AE 8916[A281]              .slpe_c	mov		[XST],dx
   202 000000B2 892E[A481]              		mov		[YST],bp
   203 000000B6 890E[A681]              		mov		[XEN],cx
   204 000000BA 891E[A881]              		mov		[YEN],bx
   205                                  
   206 000000BE 85DB                    		test	bx,bx	; bottom if off top
   207 000000C0 7903E94601              		js		.fill_whole_sky
   208                                  
   209 000000C5 81FDC700                		cmp		bp,BOTTOM_EDGE	; top if off bottom
   210 000000C9 7E03E94801              		jg		.fill_whole_ground
   211                                  
   212 000000CE 85ED                    		test	bp,bp		; is top off top
   213 000000D0 791C                    		jns		.clpt_c		; no
   214 000000D2 89C8                    			mov		ax,cx
   215 000000D4 29D0                    			sub		ax,dx	;	ax=(endx-sttx) = (cx-dx)
   216 000000D6 89DE                    			mov		si,bx
   217 000000D8 29EE                    			sub		si,bp	;	si=(endy-stty) = (bx-bp)
   218                                  
   219 000000DA 89D7                    			mov		di,dx	; backup sttx
   220                                  
   221 000000DC F7ED                    			imul	bp		; 	ax = ( (ex-sx) *sy)
   222 000000DE F7FE                    			idiv	si		; 	ax = ( ( (ex-sx) *sy ) / (ey-sy) )
   223 000000E0 29C7                    			sub		di,ax	;	sx = sx - ( ( (ex-sx) *sy ) / (ey-sy) );
   224 000000E2 893E[A281]              			mov		[XST],di
   225 000000E6 31ED                    			xor		bp,bp
   226 000000E8 892E[A481]              			mov		[YST],bp
   227 000000EC EB14                    			jmp		.clpt_e
   228                                  
   229 000000EE 7412                    .clpt_c		je	.clpt_e		; is top on the top edge
   230 000000F0 89EE                    				mov		si,bp	; backup
   231 000000F2 51                      				push	cx
   232 000000F3 53                      				push	bx
   233                                  
   234 000000F4 89EB                    				mov		bx,bp
   235 000000F6 31ED                    				xor		bp,bp
   236 000000F8 B8AAAA                  				mov		ax,1010101010101010b ; 1001110001111000b
   237 000000FB E8B701                  				call	FillBlock
   238                                  
   239 000000FE 5B                      				pop		bx		; restore
   240 000000FF 59                      				pop		cx
   241 00000100 89F5                    				mov		bp,si
   242                                  
   243 00000102 81FBC700                .clpt_e cmp		bx,BOTTOM_EDGE
   244 00000106 7E21                    		jle		.clpb_c
   245                                  
   246 00000108 89C8                    			mov		ax,cx
   247 0000010A 29D0                    			sub		ax,dx	;	ax=(endx-sttx) = (cx-dx)
   248 0000010C 89DE                    			mov		si,bx
   249 0000010E 29EE                    			sub		si,bp	;	si=(endy-stty) = (bx-bp)
   250                                  
   251 00000110 89DF                    			mov		di,bx	
   252 00000112 81EFC700                			sub		di,BOTTOM_EDGE	; di = (endy-DIBHeight) = (bx-BOTTOM_EDGE)
   253                                  
   254 00000116 F7EF                    			imul	di		; 	ax = ( (ex-sx) * (ey-DIBHeight) )
   255 00000118 F7FE                    			idiv	si		; 	ax = ( ( (ex-sx) * (ey-DIBHeight) ) / (ey-sy) )
   256 0000011A 29C1                    			sub		cx,ax	;	ex = ex - ( ( (ex-sx) * (ey-DIBHeight) ) / (ey-sy) );
   257 0000011C 890E[A681]              			mov		[XEN],cx
   258 00000120 BBC700                  			mov		bx,BOTTOM_EDGE
   259 00000123 891E[A881]              			mov		[YEN],bx
   260 00000127 EB17                    			jmp		.clpb_e
   261                                  
   262 00000129 7415                    .clpb_c:	je	.clpb_e		; is bottom on the bottom edge
   263                                  
   264 0000012B 89EE                    				mov		si,bp	; backup
   265 0000012D 51                      				push	cx
   266 0000012E 53                      				push	bx
   267                                  
   268 0000012F BDC700                  .				mov		bp,BOTTOM_EDGE
   269 00000132 29DD                    				sub		bp,bx
   270 00000134 87EB                    				xchg	bp,bx
   271                                  ;		mov [Test9],bx
   272                                  ;		mov [Test10],bp
   273 00000136 B85555                  				mov		ax,0101010101010101b ; 1001110001111000b ; 0101010101010101b ; 1001110001111000b
   274 00000139 E87901                  				call	FillBlock
   275                                  
   276 0000013C 5B                      				pop		bx		; restore
   277 0000013D 59                      				pop		cx
   278 0000013E 89F5                    				mov		bp,si
   279                                  
   280                                  ; hdiff = xen-xst
   281                                  ; vdiff = yen-yst
   282                                  
   283                                  ; (hdiff *128) / (vdiff/2)
   284                                  
   285                                  .clpb_e:
   286 00000140 8B0E[A281]              		mov		cx,[XST]
   287 00000144 8B16[A481]              		mov		dx,[YST]
   288 00000148 8B2E[A681]              		mov		bp,[XEN]
   289 0000014C 8B36[A881]              		mov		si,[YEN]
   290                                  		
   291                                  ;	mov		[Test1],cx
   292                                  ;	mov		[Test2],dx
   293                                  ;	mov		[Test3],bp
   294                                  ;	mov		[Test4],si
   295                                  
   296                                  ;		call	Line11
   297                                  
   298 00000150 8B0E[A881]              		mov		cx,[YEN]
   299 00000154 8B1E[A481]              		mov		bx,[YST]
   300 00000158 29D9                    		sub		cx,bx
   301 0000015A 890E[B081]              		mov		[VDiff],cx
   302                                  ;	mov		[Test9],cx ; vdiff
   303                                  
   304                                  ;		sar		cx,1
   305                                  ;		mov		[Test10],cx ; vdiff /2
   306 0000015E 7507                    		jne		.lne_c
   307 00000160 31C0                    			xor		ax,ax
   308 00000162 A3[B281]                			mov		[Slope],ax
   309 00000165 EB2E                    			jmp		.cont
   310                                  
   311 00000167 8B2E[B481]              .lne_c:	mov		bp,[HorDir]
   312 0000016B 85ED                    		test	bp,bp
   313 0000016D 790B                    		jns		.lft_ln
   314 0000016F A1[A281]                			mov		ax,[XST]
   315 00000172 8B1E[A681]              			mov		bx,[XEN]
   316 00000176 29D8                    			sub		ax,bx
   317 00000178 EB09                    			jmp		.cnt1
   318                                  .lft_ln:
   319 0000017A A1[A681]                			mov		ax,[XEN]
   320 0000017D 8B1E[A281]              			mov		bx,[XST]
   321 00000181 29D8                    			sub		ax,bx
   322                                  
   323 00000183 A3[AE81]                .cnt1:	mov		[HDiff],ax
   324                                  ;	mov		[Test8],ax
   325 00000186 B107                    		mov		cl,7
   326 00000188 D3E0                    		sal		ax,cl		; hdiff *128
   327 0000018A 31D2                    		xor 	dx,dx
   328                                  ;	mov		[Test7],ax
   329 0000018C 8B0E[B081]              		mov		cx,[VDiff]
   330                                  ;	mov		cx,[Test10]
   331 00000190 F7F1                    		div		cx
   332                                  ;;		add ax,ax
   333                                  ;	mov		[Test6],ax
   334 00000192 A3[B281]                		mov		[Slope],ax
   335                                  
   336                                  .cont:
   337 00000195 A1[B081]                		mov		ax,[VDiff]
   338 00000198 85C0                    		test	ax,ax
   339 0000019A 746E                    		je		.no_slope
   340                                  
   341 0000019C 8B16[A281]              		mov		dx,[XST]
   342 000001A0 B107                    		mov		cl,7
   343 000001A2 D3E2                    		sal		dx,cl
   344                                  
   345 000001A4 88C4                    		mov		ah,al
   346                                  		
   347 000001A6 8B2E[A481]              		mov		bp,[YST]
   348 000001AA 01ED                    		add		bp,bp
   349                                  	
   350 000001AC 8B36[B281]              		mov		si,[Slope]
   351                                  	
   352 000001B0 8B1E[B481]              		mov		bx,[HorDir]
   353 000001B4 85DB                    		test	bx,bx
   354 000001B6 7829                    		js		.fillnlp
   355                                  
   356 000001B8 8BBE[0000]              .fillplp:	mov		di,[BackBufferTable+bp]
   357 000001BC 89D3                    			mov		bx,dx
   358 000001BE B107                    			mov		cl,7
   359 000001C0 D3EB                    			shr		bx,cl
   360                                  
   361 000001C2 8A8F[8002]              			mov		cl,[FillTabLeft+bx]
   362 000001C6 B055                    			mov		al,01010101b
   363 000001C8 F3AA                    			rep		stosb
   364                                  
   365 000001CA 8A87[0000]              			mov 	al,[FillCharLeftTab+bx]
   366 000001CE AA                      			stosb
   367                                  
   368 000001CF 8A8F[C003]              			mov		cl,[FillTabRight+bx]
   369 000001D3 B0AA                    			mov		al,10101010b
   370 000001D5 F3AA                    			rep		stosb
   371                                  
   372 000001D7 83C502                  			add		bp,2
   373 000001DA 01F2                    			add		dx,si
   374 000001DC FECC                    			dec		ah
   375 000001DE 75D8                    			jnz		.fillplp
   376 000001E0 C3                      		ret
   377                                  
   378 000001E1 8BBE[0000]              .fillnlp:	mov		di,[BackBufferTable+bp]
   379 000001E5 89D3                    			mov		bx,dx
   380 000001E7 B90700                  			mov		cx,7
   381 000001EA D3EB                    			shr		bx,cl
   382                                  
   383 000001EC 8A8F[8002]              			mov		cl,[FillTabLeft+bx]
   384 000001F0 B0AA                    			mov		al,10101010b
   385 000001F2 F3AA                    			rep		stosb
   386                                  
   387 000001F4 8A87[4001]              			mov 	al,[FillCharRightTab+bx]
   388 000001F8 AA                      			stosb
   389                                  
   390 000001F9 8A8F[C003]              			mov		cl,[FillTabRight+bx]
   391 000001FD B055                    			mov		al,01010101b
   392 000001FF F3AA                    			rep		stosb
   393                                  
   394 00000201 83C502                  			add		bp,2
   395 00000204 29F2                    			sub		dx,si
   396 00000206 FECC                    			dec		ah
   397 00000208 75D7                    			jnz		.fillnlp
   398                                  
   399                                  .no_slope:
   400 0000020A C3                      		ret
   401                                  
   402 0000020B B85555                  .fill_whole_sky:	mov		ax,0101010101010101b
   403 0000020E 31ED                    					xor		bp,bp
   404 00000210 BBC800                  					mov		bx,200
   405 00000213 E99F00                  					jmp		FillBlock
   406                                  
   407 00000216 B8AAAA                  .fill_whole_ground:	mov		ax,1010101010101010b
   408 00000219 31ED                    					xor		bp,bp
   409 0000021B BBC800                  					mov		bx,200
   410 0000021E E99400                  					jmp		FillBlock
   411                                  
   412                                  
   413                                  ;fill_blocks
   414                                  ; if hst ne 0
   415                                  ; calc lines = hst
   416                                  ; fill top block (0(bp),lines=bx,colour(ax))
   417                                  ; endif
   418                                  ; if hend ne 199
   419                                  ; fill bottom block(hen(bp),(199-hen)=bx,colour(ax))
   420                                  ; endif
   421                                  
   422                                  ;Fill_Block:
   423                                  ;	inc
   424                                  	
   425                                  ; fill block()
   426                                  ; inc bl (number of lines)
   427                                  ; bl/2 (number of lines/2)
   428                                  ; di = vertab(bp) start line
   429                                  ; cx= wordcounttab(bx) (number of lines *40 (words))
   430                                  ; rep stosw (40*cx)
   431                                  ; di = vertab(bp+1) start line other page
   432                                  ; cx= wordcounttab(bx) (number of lines *40 (words))
   433                                  ; rep stosw (40*cx)
   434                                  ; ret
   435                                  
   436                                  GetKey:
   437 00000221 B411                    	mov	ah,11h
   438 00000223 CD16                    	int	16h         	; has a key been pressed
   439 00000225 7418                    	jz	.key_none ; no
   440 00000227 B410                    	mov	ah,10h      ; yes 
   441 00000229 CD16                    	int	16h         	; get it in AX (al= ascii, ah=scan code)
   442 0000022B 3C1B                    	cmp	al,KEY_ESC
   443 0000022D 7411                    	je	.key_esc
   444 0000022F 3C71                    	cmp 	al,KEY_Q
   445 00000231 7413                    	je 	.key_q
   446 00000233 3C77                    	cmp 	al,KEY_W
   447 00000235 741A                    	je 	.key_w
   448 00000237 3C65                    	cmp 	al,KEY_E
   449 00000239 7421                    	je 	.key_e
   450 0000023B 3C72                    	cmp 	al,KEY_R
   451 0000023D 7428                    	je 	.key_r
   452                                  .key_none:
   453 0000023F C3                      	ret
   454 00000240 B001                    .key_esc:	mov	al,1
   455 00000242 A2[B881]                		mov	[Exit],al
   456 00000245 C3                      		ret
   457 00000246 A1[9481]                .key_q:	mov	ax,[XAngle]
   458 00000249 40                      		inc	ax
   459 0000024A 80E403                  		and ah,03
   460 0000024D A3[9481]                		mov	[XAngle],ax
   461 00000250 C3                      		ret
   462 00000251 A1[9481]                .key_w:	mov	ax,[XAngle]
   463 00000254 48                      		dec	ax
   464 00000255 80E403                  		and ah,3
   465 00000258 A3[9481]                		mov	[XAngle],ax
   466 0000025B C3                      		ret
   467 0000025C A1[9681]                .key_e:	mov	ax,[YAngle]
   468 0000025F 40                      		inc	ax
   469 00000260 80E403                  		and ah,3
   470 00000263 A3[9681]                		mov	[YAngle],ax
   471 00000266 C3                      		ret
   472 00000267 A1[9681]                .key_r:	mov	ax,[YAngle]
   473 0000026A 48                      		dec	ax
   474 0000026B 80E403                  		and ah,3
   475 0000026E A3[9681]                		mov	[YAngle],ax
   476 00000271 C3                      		ret
   477 00000272 C3                      		ret
   478                                  
   479 00000273 BADA03                  WaitVSync: 			mov		dx,INPUT_STATUS_1	; Wait for the leading edge of vertical sync pulse.
   480 00000276 EC                      WaitNotVSyncLoop:		in		al,dx
   481 00000277 2408                    						and		al,VSYNC_MASK
   482 00000279 75FB                    						jnz		WaitNotVSyncLoop
   483 0000027B EC                      WaitVSyncLoop:			in		al,dx
   484 0000027C 2408                    						and		al,VSYNC_MASK
   485 0000027E 74FB                    						jz		WaitVSyncLoop
   486 00000280 C3                      					ret
   487                                  		
   488                                  CopyClearBackBuffer:
   489 00000281 FC                      	cld
   490                                  
   491 00000282 8CDD                    	mov		bp,ds			; backup ds
   492                                  
   493 00000284 8B16[B681]              	mov		dx,[BackBufferSeg]
   494 00000288 8EDA                    	mov		ds,dx
   495                                  
   496 0000028A B800B8                  	mov		ax,VIDEO_SEGMENT
   497 0000028D 8EC0                    	mov		es,ax
   498                                  
   499 0000028F 31F6                    	xor		si,si		; DS:SI points to even back buffer
   500 00000291 89F7                    	mov		di,si		; ES:DI points to CGA memory.
   501                                  
   502 00000293 B9A00F                  	mov		cx,4000
   503 00000296 F3A5                    	rep	movsw			; copy from ds:si to es:di
   504                                  
   505 00000298 BE0020                  	mov		si,8192		; DS:SI points to odd back buffer
   506 0000029B 89F7                    	mov		di,si		; ES:DI points to CGA memory.
   507                                  
   508 0000029D B9A00F                  	mov		cx,4000
   509 000002A0 F3A5                    	rep	movsw			; copy from ds:si to es:di
   510                                  
   511 000002A2 8CD8                    	mov		ax,ds		; es points to ds
   512 000002A4 8EC0                    	mov		es,ax
   513 000002A6 8EDD                    	mov		ds,bp			; restore ds
   514                                  
   515                                  ;	call	ClearScreen
   516                                  
   517 000002A8 C3                      	ret
   518                                  
   519                                  ClearScreen:
   520 000002A9 B8782D                  	mov		ax,0010110101111000b
   521 000002AC 31ED                    	xor		bp,bp
   522 000002AE BBC800                  	mov		bx,200
   523 000002B1 E80100                  	call	FillBlock
   524 000002B4 C3                      	ret
   525                                  
   526                                  FillBlock:
   527 000002B5 FEC3                    	inc		bl
   528 000002B7 80E3FE                  	and		bl,255-1
   529 000002BA 01ED                    	add		bp,bp
   530                                  
   531 000002BC 8BBE[0000]              	mov		di,[BackBufferTable+bp]
   532 000002C0 8B8F[800B]              	mov		cx,[FillBlockTab+bx]
   533 000002C4 F3AB                    	rep		stosw
   534                                  
   535 000002C6 8BBE[0200]              	mov		di,[BackBufferTable+2+bp]
   536 000002CA 8B8F[800B]              	mov		cx,[FillBlockTab+bx]
   537 000002CE F3AB                    	rep		stosw
   538                                  
   539 000002D0 C3                      	ret
   540                                  
   541                                  
   542                                  ;fill_blocks
   543                                  ; if hst ne 0
   544                                  ; calc lines = hst
   545                                  ; fill top block (0(bp),lines=bx,colour(ax))
   546                                  ; endif
   547                                  ; if hend ne 199
   548                                  ; fill bottom block(hen(bp),(199-hen)=bx,colour(ax))
   549                                  ; endif
   550                                  
   551                                  ;Fill_Block:
   552                                  ;	inc
   553                                  	
   554                                  ; fill block()
   555                                  ; inc bl (number of lines)
   556                                  ; bl/2 (number of lines/2)
   557                                  ; di = vertab(bp) start line
   558                                  ; cx= wordcounttab(bx) (number of lines *40 (words))
   559                                  ; rep stosw (40*cx)
   560                                  ; di = vertab(bp+1) start line other page
   561                                  ; cx= wordcounttab(bx) (number of lines *40 (words))
   562                                  ; rep stosw (40*cx)
   563                                  ; ret
   564                                  
   565 000002D1 80FF00                  GetSin256:	cmp		bh,0
   566 000002D4 740A                    			je		.s000090
   567 000002D6 80FF01                  .s090180:	cmp		bh,1
   568 000002D9 750A                    			jne		.s180270
   569 000002DB 30FF                    				xor		bh,bh
   570 000002DD 80F3FF                  				xor		bl,255
   571 000002E0 8A87[980C]              .s000090		mov		al,[sintab+bx]
   572 000002E4 C3                      				ret
   573 000002E5 80FF02                  .s180270:	cmp		bh,2
   574 000002E8 7509                    			jne		.s270000
   575 000002EA 30FF                    				xor		bh,bh
   576 000002EC 8A87[980C]              				mov		al,[sintab+bx]
   577 000002F0 F6D8                    				neg		al
   578 000002F2 C3                      				ret
   579 000002F3 30FF                    .s270000:	xor		bh,bh
   580 000002F5 80F3FF                  			xor		bl,255
   581 000002F8 8A87[980C]              			mov		al,[sintab+bx]
   582 000002FC F6D8                    			neg		al
   583 000002FE C3                      			ret
   584                                  
   585 000002FF 89EB                    SinCosV2:	mov		bx,bp
   586 00000301 E8CDFF                  			call	GetSin256
   587 00000304 98                      			cbw
   588 00000305 89EB                    			mov		bx,bp
   589 00000307 89C5                    			mov		bp,ax
   590 00000309 FEC7                    			inc		bh
   591 0000030B 80E703                  			and		bh,3
   592 0000030E E8C0FF                  			call	GetSin256
   593 00000311 98                      			cbw
   594 00000312 C3                      			ret			
   595                                  
   596 00000313 89FE                    HexChar:	mov		si,di
   597 00000315 88C3                    			mov		bl,al
   598 00000317 D0EB                    			shr		bl,1
   599 00000319 D0EB                    			shr		bl,1
   600 0000031B D0EB                    			shr		bl,1
   601 0000031D D0EB                    			shr		bl,1
   602 0000031F 83E30F                  			and		bx,15
   603 00000322 8AA7[480C]              			mov		ah,[Hex0+bx]
   604 00000326 268825                  			mov		[es:di],ah
   605 00000329 81C70020                			add		di,8192
   606 0000032D 8AA7[580C]              			mov		ah,[Hex1+bx]
   607 00000331 268825                  			mov		[es:di],ah
   608 00000334 81EFB01F                			sub		di,8192-80
   609 00000338 8AA7[680C]              			mov		ah,[Hex2+bx]
   610 0000033C 268825                  			mov		[es:di],ah
   611 0000033F 81C70020                			add		di,8192
   612 00000343 8AA7[780C]              			mov		ah,[Hex3+bx]
   613 00000347 268825                  			mov		[es:di],ah
   614 0000034A 81EFB01F                			sub		di,8192-80
   615 0000034E 8AA7[880C]              			mov		ah,[Hex4+bx]
   616 00000352 268825                  			mov		[es:di],ah
   617                                  
   618 00000355 89F7                    			mov		di,si
   619 00000357 47                      			inc		di
   620                                  
   621 00000358 88C3                    			mov		bl,al
   622 0000035A 80E30F                  			and		bl,15
   623 0000035D 8A87[480C]              			mov		al,[Hex0+bx]
   624 00000361 268805                  			mov		[es:di],al
   625 00000364 81C70020                			add		di,8192
   626 00000368 8A87[580C]              			mov		al,[Hex1+bx]
   627 0000036C 268805                  			mov		[es:di],al
   628 0000036F 81EFB01F                			sub		di,8192-80
   629 00000373 8A87[680C]              			mov		al,[Hex2+bx]
   630 00000377 268805                  			mov		[es:di],al
   631 0000037A 81C70020                			add		di,8192
   632 0000037E 8A87[780C]              			mov		al,[Hex3+bx]
   633 00000382 268805                  			mov		[es:di],al
   634 00000385 81EFB01F                			sub		di,8192-80
   635 00000389 8A87[880C]              			mov		al,[Hex4+bx]
   636 0000038D 268805                  			mov		[es:di],al
   637 00000390 C3                      			ret
   638                                  
   639 00000391 50                      Hex32:		push	ax
   640                                  
   641 00000392 52                      			push	dx
   642 00000393 53                      			push	bx
   643 00000394 88F0                    			mov		al,dh
   644 00000396 E84600                  			call	Hex8
   645                                  						
   646 00000399 5B                      			pop		bx
   647 0000039A 5A                      			pop		dx
   648                                  
   649 0000039B 53                      			push	bx
   650 0000039C 88D0                    			mov		al,dl
   651 0000039E BF0200                  			mov		di,2
   652 000003A1 E83D00                  			call	HexByte
   653                                  
   654 000003A4 5B                      			pop		bx
   655 000003A5 58                      			pop		ax
   656                                  
   657 000003A6 50                      			push	ax
   658 000003A7 53                      			push	bx
   659 000003A8 88E0                    			mov		al,ah
   660 000003AA BF0400                  			mov		di,4
   661 000003AD E83100                  			call	HexByte
   662                                  
   663 000003B0 5B                      			pop		bx
   664 000003B1 58                      			pop		ax
   665 000003B2 BF0600                  			mov		di,6
   666 000003B5 EB2A                    			jmp		HexByte	; does ret
   667                                  
   668 000003B7 50                      Hex24:		push	ax
   669 000003B8 53                      			push	bx
   670                                  
   671 000003B9 88F8                    			mov		al,bh
   672 000003BB E82100                  			call	Hex8
   673                                  						
   674 000003BE 5B                      			pop		bx
   675 000003BF 58                      			pop		ax
   676                                  
   677 000003C0 50                      			push	ax
   678 000003C1 53                      			push	bx
   679                                  
   680 000003C2 BF0200                  			mov		di,2
   681 000003C5 E81900                  			call	HexByte
   682                                  
   683 000003C8 5B                      			pop		bx
   684 000003C9 58                      			pop		ax
   685                                  
   686 000003CA 88E0                    			mov		al,ah
   687 000003CC BF0400                  			mov		di,4
   688 000003CF EB10                    			jmp		HexByte	; does ret
   689                                  
   690 000003D1 50                      Hex16:		push	ax
   691 000003D2 53                      			push	bx
   692                                  
   693 000003D3 88E0                    			mov		al,ah
   694 000003D5 E80700                  			call	Hex8
   695                                  						
   696 000003D8 5B                      			pop		bx
   697 000003D9 58                      			pop		ax
   698                                  
   699 000003DA BF0200                  			mov		di,2
   700 000003DD EB02                    			jmp		HexByte ; does ret
   701                                  
   702 000003DF 31FF                    Hex8:		xor		di,di
   703 000003E1 30FF                    HexByte:	xor		bh,bh
   704 000003E3 88DC                    			mov		ah,bl
   705 000003E5 00E4                    			add		ah,ah	; *2
   706 000003E7 00E3                    			add		bl,ah	; *3
   707 000003E9 01DB                    			add		bx,bx	; *6
   708 000003EB 01DB                    			add		bx,bx	; *12
   709 000003ED 03BF[0000]              			add		di,[BackBufferTable+bx]	; lookup start ver
   710 000003F1 E91FFF                  			jmp		HexChar	 ; does ret
   711                                  ;			ret
   712                                  
   713                                  section .data align=8 ; 16 ; 8 ; 16
   714                                  	
   715                                  FillCharLeftTab:
   716                                  %rep    80
   717                                  	db	10101010b,01101010b,01011010b,01010110b
   718                                  %endrep
   717 00000000 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000004 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000008 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 0000000C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000010 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000014 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000018 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 0000001C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000020 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000024 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000028 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 0000002C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000030 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000034 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000038 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 0000003C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000040 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000044 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000048 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 0000004C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000050 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000054 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000058 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 0000005C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000060 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000064 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000068 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 0000006C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000070 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000074 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000078 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 0000007C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000080 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000084 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000088 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 0000008C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000090 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000094 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000098 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 0000009C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000A0 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000A4 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000A8 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000AC AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000B0 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000B4 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000B8 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000BC AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000C0 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000C4 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000C8 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000CC AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000D0 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000D4 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000D8 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000DC AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000E0 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000E4 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000E8 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000EC AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000F0 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000F4 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000F8 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 000000FC AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000100 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000104 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000108 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 0000010C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000110 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000114 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000118 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 0000011C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000120 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000124 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000128 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 0000012C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000130 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000134 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 00000138 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   717 0000013C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   719                                  
   720                                  
   721                                  FillCharRightTab:
   722                                  %rep    80
   723                                  	db	01010101b,10010101b,10100101b,10101001b
   724                                  %endrep
   723 00000140 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000144 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000148 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 0000014C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000150 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000154 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000158 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 0000015C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000160 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000164 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000168 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 0000016C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000170 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000174 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000178 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 0000017C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000180 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000184 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000188 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 0000018C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000190 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000194 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000198 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 0000019C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001A0 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001A4 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001A8 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001AC 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001B0 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001B4 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001B8 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001BC 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001C0 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001C4 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001C8 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001CC 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001D0 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001D4 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001D8 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001DC 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001E0 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001E4 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001E8 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001EC 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001F0 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001F4 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001F8 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 000001FC 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000200 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000204 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000208 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 0000020C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000210 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000214 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000218 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 0000021C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000220 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000224 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000228 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 0000022C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000230 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000234 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000238 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 0000023C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000240 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000244 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000248 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 0000024C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000250 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000254 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000258 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 0000025C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000260 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000264 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000268 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 0000026C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000270 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000274 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 00000278 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   723 0000027C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   725                                  
   726                                  FillTabLeft:
   727 00000280 00000000                	db	0,0,0,0
   728 00000284 01010101                	db	1,1,1,1
   729 00000288 02020202                	db	2,2,2,2
   730 0000028C 03030303                	db	3,3,3,3
   731 00000290 04040404                	db	4,4,4,4
   732 00000294 05050505                	db	5,5,5,5
   733 00000298 06060606                	db	6,6,6,6
   734 0000029C 07070707                	db	7,7,7,7
   735 000002A0 08080808                	db	8,8,8,8
   736 000002A4 09090909                	db	9,9,9,9
   737 000002A8 0A0A0A0A                	db	10,10,10,10
   738 000002AC 0B0B0B0B                	db	11,11,11,11
   739 000002B0 0C0C0C0C                	db	12,12,12,12
   740 000002B4 0D0D0D0D                	db	13,13,13,13
   741 000002B8 0E0E0E0E                	db	14,14,14,14
   742 000002BC 0F0F0F0F                	db	15,15,15,15
   743 000002C0 10101010                	db	16,16,16,16
   744 000002C4 11111111                	db	17,17,17,17
   745 000002C8 12121212                	db	18,18,18,18
   746 000002CC 13131313                	db	19,19,19,19
   747 000002D0 14141414                	db	20,20,20,20
   748 000002D4 15151515                	db	21,21,21,21
   749 000002D8 16161616                	db	22,22,22,22
   750 000002DC 17171717                	db	23,23,23,23
   751 000002E0 18181818                	db	24,24,24,24
   752 000002E4 19191919                	db	25,25,25,25
   753 000002E8 1A1A1A1A                	db	26,26,26,26
   754 000002EC 1B1B1B1B                	db	27,27,27,27
   755 000002F0 1C1C1C1C                	db	28,28,28,28
   756 000002F4 1D1D1D1D                	db	29,29,29,29
   757 000002F8 1E1E1E1E                	db	30,30,30,30
   758 000002FC 1F1F1F1F                	db	31,31,31,31
   759 00000300 20202020                	db	32,32,32,32
   760 00000304 21212121                	db	33,33,33,33
   761 00000308 22222222                	db	34,34,34,34
   762 0000030C 23232323                	db	35,35,35,35
   763 00000310 24242424                	db	36,36,36,36
   764 00000314 25252525                	db	37,37,37,37
   765 00000318 26262626                	db	38,38,38,38
   766 0000031C 27272727                	db	39,39,39,39
   767 00000320 28282828                	db	40,40,40,40
   768 00000324 29292929                	db	41,41,41,41
   769 00000328 2A2A2A2A                	db	42,42,42,42
   770 0000032C 2B2B2B2B                	db	43,43,43,43
   771 00000330 2C2C2C2C                	db	44,44,44,44
   772 00000334 2D2D2D2D                	db	45,45,45,45
   773 00000338 2E2E2E2E                	db	46,46,46,46
   774 0000033C 2F2F2F2F                	db	47,47,47,47
   775 00000340 30303030                	db	48,48,48,48
   776 00000344 31313131                	db	49,49,49,49
   777 00000348 32323232                	db	50,50,50,50
   778 0000034C 33333333                	db	51,51,51,51
   779 00000350 34343434                	db	52,52,52,52
   780 00000354 35353535                	db	53,53,53,53
   781 00000358 36363636                	db	54,54,54,54
   782 0000035C 37373737                	db	55,55,55,55
   783 00000360 38383838                	db	56,56,56,56
   784 00000364 39393939                	db	57,57,57,57
   785 00000368 3A3A3A3A                	db	58,58,58,58
   786 0000036C 3B3B3B3B                	db	59,59,59,59
   787 00000370 3C3C3C3C                	db	60,60,60,60
   788 00000374 3D3D3D3D                	db	61,61,61,61
   789 00000378 3E3E3E3E                	db	62,62,62,62
   790 0000037C 3F3F3F3F                	db	63,63,63,63
   791 00000380 40404040                	db	64,64,64,64
   792 00000384 41414141                	db	65,65,65,65
   793 00000388 42424242                	db	66,66,66,66
   794 0000038C 43434343                	db	67,67,67,67
   795 00000390 44444444                	db	68,68,68,68
   796 00000394 45454545                	db	69,69,69,69
   797 00000398 46464646                	db	70,70,70,70
   798 0000039C 47474747                	db	71,71,71,71
   799 000003A0 48484848                	db	72,72,72,72
   800 000003A4 49494949                	db	73,73,73,73
   801 000003A8 4A4A4A4A                	db	74,74,74,74
   802 000003AC 4B4B4B4B                	db	75,75,75,75
   803 000003B0 4C4C4C4C                	db	76,76,76,76
   804 000003B4 4D4D4D4D                	db	77,77,77,77
   805 000003B8 4E4E4E4E                	db	78,78,78,78
   806 000003BC 4F4F4F4F                	db	79,79,79,79
   807                                  
   808                                  FillTabRight:
   809 000003C0 4F4F4F4F                	db	79,79,79,79,
   810 000003C4 4E4E4E4E                	db	78,78,78,78,
   811 000003C8 4D4D4D4D                	db	77,77,77,77,
   812 000003CC 4C4C4C4C                	db	76,76,76,76,
   813 000003D0 4B4B4B4B                	db	75,75,75,75,
   814 000003D4 4A4A4A4A                	db	74,74,74,74,
   815 000003D8 49494949                	db	73,73,73,73,
   816 000003DC 48484848                	db	72,72,72,72,
   817 000003E0 47474747                	db	71,71,71,71,
   818 000003E4 46464646                	db	70,70,70,70,
   819 000003E8 45454545                	db	69,69,69,69,
   820 000003EC 44444444                	db	68,68,68,68,
   821 000003F0 43434343                	db	67,67,67,67,
   822 000003F4 42424242                	db	66,66,66,66,
   823 000003F8 41414141                	db	65,65,65,65,
   824 000003FC 40404040                	db	64,64,64,64,
   825 00000400 3F3F3F3F                	db	63,63,63,63,
   826 00000404 3E3E3E3E                	db	62,62,62,62,
   827 00000408 3D3D3D3D                	db	61,61,61,61,
   828 0000040C 3C3C3C3C                	db	60,60,60,60,
   829 00000410 3B3B3B3B                	db	59,59,59,59,
   830 00000414 3A3A3A3A                	db	58,58,58,58,
   831 00000418 39393939                	db	57,57,57,57,
   832 0000041C 38383838                	db	56,56,56,56,
   833 00000420 37373737                	db	55,55,55,55,
   834 00000424 36363636                	db	54,54,54,54,
   835 00000428 35353535                	db	53,53,53,53,
   836 0000042C 34343434                	db	52,52,52,52,
   837 00000430 33333333                	db	51,51,51,51,
   838 00000434 32323232                	db	50,50,50,50,
   839 00000438 31313131                	db	49,49,49,49,
   840 0000043C 30303030                	db	48,48,48,48,
   841 00000440 2F2F2F2F                	db	47,47,47,47,
   842 00000444 2E2E2E2E                	db	46,46,46,46,
   843 00000448 2D2D2D2D                	db	45,45,45,45,
   844 0000044C 2C2C2C2C                	db	44,44,44,44,
   845 00000450 2B2B2B2B                	db	43,43,43,43,
   846 00000454 2A2A2A2A                	db	42,42,42,42,
   847 00000458 29292929                	db	41,41,41,41,
   848 0000045C 28282828                	db	40,40,40,40,
   849 00000460 27272727                	db	39,39,39,39,
   850 00000464 26262626                	db	38,38,38,38,
   851 00000468 25252525                	db	37,37,37,37,
   852 0000046C 24242424                	db	36,36,36,36,
   853 00000470 23232323                	db	35,35,35,35,
   854 00000474 22222222                	db	34,34,34,34,
   855 00000478 21212121                	db	33,33,33,33,
   856 0000047C 20202020                	db	32,32,32,32,
   857 00000480 1F1F1F1F                	db	31,31,31,31,
   858 00000484 1E1E1E1E                	db	30,30,30,30,
   859 00000488 1D1D1D1D                	db	29,29,29,29,
   860 0000048C 1C1C1C1C                	db	28,28,28,28,
   861 00000490 1B1B1B1B                	db	27,27,27,27,
   862 00000494 1A1A1A1A                	db	26,26,26,26,
   863 00000498 19191919                	db	25,25,25,25,
   864 0000049C 18181818                	db	24,24,24,24,
   865 000004A0 17171717                	db	23,23,23,23,
   866 000004A4 16161616                	db	22,22,22,22,
   867 000004A8 15151515                	db	21,21,21,21,
   868 000004AC 14141414                	db	20,20,20,20,
   869 000004B0 13131313                	db	19,19,19,19,
   870 000004B4 12121212                	db	18,18,18,18,
   871 000004B8 11111111                	db	17,17,17,17,
   872 000004BC 10101010                	db	16,16,16,16,
   873 000004C0 0F0F0F0F                	db	15,15,15,15,
   874 000004C4 0E0E0E0E                	db	14,14,14,14,
   875 000004C8 0D0D0D0D                	db	13,13,13,13,
   876 000004CC 0C0C0C0C                	db	12,12,12,12,
   877 000004D0 0B0B0B0B                	db	11,11,11,11,
   878 000004D4 0A0A0A0A                	db	10,10,10,10,
   879 000004D8 09090909                	db	9,9,9,9
   880 000004DC 08080808                	db	8,8,8,8
   881 000004E0 07070707                	db	7,7,7,7
   882 000004E4 06060606                	db	6,6,6,6
   883 000004E8 05050505                	db	5,5,5,5
   884 000004EC 04040404                	db	4,4,4,4
   885 000004F0 03030303                	db	3,3,3,3
   886 000004F4 02020202                	db	2,2,2,2
   887 000004F8 01010101                	db	1,1,1,1
   888 000004FC 00000000                	db	0,0,0,0
   889                                  
   890                                  HorPosTable:
   891 00000500 0000000000000000        	dw	0,0,0,0
   892 00000508 0100010001000100        	dw	1,1,1,1
   893 00000510 0200020002000200        	dw	2,2,2,2
   894 00000518 0300030003000300        	dw	3,3,3,3
   895 00000520 0400040004000400        	dw	4,4,4,4
   896 00000528 0500050005000500        	dw	5,5,5,5
   897 00000530 0600060006000600        	dw	6,6,6,6
   898 00000538 0700070007000700        	dw	7,7,7,7
   899 00000540 0800080008000800        	dw	8,8,8,8
   900 00000548 0900090009000900        	dw	9,9,9,9
   901                                  	
   902 00000550 0A000A000A000A00        	dw	10,10,10,10
   903 00000558 0B000B000B000B00        	dw	11,11,11,11
   904 00000560 0C000C000C000C00        	dw	12,12,12,12
   905 00000568 0D000D000D000D00        	dw	13,13,13,13
   906 00000570 0E000E000E000E00        	dw	14,14,14,14
   907 00000578 0F000F000F000F00        	dw	15,15,15,15
   908 00000580 1000100010001000        	dw	16,16,16,16
   909 00000588 1100110011001100        	dw	17,17,17,17
   910 00000590 1200120012001200        	dw	18,18,18,18
   911 00000598 1300130013001300        	dw	19,19,19,19
   912                                  	
   913 000005A0 1400140014001400        	dw	20,20,20,20
   914 000005A8 1500150015001500        	dw	21,21,21,21
   915 000005B0 1600160016001600        	dw	22,22,22,22
   916 000005B8 1700170017001700        	dw	23,23,23,23
   917 000005C0 1800180018001800        	dw	24,24,24,24
   918 000005C8 1900190019001900        	dw	25,25,25,25
   919 000005D0 1A001A001A001A00        	dw	26,26,26,26
   920 000005D8 1B001B001B001B00        	dw	27,27,27,27
   921 000005E0 1C001C001C001C00        	dw	28,28,28,28
   922 000005E8 1D001D001D001D00        	dw	29,29,29,29
   923                                  	
   924 000005F0 1E001E001E001E00        	dw	30,30,30,30
   925 000005F8 1F001F001F001F00        	dw	31,31,31,31
   926 00000600 2000200020002000        	dw	32,32,32,32
   927 00000608 2100210021002100        	dw	33,33,33,33
   928 00000610 2200220022002200        	dw	34,34,34,34
   929 00000618 2300230023002300        	dw	35,35,35,35
   930 00000620 2400240024002400        	dw	36,36,36,36
   931 00000628 2500250025002500        	dw	37,37,37,37
   932 00000630 2600260026002600        	dw	38,38,38,38
   933 00000638 2700270027002700        	dw	39,39,39,39
   934                                  
   935 00000640 2800280028002800        	dw	40,40,40,40
   936 00000648 2900290029002900        	dw	41,41,41,41
   937 00000650 2A002A002A002A00        	dw	42,42,42,42
   938 00000658 2B002B002B002B00        	dw	43,43,43,43
   939 00000660 2C002C002C002C00        	dw	44,44,44,44
   940 00000668 2D002D002D002D00        	dw	45,45,45,45
   941 00000670 2E002E002E002E00        	dw	46,46,46,46
   942 00000678 2F002F002F002F00        	dw	47,47,47,47
   943 00000680 3000300030003000        	dw	48,48,48,48
   944 00000688 3100310031003100        	dw	49,49,49,49
   945                                  
   946 00000690 3200320032003200        	dw	50,50,50,50
   947 00000698 3300330033003300        	dw	51,51,51,51
   948 000006A0 3400340034003400        	dw	52,52,52,52
   949 000006A8 3500350035003500        	dw	53,53,53,53
   950 000006B0 3600360036003600        	dw	54,54,54,54
   951 000006B8 3700370037003700        	dw	55,55,55,55
   952 000006C0 3800380038003800        	dw	56,56,56,56
   953 000006C8 3900390039003900        	dw	57,57,57,57
   954 000006D0 3A003A003A003A00        	dw	58,58,58,58
   955 000006D8 3B003B003B003B00        	dw	59,59,59,59
   956                                  
   957 000006E0 3C003C003C003C00        	dw	60,60,60,60
   958 000006E8 3D003D003D003D00        	dw	61,61,61,61
   959 000006F0 3E003E003E003E00        	dw	62,62,62,62
   960 000006F8 3F003F003F003F00        	dw	63,63,63,63
   961 00000700 4000400040004000        	dw	64,64,64,64
   962 00000708 4100410041004100        	dw	65,65,65,65
   963 00000710 4200420042004200        	dw	66,66,66,66
   964 00000718 4300430043004300        	dw	67,67,67,67
   965 00000720 4400440044004400        	dw	68,68,68,68
   966 00000728 4500450045004500        	dw	69,69,69,69
   967                                  
   968 00000730 4600460046004600        	dw	70,70,70,70
   969 00000738 4700470047004700        	dw	71,71,71,71
   970 00000740 4800480048004800        	dw	72,72,72,72
   971 00000748 4900490049004900        	dw	73,73,73,73
   972 00000750 4A004A004A004A00        	dw	74,74,74,74
   973 00000758 4B004B004B004B00        	dw	75,75,75,75
   974 00000760 4C004C004C004C00        	dw	76,76,76,76
   975 00000768 4D004D004D004D00        	dw	77,77,77,77
   976 00000770 4E004E004E004E00        	dw	78,78,78,78
   977 00000778 4F004F004F004F00        	dw	79,79,79,79
   978                                  
   979                                  ; if < 256 ver = 100 + (pitch &255)
   980                                  ; else ver = 100 - ( 255 - (pitch &255) )
   981                                  
   982                                  HorizonTable:
   983 00000780 640065006600670068-     	dw	100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,
   983 00000789 0069006A006B006C00-
   983 00000792 6D006E006F00700071-
   983 0000079B 007200730074007500-
   983 000007A4 76007700780079007A-
   983 000007AD 007B007C007D007E00-
   983 000007B6 7F0080008100820083-
   983 000007BF 00                 
   984 000007C0 840085008600870088-     	dw	132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,
   984 000007C9 0089008A008B008C00-
   984 000007D2 8D008E008F00900091-
   984 000007DB 009200930094009500-
   984 000007E4 96009700980099009A-
   984 000007ED 009B009C009D009E00-
   984 000007F6 9F00A000A100A200A3-
   984 000007FF 00                 
   985 00000800 A400A500A600A700A8-     	dw	164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,
   985 00000809 00A900AA00AB00AC00-
   985 00000812 AD00AE00AF00B000B1-
   985 0000081B 00B200B300B400B500-
   985 00000824 B600B700B800B900BA-
   985 0000082D 00BB00BC00BD00BE00-
   985 00000836 BF00C000C100C200C3-
   985 0000083F 00                 
   986 00000840 C400C500C600C700C8-     	dw	196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,
   986 00000849 00C900CA00CB00CC00-
   986 00000852 CD00CE00CF00D000D1-
   986 0000085B 00D200D300D400D500-
   986 00000864 D600D700D800D900DA-
   986 0000086D 00DB00DC00DD00DE00-
   986 00000876 DF00E000E100E200E3-
   986 0000087F 00                 
   987 00000880 E400E500E600E700E8-     	dw	228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,
   987 00000889 00E900EA00EB00EC00-
   987 00000892 ED00EE00EF00F000F1-
   987 0000089B 00F200F300F400F500-
   987 000008A4 F600F700F800F900FA-
   987 000008AD 00FB00FC00FD00FE00-
   987 000008B6 FF0000010101020103-
   987 000008BF 01                 
   988 000008C0 040105010601070108-     	dw	260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,
   988 000008C9 0109010A010B010C01-
   988 000008D2 0D010E010F01100111-
   988 000008DB 011201130114011501-
   988 000008E4 16011701180119011A-
   988 000008ED 011B011C011D011E01-
   988 000008F6 1F0120012101220123-
   988 000008FF 01                 
   989 00000900 240125012601270128-     	dw	292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,
   989 00000909 0129012A012B012C01-
   989 00000912 2D012E012F01300131-
   989 0000091B 013201330134013501-
   989 00000924 36013701380139013A-
   989 0000092D 013B013C013D013E01-
   989 00000936 3F0140014101420143-
   989 0000093F 01                 
   990 00000940 440145014601470148-     	dw	324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,
   990 00000949 0149014A014B014C01-
   990 00000952 4D014E014F01500151-
   990 0000095B 015201530154015501-
   990 00000964 56015701580159015A-
   990 0000096D 015B015C015D015E01-
   990 00000976 5F0160016101620163-
   990 0000097F 01                 
   991 00000980 64FF65FF66FF67FF68-     	dw	-156,-155,-154,-153,-152,-151,-150,-149,-148,-147,-146,-145,-144,-143,-142,-141,-140,-139,-138,-137,-136,-135,-134,-133,-132,-131,-130,-129,-128,-127,-126,-125,
   991 00000989 FF69FF6AFF6BFF6CFF-
   991 00000992 6DFF6EFF6FFF70FF71-
   991 0000099B FF72FF73FF74FF75FF-
   991 000009A4 76FF77FF78FF79FF7A-
   991 000009AD FF7BFF7CFF7DFF7EFF-
   991 000009B6 7FFF80FF81FF82FF83-
   991 000009BF FF                 
   992 000009C0 84FF85FF86FF87FF88-     	dw	-124,-123,-122,-121,-120,-119,-118,-117,-116,-115,-114,-113,-112,-111,-110,-109,-108,-107,-106,-105,-104,-103,-102,-101,-100,-99,-98,-97,-96,-95,-94,-93,
   992 000009C9 FF89FF8AFF8BFF8CFF-
   992 000009D2 8DFF8EFF8FFF90FF91-
   992 000009DB FF92FF93FF94FF95FF-
   992 000009E4 96FF97FF98FF99FF9A-
   992 000009ED FF9BFF9CFF9DFF9EFF-
   992 000009F6 9FFFA0FFA1FFA2FFA3-
   992 000009FF FF                 
   993 00000A00 A4FFA5FFA6FFA7FFA8-     	dw	-92,-91,-90,-89,-88,-87,-86,-85,-84,-83,-82,-81,-80,-79,-78,-77,-76,-75,-74,-73,-72,-71,-70,-69,-68,-67,-66,-65,-64,-63,-62,-61,
   993 00000A09 FFA9FFAAFFABFFACFF-
   993 00000A12 ADFFAEFFAFFFB0FFB1-
   993 00000A1B FFB2FFB3FFB4FFB5FF-
   993 00000A24 B6FFB7FFB8FFB9FFBA-
   993 00000A2D FFBBFFBCFFBDFFBEFF-
   993 00000A36 BFFFC0FFC1FFC2FFC3-
   993 00000A3F FF                 
   994 00000A40 C4FFC5FFC6FFC7FFC8-     	dw	-60,-59,-58,-57,-56,-55,-54,-53,-52,-51,-50,-49,-48,-47,-46,-45,-44,-43,-42,-41,-40,-39,-38,-37,-36,-35,-34,-33,-32,-31,-30,-29,
   994 00000A49 FFC9FFCAFFCBFFCCFF-
   994 00000A52 CDFFCEFFCFFFD0FFD1-
   994 00000A5B FFD2FFD3FFD4FFD5FF-
   994 00000A64 D6FFD7FFD8FFD9FFDA-
   994 00000A6D FFDBFFDCFFDDFFDEFF-
   994 00000A76 DFFFE0FFE1FFE2FFE3-
   994 00000A7F FF                 
   995 00000A80 E4FFE5FFE6FFE7FFE8-     	dw	-28,-27,-26,-25,-24,-23,-22,-21,-20,-19,-18,-17,-16,-15,-14,-13,-12,-11,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,
   995 00000A89 FFE9FFEAFFEBFFECFF-
   995 00000A92 EDFFEEFFEFFFF0FFF1-
   995 00000A9B FFF2FFF3FFF4FFF5FF-
   995 00000AA4 F6FFF7FFF8FFF9FFFA-
   995 00000AAD FFFBFFFCFFFDFFFEFF-
   995 00000AB6 FFFF00000100020003-
   995 00000ABF 00                 
   996 00000AC0 040005000600070008-     	dw	4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,
   996 00000AC9 0009000A000B000C00-
   996 00000AD2 0D000E000F00100011-
   996 00000ADB 001200130014001500-
   996 00000AE4 16001700180019001A-
   996 00000AED 001B001C001D001E00-
   996 00000AF6 1F0020002100220023-
   996 00000AFF 00                 
   997 00000B00 240025002600270028-     	dw	36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,
   997 00000B09 0029002A002B002C00-
   997 00000B12 2D002E002F00300031-
   997 00000B1B 003200330034003500-
   997 00000B24 36003700380039003A-
   997 00000B2D 003B003C003D003E00-
   997 00000B36 3F0040004100420043-
   997 00000B3F 00                 
   998 00000B40 440045004600470048-     	dw	68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,
   998 00000B49 0049004A004B004C00-
   998 00000B52 4D004E004F00500051-
   998 00000B5B 005200530054005500-
   998 00000B64 56005700580059005A-
   998 00000B6D 005B005C005D005E00-
   998 00000B76 5F0060006100620063-
   998 00000B7F 00                 
   999                                  
  1000                                  FillBlockTab:
  1001 00000B80 0000280050007800A0-     	dw	0*40,1*40,2*40,3*40,4*40,5*40,6*40,7*40,8*40,9*40,
  1001 00000B89 00C800F00018014001-
  1001 00000B92 6801               
  1002 00000B94 9001B801E001080230-     	dw	10*40,11*40,12*40,13*40,14*40,15*40,16*40,17*40,18*40,19*40,
  1002 00000B9D 0258028002A802D002-
  1002 00000BA6 F802               
  1003 00000BA8 2003480370039803C0-     	dw	20*40,21*40,22*40,23*40,24*40,25*40,26*40,27*40,28*40,29*40,
  1003 00000BB1 03E803100438046004-
  1003 00000BBA 8804               
  1004 00000BBC B004D8040005280550-     	dw	30*40,31*40,32*40,33*40,34*40,35*40,36*40,37*40,38*40,39*40,
  1004 00000BC5 057805A005C805F005-
  1004 00000BCE 1806               
  1005 00000BD0 400668069006B806E0-     	dw	40*40,41*40,42*40,43*40,44*40,45*40,46*40,47*40,48*40,49*40,
  1005 00000BD9 060807300758078007-
  1005 00000BE2 A807               
  1006 00000BE4 D007F8072008480870-     	dw	50*40,51*40,52*40,53*40,54*40,55*40,56*40,57*40,58*40,59*40,
  1006 00000BED 089808C008E8081009-
  1006 00000BF6 3809               
  1007 00000BF8 60098809B009D80900-     	dw	60*40,61*40,62*40,63*40,64*40,65*40,66*40,67*40,68*40,69*40,
  1007 00000C01 0A280A500A780AA00A-
  1007 00000C0A C80A               
  1008 00000C0C F00A180B400B680B90-     	dw	70*40,71*40,72*40,73*40,74*40,75*40,76*40,77*40,78*40,79*40,
  1008 00000C15 0BB80BE00B080C300C-
  1008 00000C1E 580C               
  1009 00000C20 800CA80CD00CF80C20-     	dw	80*40,81*40,82*40,83*40,84*40,85*40,86*40,87*40,88*40,89*40,
  1009 00000C29 0D480D700D980DC00D-
  1009 00000C32 E80D               
  1010 00000C34 100E380E600E880EB0-     	dw	90*40,91*40,92*40,93*40,94*40,95*40,96*40,97*40,98*40,99*40,
  1010 00000C3D 0ED80E000F280F500F-
  1010 00000C46 780F               
  1011                                  
  1012 00000C48 FC30FCFCCCFCFCFCFC-     Hex0	db 11111100b,00110000b,11111100b,11111100b,11001100b,11111100b,11111100b,11111100b,11111100b,11111100b,11111100b,11111100b,11111100b,11110000b,11111100b,11111100b
  1012 00000C51 FCFCFCFCF0FCFC     
  1013 00000C58 CCF00C0CCCC0C00CCC-     Hex1	db 11001100b,11110000b,00001100b,00001100b,11001100b,11000000b,11000000b,00001100b,11001100b,11001100b,11001100b,11001100b,11000000b,11001100b,11000000b,11000000b
  1013 00000C61 CCCCCCC0CCC0C0     
  1014 00000C68 CC30FCFCFCFCFC0CFC-     Hex2	db 11001100b,00110000b,11111100b,11111100b,11111100b,11111100b,11111100b,00001100b,11111100b,11111100b,11111100b,11110000b,11000000b,11001100b,11111100b,11111100b
  1014 00000C71 FCFCF0C0CCFCFC     
  1015 00000C78 CC30C00C0C0CCC0CCC-     Hex3	db 11001100b,00110000b,11000000b,00001100b,00001100b,00001100b,11001100b,00001100b,11001100b,00001100b,11001100b,11001100b,11000000b,11001100b,11000000b,11000000b
  1015 00000C81 0CCCCCC0CCC0C0     
  1016 00000C88 FCFCFCFC0CFCFC0CFC-     Hex4	db 11111100b,11111100b,11111100b,11111100b,00001100b,11111100b,11111100b,00001100b,11111100b,11111100b,11001100b,11111100b,11111100b,11110000b,11111100b,11000000b
  1016 00000C91 FCCCFCFCF0FCC0     
  1017                                  	
  1018                                  %include  'sin256.inc'
     1                              <1> sintab:
     2 00000C98 000001020303040506- <1>  db     0,    0,    1,    2,    3,    3,    4,    5,    6,    7,    7,    8,    9,   10,   10,   11 ; 16
     2 00000CA1 070708090A0A0B      <1>
     3 00000CA8 0C0D0E0E0F10111112- <1>  db    12,   13,   14,   14,   15,   16,   17,   17,   18,   19,   20,   21,   21,   22,   23,   24 ; 32
     3 00000CB1 13141515161718      <1>
     4 00000CB8 18191A1B1B1C1D1E1E- <1>  db    24,   25,   26,   27,   27,   28,   29,   30,   30,   31,   32,   33,   34,   34,   35,   36 ; 48
     4 00000CC1 1F202122222324      <1>
     5 00000CC8 252526272828292A2A- <1>  db    37,   37,   38,   39,   40,   40,   41,   42,   42,   43,   44,   45,   45,   46,   47,   48 ; 64
     5 00000CD1 2B2C2D2D2E2F30      <1>
     6 00000CD8 303132323334353536- <1>  db    48,   49,   50,   50,   51,   52,   53,   53,   54,   55,   55,   56,   57,   58,   58,   59 ; 80
     6 00000CE1 373738393A3A3B      <1>
     7 00000CE8 3C3C3D3E3E3F404041- <1>  db    60,   60,   61,   62,   62,   63,   64,   64,   65,   66,   66,   67,   68,   68,   69,   70 ; 96
     7 00000CF1 42424344444546      <1>
     8 00000CF8 46474848494A4A4B4B- <1>  db    70,   71,   72,   72,   73,   74,   74,   75,   75,   76,   77,   77,   78,   79,   79,   80 ; 112
     8 00000D01 4C4D4D4E4F4F50      <1>
     9 00000D08 505152525353545555- <1>  db    80,   81,   82,   82,   83,   83,   84,   85,   85,   86,   86,   87,   87,   88,   89,   89 ; 128
     9 00000D11 56565757585959      <1>
    10 00000D18 5A5A5B5B5C5C5D5D5E- <1>  db    90,   90,   91,   91,   92,   92,   93,   93,   94,   95,   95,   96,   96,   97,   97,   98 ; 144
    10 00000D21 5F5F6060616162      <1>
    11 00000D28 626363646465656566- <1>  db    98,   99,   99,  100,  100,  101,  101,  101,  102,  102,  103,  103,  104,  104,  105,  105 ; 160
    11 00000D31 66676768686969      <1>
    12 00000D38 6A6A6A6B6B6C6C6C6D- <1>  db   106,  106,  106,  107,  107,  108,  108,  108,  109,  109,  110,  110,  110,  111,  111,  112 ; 176
    12 00000D41 6D6E6E6E6F6F70      <1>
    13 00000D48 707071717172727273- <1>  db   112,  112,  113,  113,  113,  114,  114,  114,  115,  115,  115,  116,  116,  116,  117,  117 ; 192
    13 00000D51 73737474747575      <1>
    14 00000D58 757676767677777778- <1>  db   117,  118,  118,  118,  118,  119,  119,  119,  120,  120,  120,  120,  121,  121,  121,  121 ; 208
    14 00000D61 78787879797979      <1>
    15 00000D68 7A7A7A7A7A7B7B7B7B- <1>  db   122,  122,  122,  122,  122,  123,  123,  123,  123,  123,  124,  124,  124,  124,  124,  124 ; 224
    15 00000D71 7B7C7C7C7C7C7C      <1>
    16 00000D78 7D7D7D7D7D7D7D7E7E- <1>  db   125,  125,  125,  125,  125,  125,  125,  126,  126,  126,  126,  126,  126,  126,  126,  126 ; 240
    16 00000D81 7E7E7E7E7E7E7E      <1>
    17 00000D88 7E7E7F7F7F7F7F7F7F- <1>  db   126,  126,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127 ; 256
    17 00000D91 7F7F7F7F7F7F7F      <1>
    18                              <1> 
    19 00000D98 7F7F7F7F7F7F7F7F7F- <1>  db   127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  126,  126 ; 272
    19 00000DA1 7F7F7F7F7F7E7E      <1>
    20 00000DA8 7E7E7E7E7E7E7E7E7E- <1>  db   126,  126,  126,  126,  126,  126,  126,  126,  126,  125,  125,  125,  125,  125,  125,  125 ; 288
    20 00000DB1 7D7D7D7D7D7D7D      <1>
    21 00000DB8 7C7C7C7C7C7C7B7B7B- <1>  db   124,  124,  124,  124,  124,  124,  123,  123,  123,  123,  123,  122,  122,  122,  122,  122 ; 304
    21 00000DC1 7B7B7A7A7A7A7A      <1>
    22 00000DC8 797979797878787877- <1>  db   121,  121,  121,  121,  120,  120,  120,  120,  119,  119,  119,  118,  118,  118,  118,  117 ; 320
    22 00000DD1 77777676767675      <1>
    23 00000DD8 757574747473737372- <1>  db   117,  117,  116,  116,  116,  115,  115,  115,  114,  114,  114,  113,  113,  113,  112,  112 ; 336
    23 00000DE1 72727171717070      <1>
    24 00000DE8 706F6F6E6E6E6D6D6C- <1>  db   112,  111,  111,  110,  110,  110,  109,  109,  108,  108,  108,  107,  107,  106,  106,  106 ; 352
    24 00000DF1 6C6C6B6B6A6A6A      <1>
    25 00000DF8 696968686767666665- <1>  db   105,  105,  104,  104,  103,  103,  102,  102,  101,  101,  101,  100,  100,   99,   99,   98 ; 368
    25 00000E01 65656464636362      <1>
    26 00000E08 62616160605F5F5E5D- <1>  db    98,   97,   97,   96,   96,   95,   95,   94,   93,   93,   92,   92,   91,   91,   90,   90 ; 384
    26 00000E11 5D5C5C5B5B5A5A      <1>
    27 00000E18 595958575756565555- <1>  db    89,   89,   88,   87,   87,   86,   86,   85,   85,   84,   83,   83,   82,   82,   81,   80 ; 400
    27 00000E21 54535352525150      <1>
    28 00000E28 504F4F4E4D4D4C4B4B- <1>  db    80,   79,   79,   78,   77,   77,   76,   75,   75,   74,   74,   73,   72,   72,   71,   70 ; 416
    28 00000E31 4A4A4948484746      <1>
    29 00000E38 464544444342424140- <1>  db    70,   69,   68,   68,   67,   66,   66,   65,   64,   64,   63,   62,   62,   61,   60,   60 ; 432
    29 00000E41 403F3E3E3D3C3C      <1>
    30 00000E48 3B3A3A393837373635- <1>  db    59,   58,   58,   57,   56,   55,   55,   54,   53,   53,   52,   51,   50,   50,   49,   48 ; 448
    30 00000E51 35343332323130      <1>
    31 00000E58 302F2E2D2D2C2B2A2A- <1>  db    48,   47,   46,   45,   45,   44,   43,   42,   42,   41,   40,   40,   39,   38,   37,   37 ; 464
    31 00000E61 29282827262525      <1>
    32 00000E68 2423222221201F1E1E- <1>  db    36,   35,   34,   34,   33,   32,   31,   30,   30,   29,   28,   27,   27,   26,   25,   24 ; 480
    32 00000E71 1D1C1B1B1A1918      <1>
    33 00000E78 181716151514131211- <1>  db    24,   23,   22,   21,   21,   20,   19,   18,   17,   17,   16,   15,   14,   14,   13,   12 ; 496
    33 00000E81 11100F0E0E0D0C      <1>
    34 00000E88 0B0A0A090807070605- <1>  db    11,   10,   10,    9,    8,    7,    7,    6,    5,    4,    3,    3,    2,    1,    0,    0 ; 512
    34 00000E91 04030302010000      <1>
    35                              <1>  
    36 00000E98 0000FFFEFDFDFCFBFA- <1>  db     0,    0,   -1,   -2,   -3,   -3,   -4,   -5,   -6,   -7,   -7,   -8,   -9,  -10,  -10,  -11 ; 528
    36 00000EA1 F9F9F8F7F6F6F5      <1>
    37 00000EA8 F4F3F2F2F1F0EFEFEE- <1>  db   -12,  -13,  -14,  -14,  -15,  -16,  -17,  -17,  -18,  -19,  -20,  -21,  -21,  -22,  -23,  -24 ; 544
    37 00000EB1 EDECEBEBEAE9E8      <1>
    38 00000EB8 E8E7E6E5E5E4E3E2E2- <1>  db   -24,  -25,  -26,  -27,  -27,  -28,  -29,  -30,  -30,  -31,  -32,  -33,  -34,  -34,  -35,  -36 ; 560
    38 00000EC1 E1E0DFDEDEDDDC      <1>
    39 00000EC8 DBDBDAD9D8D8D7D6D6- <1>  db   -37,  -37,  -38,  -39,  -40,  -40,  -41,  -42,  -42,  -43,  -44,  -45,  -45,  -46,  -47,  -48 ; 576
    39 00000ED1 D5D4D3D3D2D1D0      <1>
    40 00000ED8 D0CFCECECDCCCBCBCA- <1>  db   -48,  -49,  -50,  -50,  -51,  -52,  -53,  -53,  -54,  -55,  -55,  -56,  -57,  -58,  -58,  -59 ; 592
    40 00000EE1 C9C9C8C7C6C6C5      <1>
    41 00000EE8 C4C4C3C2C2C1C0C0BF- <1>  db   -60,  -60,  -61,  -62,  -62,  -63,  -64,  -64,  -65,  -66,  -66,  -67,  -68,  -68,  -69,  -70 ; 608
    41 00000EF1 BEBEBDBCBCBBBA      <1>
    42 00000EF8 BAB9B8B8B7B6B6B5B5- <1>  db   -70,  -71,  -72,  -72,  -73,  -74,  -74,  -75,  -75,  -76,  -77,  -77,  -78,  -79,  -79,  -80 ; 624
    42 00000F01 B4B3B3B2B1B1B0      <1>
    43 00000F08 B0AFAEAEADADACABAB- <1>  db   -80,  -81,  -82,  -82,  -83,  -83,  -84,  -85,  -85,  -86,  -86,  -87,  -87,  -88,  -89,  -89 ; 640
    43 00000F11 AAAAA9A9A8A7A7      <1>
    44 00000F18 A6A6A5A5A4A4A3A3A2- <1>  db   -90,  -90,  -91,  -91,  -92,  -92,  -93,  -93,  -94,  -95,  -95,  -96,  -96,  -97,  -97,  -98 ; 656
    44 00000F21 A1A1A0A09F9F9E      <1>
    45 00000F28 9E9D9D9C9C9B9B9B9A- <1>  db   -98,  -99,  -99, -100, -100, -101, -101, -101, -102, -102, -103, -103, -104, -104, -105, -105 ; 672
    45 00000F31 9A999998989797      <1>
    46 00000F38 969696959594949493- <1>  db  -106, -106, -106, -107, -107, -108, -108, -108, -109, -109, -110, -110, -110, -111, -111, -112 ; 688
    46 00000F41 93929292919190      <1>
    47 00000F48 90908F8F8F8E8E8E8D- <1>  db  -112, -112, -113, -113, -113, -114, -114, -114, -115, -115, -115, -116, -116, -116, -117, -117 ; 704
    47 00000F51 8D8D8C8C8C8B8B      <1>
    48 00000F58 8B8A8A8A8A89898988- <1>  db  -117, -118, -118, -118, -118, -119, -119, -119, -120, -120, -120, -120, -121, -121, -121, -121 ; 720
    48 00000F61 88888887878787      <1>
    49 00000F68 868686868685858585- <1>  db  -122, -122, -122, -122, -122, -123, -123, -123, -123, -123, -124, -124, -124, -124, -124, -124 ; 736
    49 00000F71 85848484848484      <1>
    50 00000F78 838383838383838282- <1>  db  -125, -125, -125, -125, -125, -125, -125, -126, -126, -126, -126, -126, -126, -126, -126, -126 ; 752
    50 00000F81 82828282828282      <1>
    51 00000F88 828281818181818181- <1>  db  -126, -126, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127 ; 768
    51 00000F91 81818181818181      <1>
    52                              <1>  
    53 00000F98 818181818181818181- <1>  db  -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -126, -126 ; 784
    53 00000FA1 81818181818282      <1>
    54 00000FA8 828282828282828282- <1>  db  -126, -126, -126, -126, -126, -126, -126, -126, -126, -125, -125, -125, -125, -125, -125, -125 ; 800
    54 00000FB1 83838383838383      <1>
    55 00000FB8 848484848484858585- <1>  db  -124, -124, -124, -124, -124, -124, -123, -123, -123, -123, -123, -122, -122, -122, -122, -122 ; 816
    55 00000FC1 85858686868686      <1>
    56 00000FC8 878787878888888889- <1>  db  -121, -121, -121, -121, -120, -120, -120, -120, -119, -119, -119, -118, -118, -118, -118, -117 ; 832
    56 00000FD1 89898A8A8A8A8B      <1>
    57 00000FD8 8B8B8C8C8C8D8D8D8E- <1>  db  -117, -117, -116, -116, -116, -115, -115, -115, -114, -114, -114, -113, -113, -113, -112, -112 ; 848
    57 00000FE1 8E8E8F8F8F9090      <1>
    58 00000FE8 909191929292939394- <1>  db  -112, -111, -111, -110, -110, -110, -109, -109, -108, -108, -108, -107, -107, -106, -106, -106 ; 864
    58 00000FF1 94949595969696      <1>
    59 00000FF8 9797989899999A9A9B- <1>  db  -105, -105, -104, -104, -103, -103, -102, -102, -101, -101, -101, -100, -100,  -99,  -99,  -98 ; 880
    59 00001001 9B9B9C9C9D9D9E      <1>
    60 00001008 9E9F9FA0A0A1A1A2A3- <1>  db   -98,  -97,  -97,  -96,  -96,  -95,  -95,  -94,  -93,  -93,  -92,  -92,  -91,  -91,  -90,  -90 ; 896
    60 00001011 A3A4A4A5A5A6A6      <1>
    61 00001018 A7A7A8A9A9AAAAABAB- <1>  db   -89,  -89,  -88,  -87,  -87,  -86,  -86,  -85,  -85,  -84,  -83,  -83,  -82,  -82,  -81,  -80 ; 912
    61 00001021 ACADADAEAEAFB0      <1>
    62 00001028 B0B1B1B2B3B3B4B5B5- <1>  db   -80,  -79,  -79,  -78,  -77,  -77,  -76,  -75,  -75,  -74,  -74,  -73,  -72,  -72,  -71,  -70 ; 928
    62 00001031 B6B6B7B8B8B9BA      <1>
    63 00001038 BABBBCBCBDBEBEBFC0- <1>  db   -70,  -69,  -68,  -68,  -67,  -66,  -66,  -65,  -64,  -64,  -63,  -62,  -62,  -61,  -60,  -60 ; 944
    63 00001041 C0C1C2C2C3C4C4      <1>
    64 00001048 C5C6C6C7C8C9C9CACB- <1>  db   -59,  -58,  -58,  -57,  -56,  -55,  -55,  -54,  -53,  -53,  -52,  -51,  -50,  -50,  -49,  -48 ; 960
    64 00001051 CBCCCDCECECFD0      <1>
    65 00001058 D0D1D2D3D3D4D5D6D6- <1>  db   -48,  -47,  -46,  -45,  -45,  -44,  -43,  -42,  -42,  -41,  -40,  -40,  -39,  -38,  -37,  -37 ; 976
    65 00001061 D7D8D8D9DADBDB      <1>
    66 00001068 DCDDDEDEDFE0E1E2E2- <1>  db   -36,  -35,  -34,  -34,  -33,  -32,  -31,  -30,  -30,  -29,  -28,  -27,  -27,  -26,  -25,  -24 ; 992
    66 00001071 E3E4E5E5E6E7E8      <1>
    67 00001078 E8E9EAEBEBECEDEEEF- <1>  db   -24,  -23,  -22,  -21,  -21,  -20,  -19,  -18,  -17,  -17,  -16,  -15,  -14,  -14,  -13,  -12 ; 1008
    67 00001081 EFF0F1F2F2F3F4      <1>
    68 00001088 F5F6F6F7F8F9F9FAFB- <1>  db   -11,  -10,  -10,   -9,   -8,   -7,   -7,   -6,   -5,   -4,   -3,   -3,   -2,   -1,    0,    0 ; 1024
    68 00001091 FCFDFDFEFF0000      <1>
  1019                                  
  1020                                  section .bss 	; put uninitialized data here
  1021 00000000 <res 194h>              BackBufferTable: 	resw 202 	; 200 screen lines as words
  1022 00000194 <res 8000h>             BackBuffer: 		resw 16384	; 2 screen buffers
  1023                                  
  1024 00008194 ????                    XAngle:	resw	1
  1025 00008196 ????                    YAngle:	resw	1
  1026                                  
  1027 00008198 ????                    SinX:	resw	1
  1028 0000819A ????                    CosX:	resw	1
  1029 0000819C ????                    SinY:	resw	1
  1030 0000819E ????                    CosY:	resw	1
  1031                                  
  1032 000081A0 ????                    HorEdge	resw	1
  1033                                  
  1034 000081A2 ????                    XST		resw	1
  1035 000081A4 ????                    YST		resw	1
  1036 000081A6 ????                    XEN		resw	1
  1037 000081A8 ????                    YEN		resw	1
  1038                                  
  1039                                  ;Test0: 	resw	1
  1040                                  ;Test1: 	resw	1
  1041                                  ;Test2: 	resw	1
  1042                                  ;Test3: 	resw	1
  1043                                  ;Test4: 	resw	1
  1044                                  ;Test5: 	resw	1
  1045                                  ;Test6: 	resw	1
  1046                                  ;Test7: 	resw	1
  1047                                  ;Test8: 	resw	1
  1048 000081AA ????                    Test9: 	resw	1
  1049 000081AC ????                    Test10: resw	1
  1050                                  
  1051                                  ;Test11: resw	1
  1052                                  
  1053 000081AE ????                    HDiff:	resw	1
  1054 000081B0 ????                    VDiff:	resw	1
  1055 000081B2 ????                    Slope: 	resw	1
  1056                                  
  1057 000081B4 ????                    HorDir:	resw	1
  1058                                  
  1059 000081B6 ????                    BackBufferSeg	resw	1	; pointer to the segment containing the back buffer
  1060                                  
  1061 000081B8 ??                      Exit:	resb	1
  1062                                  
  1063                                  

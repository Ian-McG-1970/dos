     1                                  ; nasm cga_line_v7.asm -o cgaline.com -f bin
     2                                  
     3                                  
     4                                  ; list of next line tables - even values = +8192 odd values = -8192 - put into 2 registers - swap registers after each next line
     5                                  
     6                                  VIDEO_SEGMENT	equ	0b800h 	; display memory segment for true CGA graphics modes
     7                                  SW				equ 80 		; screen width
     8                                  SE				equ	0		; screen even start
     9                                  SO				equ	8192	; screen odd start
    10                                  
    11                                  INPUT_STATUS_1	equ	03dah	; VGA status register
    12                                  VSYNC_MASK	equ	08h	; vertical sync bit in status register 1
    13                                  DE_MASK		equ	01h	; display enable bit in status register 1
    14                                  
    15                                  MAP_MASK	equ	2		; SC map mask register
    16                                  SC_INDEX		equ	3c4h	; SC index register
    17                                   
    18                                  TOP_CC		equ	1
    19                                  BOTTOM_CC	equ	2
    20                                  LEFT_CC		equ	4
    21                                  RIGHT_CC		equ	8
    22                                  BEHIND_CC	equ	16
    23                                  MIDDLE_X		equ	160
    24                                  MIDDLE_Y		equ	100
    25                                  TOP_EDGE	equ	MIDDLE_Y-100
    26                                  BOTTOM_EDGE	equ	MIDDLE_Y+99
    27                                  LEFT_EDGE	equ	MIDDLE_X-160
    28                                  RIGHT_EDGE	equ	MIDDLE_X+159
    29                                  
    30                                  KEY_ESC	EQU 1bh
    31                                  KEY_Q	EQU 'q'
    32                                  KEY_W	EQU 'w'
    33                                  KEY_E	EQU 'e'
    34                                  KEY_R	EQU 'r'
    35                                  
    36                                  CPU 8086
    37                                  bits 16
    38                                  org 100h
    39                                  
    40                                  section .text
    41                                  
    42                                  start:
    43 00000000 E84900                  	call	BuildScreenTable
    44 00000003 B80500                  	mov	ax,05h ; 04h	; CGA 320 x 200 4 colors ; more 05 instead of mode 04
    45 00000006 CD10                    	int		10h
    46                                  
    47                                  ;	mov	ax,0Bh 	; Pallette
    48                                  ;	mov	bh,1
    49                                  ;	mov	bl,0
    50                                  ;	mov	bx,00000h ; pallette 0 high
    51                                  ;	int	10h 
    52                                  	
    53 00000008 B44A                    	mov	ah, 4ah
    54 0000000A BB0010                  	mov	bx, 1000h
    55 0000000D CD21                    	int	21h
    56 0000000F B448                    	mov	ah, 48h
    57 00000011 BB0010                  	mov	bx, 1000h
    58 00000014 CD21                    	int	21h
    59 00000016 A3[B681]                	mov	[BackBufferSeg], ax
    60                                  
    61 00000019 31C0                    	xor ax,ax
    62 0000001B A2[B881]                	mov	[Exit],al
    63 0000001E 83C002                  	add ax,2
    64 00000021 A3[9481]                	mov	[XAngle],ax
    65 00000024 83C002                  	add ax,2
    66 00000027 A3[9681]                	mov	[YAngle],ax	
    67                                  	
    68                                  ;	mov	[Test0],ax
    69                                  	
    70                                  MainLoop:
    71 0000002A E87602                  		call	WaitVSync
    72 0000002D E88102                  		call	CopyClearBackBuffer
    73                                  	
    74 00000030 8B1E[B681]              		mov		bx,[BackBufferSeg]
    75 00000034 8EC3                    		mov		es,bx
    76                                  
    77 00000036 E82F00                  		call	Horizon
    78                                  
    79                                  ;		mov		bl,0
    80                                  ;		mov		ax,[XAngle]
    81                                  ;		call	Hex16
    82                                  ;		mov		bl,1
    83                                  ;		mov		ax,[YAngle]
    84                                  ;		call	Hex16
    85                                  ;		mov		bl,3
    86                                  ;		mov		ax,[SinX]
    87                                  ;		call	Hex16
    88                                  ;		mov		bl,4
    89                                  ;		mov		ax,[CosX]
    90                                  ;		call	Hex16
    91                                  ;		mov		bl,6
    92                                  ;		mov		ax,[SinY]
    93                                  ;		call	Hex16
    94                                  ;		mov		bl,7
    95                                  ;		mov		ax,[CosY]
    96                                  ;		call	Hex16
    97                                  
    98                                  ;		mov		bl,9
    99                                  ;		mov		ax,[Test0]
   100                                  ;		call	Hex16
   101                                  ;		mov		bl,10
   102                                  ;		mov		ax,[Test1]
   103                                  ;		call	Hex16
   104                                  ;		mov		bl,11
   105                                  ;		mov		ax,[Test2]
   106                                  ;		call	Hex16
   107                                  ;		mov		bl,12
   108                                  ;		mov		ax,[Test3]
   109                                  ;		call	Hex16
   110                                  ;		mov		bl,13
   111                                  ;		mov		ax,[Test4]
   112                                  ;		call	Hex16
   113                                  ;		mov		bl,15
   114                                  ;		mov		ax,[Test5]
   115                                  ;		call	Hex16
   116                                  
   117                                  ;		mov		bl,22
   118                                  ;		mov		ax,[Test6]
   119                                  ;		call	Hex16
   120                                  ;		mov		bl,23
   121                                  ;		mov		ax,[Test7]
   122                                  ;		call	Hex16
   123                                  ;		mov		bl,24
   124                                  ;		mov		ax,[Test8]
   125                                  ;		call	Hex16
   126                                  ;		mov		bl,25
   127                                  ;		mov		ax,[Test9]
   128                                  ;		call	Hex16
   129                                  ;		mov		bl,26
   130                                  ;		mov		ax,[Test10]
   131                                  ;		call	Hex16
   132                                  
   133                                  ;		mov		bl,29
   134                                  ;		mov		ax,[BackBufferSeg]
   135                                  ;		call	Hex16
   136                                  
   137                                  ;		mov		bl,30
   138                                  ;		mov		ax,[Test11]
   139                                  ;		call	Hex16
   140                                  
   141                                  ;		call	BuildRotateMatrixV2
   142                                  
   143 00000039 E81502                  		call	GetKey
   144                                  		
   145 0000003C A0[B881]                	mov		al,[Exit]
   146 0000003F 08C0                    	or	al,al
   147 00000041 74E7                    	je		MainLoop
   148                                  
   149 00000043 B80300                  Done:	mov		ax,3	; reset to text mode
   150 00000046 CD10                    		int		10h
   151 00000048 B44C                    		mov		ah,4ch	; exit to DOS
   152 0000004A CD21                    		int		21h
   153                                  
   154 0000004C 8D3E[0000]              BuildScreenTable:	lea		di,[BackBufferTable]
   155 00000050 31ED                    					xor		bp,bp	; even lines
   156 00000052 B96400                  					mov		cx,100
   157 00000055 892D                    .loop:					mov		[di],bp
   158 00000057 81C50020                						add		bp,8192
   159 0000005B 896D02                  						mov		[di+2],bp
   160 0000005E 81EDB01F                						sub		bp,8192-80
   161 00000062 83C704                  						add		di,4
   162 00000065 E2EE                    						loop	.loop
   163 00000067 C3                      					ret
   164                                  
   165                                  Horizon:
   166 00000068 8B2E[9481]              		mov		bp,[XAngle]	; roll
   167 0000006C E8B402                  		call	SinCosV2
   168 0000006F 892E[9881]              		mov		[SinX],bp
   169 00000073 A3[9A81]                		mov		[CosX],ax
   170                                  		
   171 00000076 89C1                    		mov		cx,ax		; CosX
   172 00000078 B8A000                  		mov		ax,160
   173 0000007B F7ED                    		imul	bp			; *SinX - could be replaced with (bp*128) + (bp*32)
   174 0000007D F7F9                    		idiv	cx
   175 0000007F A3[A081]                		mov		[HorEdge],ax
   176                                  
   177 00000082 8B1E[9681]              		mov		bx,[YAngle]	; pitch
   178 00000086 81E3FE03                		and		bx,1022 	; = 511*2
   179 0000008A 8B9F[0005]              		mov		bx,[HorizonTable+bx]
   180                                  
   181 0000008E 892E[B481]              		mov		[HorDir],bp
   182 00000092 85ED                    		test	bp,bp
   183 00000094 780D                    		js		.slpe_n
   184                                  
   185 00000096 89DD                    .slpe_p		mov		bp,bx
   186 00000098 01C3                    			add		bx,ax
   187 0000009A 29C5                    			sub		bp,ax
   188                                  
   189 0000009C 31D2                    			xor		dx,dx
   190 0000009E B93F01                  			mov		cx,RIGHT_EDGE
   191                                  
   192 000000A1 EB0B                    			jmp		.slpe_c
   193                                  
   194 000000A3 89DD                    .slpe_n		mov		bp,bx
   195 000000A5 01C5                    			add		bp,ax
   196 000000A7 29C3                    			sub		bx,ax
   197                                  
   198 000000A9 31C9                    			xor		cx,cx
   199 000000AB BA3F01                  			mov		dx,RIGHT_EDGE
   200                                  		
   201 000000AE 8916[A281]              .slpe_c	mov		[XST],dx
   202 000000B2 892E[A481]              		mov		[YST],bp
   203 000000B6 890E[A681]              		mov		[XEN],cx
   204 000000BA 891E[A881]              		mov		[YEN],bx
   205                                  
   206 000000BE 85DB                    		test	bx,bx	; bottom if off top
   207 000000C0 7903E97601              		js		.fill_whole_sky
   208                                  
   209 000000C5 81FDC700                		cmp		bp,BOTTOM_EDGE	; top if off bottom
   210 000000C9 7E03E97801              		jg		.fill_whole_ground
   211                                  
   212 000000CE 85ED                    		test	bp,bp		; is top off top
   213 000000D0 791C                    		jns		.clpt_c		; no
   214 000000D2 89C8                    			mov		ax,cx
   215 000000D4 29D0                    			sub		ax,dx	;	ax=(endx-sttx) = (cx-dx)
   216 000000D6 89DE                    			mov		si,bx
   217 000000D8 29EE                    			sub		si,bp	;	si=(endy-stty) = (bx-bp)
   218                                  
   219 000000DA 89D7                    			mov		di,dx	; backup sttx
   220                                  
   221 000000DC F7ED                    			imul	bp		; 	ax = ( (ex-sx) *sy)
   222 000000DE F7FE                    			idiv	si		; 	ax = ( ( (ex-sx) *sy ) / (ey-sy) )
   223 000000E0 29C7                    			sub		di,ax	;	sx = sx - ( ( (ex-sx) *sy ) / (ey-sy) );
   224 000000E2 893E[A281]              			mov		[XST],di
   225 000000E6 31ED                    			xor		bp,bp
   226 000000E8 892E[A481]              			mov		[YST],bp
   227 000000EC EB14                    			jmp		.clpt_e
   228                                  
   229 000000EE 7412                    .clpt_c		je	.clpt_e		; is top on the top edge
   230 000000F0 89EE                    				mov		si,bp	; backup
   231 000000F2 51                      				push	cx
   232 000000F3 53                      				push	bx
   233                                  
   234 000000F4 89EB                    				mov		bx,bp
   235 000000F6 31ED                    				xor		bp,bp
   236 000000F8 B8AAAA                  				mov		ax,1010101010101010b ; 1001110001111000b
   237 000000FB E8DB01                  				call	FillBlock
   238                                  
   239 000000FE 5B                      				pop		bx		; restore
   240 000000FF 59                      				pop		cx
   241 00000100 89F5                    				mov		bp,si
   242                                  
   243 00000102 81FBC700                .clpt_e cmp		bx,BOTTOM_EDGE
   244 00000106 7E21                    		jle		.clpb_c
   245                                  
   246 00000108 89C8                    			mov		ax,cx
   247 0000010A 29D0                    			sub		ax,dx	;	ax=(endx-sttx) = (cx-dx)
   248 0000010C 89DE                    			mov		si,bx
   249 0000010E 29EE                    			sub		si,bp	;	si=(endy-stty) = (bx-bp)
   250                                  
   251 00000110 89DF                    			mov		di,bx	
   252 00000112 81EFC700                			sub		di,BOTTOM_EDGE	; di = (endy-DIBHeight) = (bx-BOTTOM_EDGE)
   253                                  
   254 00000116 F7EF                    			imul	di		; 	ax = ( (ex-sx) * (ey-DIBHeight) )
   255 00000118 F7FE                    			idiv	si		; 	ax = ( ( (ex-sx) * (ey-DIBHeight) ) / (ey-sy) )
   256 0000011A 29C1                    			sub		cx,ax	;	ex = ex - ( ( (ex-sx) * (ey-DIBHeight) ) / (ey-sy) );
   257 0000011C 890E[A681]              			mov		[XEN],cx
   258 00000120 BBC700                  			mov		bx,BOTTOM_EDGE
   259 00000123 891E[A881]              			mov		[YEN],bx
   260 00000127 EB17                    			jmp		.clpb_e
   261                                  
   262 00000129 7415                    .clpb_c:	je	.clpb_e		; is bottom on the bottom edge
   263                                  
   264 0000012B 89EE                    				mov		si,bp	; backup
   265 0000012D 51                      				push	cx
   266 0000012E 53                      				push	bx
   267                                  
   268 0000012F BDC700                  .				mov		bp,BOTTOM_EDGE
   269 00000132 29DD                    				sub		bp,bx
   270 00000134 87EB                    				xchg	bp,bx
   271                                  ;		mov [Test9],bx
   272                                  ;		mov [Test10],bp
   273 00000136 B85555                  				mov		ax,0101010101010101b ; 1001110001111000b ; 0101010101010101b ; 1001110001111000b
   274 00000139 E89D01                  				call	FillBlock
   275                                  
   276 0000013C 5B                      				pop		bx		; restore
   277 0000013D 59                      				pop		cx
   278 0000013E 89F5                    				mov		bp,si
   279                                  
   280                                  ; hdiff = xen-xst
   281                                  ; vdiff = yen-yst
   282                                  
   283                                  ; (hdiff *128) / (vdiff/2)
   284                                  
   285                                  .clpb_e:
   286 00000140 8B0E[A281]              		mov		cx,[XST]
   287 00000144 8B16[A481]              		mov		dx,[YST]
   288 00000148 8B2E[A681]              		mov		bp,[XEN]
   289 0000014C 8B36[A881]              		mov		si,[YEN]
   290                                  		
   291                                  ;	mov		[Test1],cx
   292                                  ;	mov		[Test2],dx
   293                                  ;	mov		[Test3],bp
   294                                  ;	mov		[Test4],si
   295                                  
   296                                  ;		call	Line11
   297                                  
   298 00000150 8B0E[A881]              		mov		cx,[YEN]
   299 00000154 8B1E[A481]              		mov		bx,[YST]
   300 00000158 29D9                    		sub		cx,bx
   301 0000015A 890E[B081]              		mov		[VDiff],cx
   302                                  ;	mov		[Test9],cx ; vdiff
   303                                  
   304                                  ;		sar		cx,1
   305                                  ;		mov		[Test10],cx ; vdiff /2
   306 0000015E 7507                    		jne		.lne_c
   307 00000160 31C0                    			xor		ax,ax
   308 00000162 A3[B281]                			mov		[Slope],ax
   309 00000165 EB2E                    			jmp		.cont
   310                                  
   311 00000167 8B2E[B481]              .lne_c:	mov		bp,[HorDir]
   312 0000016B 85ED                    		test	bp,bp
   313 0000016D 790B                    		jns		.lft_ln
   314 0000016F A1[A281]                			mov		ax,[XST]
   315 00000172 8B1E[A681]              			mov		bx,[XEN]
   316 00000176 29D8                    			sub		ax,bx
   317 00000178 EB09                    			jmp		.cnt1
   318                                  .lft_ln:
   319 0000017A A1[A681]                			mov		ax,[XEN]
   320 0000017D 8B1E[A281]              			mov		bx,[XST]
   321 00000181 29D8                    			sub		ax,bx
   322                                  
   323 00000183 A3[AE81]                .cnt1:	mov		[HDiff],ax
   324                                  ;	mov		[Test8],ax
   325 00000186 B107                    		mov		cl,7
   326 00000188 D3E0                    		sal		ax,cl		; hdiff *128
   327 0000018A 31D2                    		xor 	dx,dx
   328                                  ;	mov		[Test7],ax
   329 0000018C 8B0E[B081]              		mov		cx,[VDiff]
   330                                  ;	mov		cx,[Test10]
   331 00000190 F7F1                    		div		cx
   332                                  ;;		add ax,ax
   333                                  ;	mov		[Test6],ax
   334 00000192 A3[B281]                		mov		[Slope],ax
   335                                  
   336                                  .cont:
   337 00000195 8B36[B081]              		mov		si,[VDiff]
   338 00000199 85F6                    		test	si,si
   339 0000019B 7503E99A00              		je		.no_slope
   340                                  
   341 000001A0 8B16[A281]              		mov		dx,[XST]
   342 000001A4 B90700                  		mov		cx,7
   343 000001A7 D3E2                    		sal		dx,cl
   344                                  
   345 000001A9 8B2E[A481]              		mov		bp,[YST]
   346 000001AD 01ED                    		add		bp,bp
   347                                  	
   348 000001AF 8B3E[B281]              		mov		di,[Slope]
   349                                  	
   350 000001B3 8B1E[B481]              		mov		bx,[HorDir]
   351 000001B7 85DB                    		test	bx,bx
   352 000001B9 7840                    		js		.filln
   353                                  
   354 000001BB 893E[F501]              .fillp:	mov		[.fillpval+2],di
   355                                  
   356 000001BF 8BBE[0000]              .fillplp:	mov		di,[BackBufferTable+bp]
   357 000001C3 89D3                    			mov		bx,dx
   358                                  			
   359 000001C5 86FB                    			xchg	bh,bl	;	v???????vvvvvvvv
   360 000001C7 00FF                    			add 	bh,bh	;	???????0vvvvvvvv c
   361 000001C9 30FF                    			xor 	bh,bh	;	00000000vvvvvvvv c
   362 000001CB D1D3                    			rcl 	bx,1	;	0000000vvvvvvvvc
   363                                  
   364 000001CD 8A8F[8002]              	mov		cl,[FillTabLeft+bx]
   365 000001D1 B85555                  	mov		ax,0101010101010101b
   366 000001D4 D0E9                    	shr		cl,1	; shift lsb into carry
   367 000001D6 F3AB                    	rep		stosw
   368 000001D8 D0D1                    	rcl		cl,1	; rotate lsb from carry
   369 000001DA F3AA                    	rep		stosb
   370                                  
   371 000001DC 8A87[0000]              			mov 	al,[FillCharLeftTab+bx]
   372 000001E0 AA                      			stosb
   373                                  
   374 000001E1 8A8F[C003]              	mov		cl,[FillTabRight+bx]
   375 000001E5 B8AAAA                  	mov		ax,1010101010101010b
   376 000001E8 D0E9                    	shr		cl,1	; shift lsb into carry
   377 000001EA F3AB                    	rep		stosw
   378 000001EC D0D1                    	rcl		cl,1	; rotate lsb from carry
   379 000001EE F3AA                    	rep		stosb
   380                                  
   381 000001F0 83C502                  			add		bp,2
   382                                  
   383 000001F3 81C2D204                .fillpval:	add		dx,1234
   384 000001F7 4E                      			dec		si
   385 000001F8 75C5                    			jnz		.fillplp
   386 000001FA C3                      		ret
   387                                  
   388 000001FB 893E[3502]              .filln:	mov		[.fillnval+2],di
   389                                  
   390 000001FF 8BBE[0000]              .fillnlp:	mov		di,[BackBufferTable+bp]
   391 00000203 89D3                    			mov		bx,dx
   392                                  
   393 00000205 86FB                    			xchg	bh,bl	;	v???????vvvvvvvv
   394 00000207 00FF                    			add 	bh,bh	;	???????0vvvvvvvv c
   395 00000209 30FF                    			xor 	bh,bh	;	00000000vvvvvvvv c
   396 0000020B D1D3                    			rcl 	bx,1	;	0000000vvvvvvvvc
   397                                  
   398 0000020D 8A8F[8002]              			mov		cl,[FillTabLeft+bx]
   399 00000211 B8AAAA                  			mov		ax,1010101010101010b
   400 00000214 D0E9                    		shr		cl,1	; shift lsb into carry
   401 00000216 F3AB                    		rep		stosw
   402 00000218 D0D1                    		rcl		cl,1	; rotate lsb from carry
   403 0000021A F3AA                    		rep		stosb
   404                                  
   405 0000021C 8A87[4001]              			mov 	al,[FillCharRightTab+bx]
   406 00000220 AA                      			stosb
   407                                  
   408 00000221 8A8F[C003]              		mov		cl,[FillTabRight+bx]
   409 00000225 B85555                  		mov		ax,0101010101010101b
   410 00000228 D0E9                    		shr		cl,1	; shift lsb into carry
   411 0000022A F3AB                    		rep		stosw
   412 0000022C D0D1                    		rcl		cl,1	; rotate lsb from carry
   413 0000022E F3AA                    		rep		stosb
   414                                  
   415 00000230 83C502                  			add		bp,2
   416 00000233 81EAD204                .fillnval:	sub		dx,1234
   417 00000237 4E                      			dec		si
   418 00000238 75C5                    			jnz		.fillnlp
   419                                  
   420                                  .no_slope:
   421 0000023A C3                      		ret
   422                                  
   423 0000023B B85555                  .fill_whole_sky:	mov		ax,0101010101010101b
   424 0000023E 31ED                    					xor		bp,bp
   425 00000240 BBC800                  					mov		bx,200
   426 00000243 E99300                  					jmp		FillBlock
   427                                  
   428 00000246 B8AAAA                  .fill_whole_ground:	mov		ax,1010101010101010b
   429 00000249 31ED                    					xor		bp,bp
   430 0000024B BBC800                  					mov		bx,200
   431 0000024E E98800                  					jmp		FillBlock
   432                                  
   433                                  
   434                                  ;fill_blocks
   435                                  ; if hst ne 0
   436                                  ; calc lines = hst
   437                                  ; fill top block (0(bp),lines=bx,colour(ax))
   438                                  ; endif
   439                                  ; if hend ne 199
   440                                  ; fill bottom block(hen(bp),(199-hen)=bx,colour(ax))
   441                                  ; endif
   442                                  
   443                                  ;Fill_Block:
   444                                  ;	inc
   445                                  	
   446                                  ; fill block()
   447                                  ; inc bl (number of lines)
   448                                  ; bl/2 (number of lines/2)
   449                                  ; di = vertab(bp) start line
   450                                  ; cx= wordcounttab(bx) (number of lines *40 (words))
   451                                  ; rep stosw (40*cx)
   452                                  ; di = vertab(bp+1) start line other page
   453                                  ; cx= wordcounttab(bx) (number of lines *40 (words))
   454                                  ; rep stosw (40*cx)
   455                                  ; ret
   456                                  
   457                                  GetKey:
   458 00000251 B411                    	mov	ah,11h
   459 00000253 CD16                    	int	16h         	; has a key been pressed
   460 00000255 7418                    	jz	.key_none ; no
   461 00000257 B410                    	mov	ah,10h      ; yes 
   462 00000259 CD16                    	int	16h         	; get it in AX (al= ascii, ah=scan code)
   463 0000025B 3C1B                    	cmp	al,KEY_ESC
   464 0000025D 7411                    	je	.key_esc
   465 0000025F 3C71                    	cmp 	al,KEY_Q
   466 00000261 7413                    	je 	.key_q
   467 00000263 3C77                    	cmp 	al,KEY_W
   468 00000265 741A                    	je 	.key_w
   469 00000267 3C65                    	cmp 	al,KEY_E
   470 00000269 7421                    	je 	.key_e
   471 0000026B 3C72                    	cmp 	al,KEY_R
   472 0000026D 7428                    	je 	.key_r
   473                                  .key_none:
   474 0000026F C3                      	ret
   475 00000270 B001                    .key_esc:	mov	al,1
   476 00000272 A2[B881]                		mov	[Exit],al
   477 00000275 C3                      		ret
   478 00000276 A1[9481]                .key_q:	mov	ax,[XAngle]
   479 00000279 40                      		inc	ax
   480 0000027A 80E403                  		and ah,03
   481 0000027D A3[9481]                		mov	[XAngle],ax
   482 00000280 C3                      		ret
   483 00000281 A1[9481]                .key_w:	mov	ax,[XAngle]
   484 00000284 48                      		dec	ax
   485 00000285 80E403                  		and ah,3
   486 00000288 A3[9481]                		mov	[XAngle],ax
   487 0000028B C3                      		ret
   488 0000028C A1[9681]                .key_e:	mov	ax,[YAngle]
   489 0000028F 40                      		inc	ax
   490 00000290 80E403                  		and ah,3
   491 00000293 A3[9681]                		mov	[YAngle],ax
   492 00000296 C3                      		ret
   493 00000297 A1[9681]                .key_r:	mov	ax,[YAngle]
   494 0000029A 48                      		dec	ax
   495 0000029B 80E403                  		and ah,3
   496 0000029E A3[9681]                		mov	[YAngle],ax
   497 000002A1 C3                      		ret
   498 000002A2 C3                      		ret
   499                                  
   500 000002A3 BADA03                  WaitVSync: 			mov		dx,INPUT_STATUS_1	; Wait for the leading edge of vertical sync pulse.
   501 000002A6 EC                      WaitNotVSyncLoop:		in		al,dx
   502 000002A7 2408                    						and		al,VSYNC_MASK
   503 000002A9 75FB                    						jnz		WaitNotVSyncLoop
   504 000002AB EC                      WaitVSyncLoop:			in		al,dx
   505 000002AC 2408                    						and		al,VSYNC_MASK
   506 000002AE 74FB                    						jz		WaitVSyncLoop
   507 000002B0 C3                      					ret
   508                                  		
   509                                  CopyClearBackBuffer:
   510 000002B1 FC                      	cld
   511                                  
   512 000002B2 8CDD                    	mov		bp,ds			; backup ds
   513                                  
   514 000002B4 8B16[B681]              	mov		dx,[BackBufferSeg]
   515 000002B8 8EDA                    	mov		ds,dx
   516                                  
   517 000002BA B800B8                  	mov		ax,VIDEO_SEGMENT
   518 000002BD 8EC0                    	mov		es,ax
   519                                  
   520 000002BF 31F6                    	xor		si,si		; DS:SI points to even back buffer
   521 000002C1 89F7                    	mov		di,si		; ES:DI points to CGA memory.
   522                                  
   523 000002C3 B9A00F                  	mov		cx,4000
   524 000002C6 F3A5                    	rep	movsw			; copy from ds:si to es:di
   525                                  
   526 000002C8 BE0020                  	mov		si,8192		; DS:SI points to odd back buffer
   527 000002CB 89F7                    	mov		di,si		; ES:DI points to CGA memory.
   528                                  
   529 000002CD B9A00F                  	mov		cx,4000
   530 000002D0 F3A5                    	rep	movsw			; copy from ds:si to es:di
   531                                  
   532 000002D2 8CD8                    	mov		ax,ds		; es points to ds
   533 000002D4 8EC0                    	mov		es,ax
   534 000002D6 8EDD                    	mov		ds,bp			; restore ds
   535                                  
   536 000002D8 C3                      	ret
   537                                  
   538                                  FillBlock:
   539 000002D9 FEC3                    	inc		bl
   540 000002DB 80E3FE                  	and		bl,255-1
   541 000002DE 01ED                    	add		bp,bp
   542                                  
   543 000002E0 8BBE[0000]              	mov		di,[BackBufferTable+bp]
   544 000002E4 8B8F[0009]              	mov		cx,[FillBlockTab+bx]
   545 000002E8 F3AB                    	rep		stosw
   546                                  
   547 000002EA 8BBE[0200]              	mov		di,[BackBufferTable+2+bp]
   548 000002EE 8B8F[0009]              	mov		cx,[FillBlockTab+bx]
   549 000002F2 F3AB                    	rep		stosw
   550                                  
   551 000002F4 C3                      	ret
   552                                  
   553 000002F5 80FF00                  GetSin256:	cmp		bh,0
   554 000002F8 740A                    			je		.s000090
   555 000002FA 80FF01                  .s090180:	cmp		bh,1
   556 000002FD 750A                    			jne		.s180270
   557 000002FF 30FF                    				xor		bh,bh
   558 00000301 80F3FF                  				xor		bl,255
   559 00000304 8A87[180A]              .s000090		mov		al,[sintab+bx]
   560 00000308 C3                      				ret
   561 00000309 80FF02                  .s180270:	cmp		bh,2
   562 0000030C 7509                    			jne		.s270000
   563 0000030E 30FF                    				xor		bh,bh
   564 00000310 8A87[180A]              				mov		al,[sintab+bx]
   565 00000314 F6D8                    				neg		al
   566 00000316 C3                      				ret
   567 00000317 30FF                    .s270000:	xor		bh,bh
   568 00000319 80F3FF                  			xor		bl,255
   569 0000031C 8A87[180A]              			mov		al,[sintab+bx]
   570 00000320 F6D8                    			neg		al
   571 00000322 C3                      			ret
   572                                  
   573 00000323 89EB                    SinCosV2:	mov		bx,bp
   574 00000325 E8CDFF                  			call	GetSin256
   575 00000328 98                      			cbw
   576 00000329 89EB                    			mov		bx,bp
   577 0000032B 89C5                    			mov		bp,ax
   578 0000032D FEC7                    			inc		bh
   579 0000032F 80E703                  			and		bh,3
   580 00000332 E8C0FF                  			call	GetSin256
   581 00000335 98                      			cbw
   582 00000336 C3                      			ret			
   583                                  
   584 00000337 89FE                    HexChar:	mov		si,di
   585 00000339 88C3                    			mov		bl,al
   586 0000033B D0EB                    			shr		bl,1
   587 0000033D D0EB                    			shr		bl,1
   588 0000033F D0EB                    			shr		bl,1
   589 00000341 D0EB                    			shr		bl,1
   590 00000343 83E30F                  			and		bx,15
   591 00000346 8AA7[C809]              			mov		ah,[Hex0+bx]
   592 0000034A 268825                  			mov		[es:di],ah
   593 0000034D 81C70020                			add		di,8192
   594 00000351 8AA7[D809]              			mov		ah,[Hex1+bx]
   595 00000355 268825                  			mov		[es:di],ah
   596 00000358 81EFB01F                			sub		di,8192-80
   597 0000035C 8AA7[E809]              			mov		ah,[Hex2+bx]
   598 00000360 268825                  			mov		[es:di],ah
   599 00000363 81C70020                			add		di,8192
   600 00000367 8AA7[F809]              			mov		ah,[Hex3+bx]
   601 0000036B 268825                  			mov		[es:di],ah
   602 0000036E 81EFB01F                			sub		di,8192-80
   603 00000372 8AA7[080A]              			mov		ah,[Hex4+bx]
   604 00000376 268825                  			mov		[es:di],ah
   605                                  
   606 00000379 89F7                    			mov		di,si
   607 0000037B 47                      			inc		di
   608                                  
   609 0000037C 88C3                    			mov		bl,al
   610 0000037E 80E30F                  			and		bl,15
   611 00000381 8A87[C809]              			mov		al,[Hex0+bx]
   612 00000385 268805                  			mov		[es:di],al
   613 00000388 81C70020                			add		di,8192
   614 0000038C 8A87[D809]              			mov		al,[Hex1+bx]
   615 00000390 268805                  			mov		[es:di],al
   616 00000393 81EFB01F                			sub		di,8192-80
   617 00000397 8A87[E809]              			mov		al,[Hex2+bx]
   618 0000039B 268805                  			mov		[es:di],al
   619 0000039E 81C70020                			add		di,8192
   620 000003A2 8A87[F809]              			mov		al,[Hex3+bx]
   621 000003A6 268805                  			mov		[es:di],al
   622 000003A9 81EFB01F                			sub		di,8192-80
   623 000003AD 8A87[080A]              			mov		al,[Hex4+bx]
   624 000003B1 268805                  			mov		[es:di],al
   625 000003B4 C3                      			ret
   626                                  
   627 000003B5 50                      Hex32:		push	ax
   628                                  
   629 000003B6 52                      			push	dx
   630 000003B7 53                      			push	bx
   631 000003B8 88F0                    			mov		al,dh
   632 000003BA E84600                  			call	Hex8
   633                                  						
   634 000003BD 5B                      			pop		bx
   635 000003BE 5A                      			pop		dx
   636                                  
   637 000003BF 53                      			push	bx
   638 000003C0 88D0                    			mov		al,dl
   639 000003C2 BF0200                  			mov		di,2
   640 000003C5 E83D00                  			call	HexByte
   641                                  
   642 000003C8 5B                      			pop		bx
   643 000003C9 58                      			pop		ax
   644                                  
   645 000003CA 50                      			push	ax
   646 000003CB 53                      			push	bx
   647 000003CC 88E0                    			mov		al,ah
   648 000003CE BF0400                  			mov		di,4
   649 000003D1 E83100                  			call	HexByte
   650                                  
   651 000003D4 5B                      			pop		bx
   652 000003D5 58                      			pop		ax
   653 000003D6 BF0600                  			mov		di,6
   654 000003D9 EB2A                    			jmp		HexByte	; does ret
   655                                  
   656 000003DB 50                      Hex24:		push	ax
   657 000003DC 53                      			push	bx
   658                                  
   659 000003DD 88F8                    			mov		al,bh
   660 000003DF E82100                  			call	Hex8
   661                                  						
   662 000003E2 5B                      			pop		bx
   663 000003E3 58                      			pop		ax
   664                                  
   665 000003E4 50                      			push	ax
   666 000003E5 53                      			push	bx
   667                                  
   668 000003E6 BF0200                  			mov		di,2
   669 000003E9 E81900                  			call	HexByte
   670                                  
   671 000003EC 5B                      			pop		bx
   672 000003ED 58                      			pop		ax
   673                                  
   674 000003EE 88E0                    			mov		al,ah
   675 000003F0 BF0400                  			mov		di,4
   676 000003F3 EB10                    			jmp		HexByte	; does ret
   677                                  
   678 000003F5 50                      Hex16:		push	ax
   679 000003F6 53                      			push	bx
   680                                  
   681 000003F7 88E0                    			mov		al,ah
   682 000003F9 E80700                  			call	Hex8
   683                                  						
   684 000003FC 5B                      			pop		bx
   685 000003FD 58                      			pop		ax
   686                                  
   687 000003FE BF0200                  			mov		di,2
   688 00000401 EB02                    			jmp		HexByte ; does ret
   689                                  
   690 00000403 31FF                    Hex8:		xor		di,di
   691 00000405 30FF                    HexByte:	xor		bh,bh
   692 00000407 88DC                    			mov		ah,bl
   693 00000409 00E4                    			add		ah,ah	; *2
   694 0000040B 00E3                    			add		bl,ah	; *3
   695 0000040D 01DB                    			add		bx,bx	; *6
   696 0000040F 01DB                    			add		bx,bx	; *12
   697 00000411 03BF[0000]              			add		di,[BackBufferTable+bx]	; lookup start ver
   698 00000415 E91FFF                  			jmp		HexChar	 ; does ret
   699                                  ;			ret
   700                                  
   701                                  section .data align=8 ; 16 ; 8 ; 16
   702                                  	
   703                                  FillCharLeftTab:
   704                                  %rep    80
   705                                  	db	10101010b,01101010b,01011010b,01010110b
   706                                  %endrep
   705 00000000 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000004 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000008 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 0000000C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000010 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000014 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000018 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 0000001C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000020 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000024 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000028 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 0000002C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000030 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000034 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000038 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 0000003C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000040 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000044 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000048 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 0000004C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000050 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000054 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000058 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 0000005C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000060 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000064 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000068 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 0000006C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000070 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000074 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000078 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 0000007C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000080 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000084 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000088 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 0000008C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000090 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000094 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000098 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 0000009C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000A0 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000A4 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000A8 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000AC AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000B0 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000B4 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000B8 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000BC AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000C0 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000C4 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000C8 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000CC AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000D0 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000D4 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000D8 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000DC AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000E0 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000E4 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000E8 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000EC AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000F0 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000F4 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000F8 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 000000FC AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000100 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000104 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000108 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 0000010C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000110 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000114 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000118 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 0000011C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000120 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000124 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000128 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 0000012C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000130 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000134 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 00000138 AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   705 0000013C AA6A5A56            <1>  db 10101010b,01101010b,01011010b,01010110b
   707                                  
   708                                  
   709                                  FillCharRightTab:
   710                                  %rep    80
   711                                  	db	01010101b,10010101b,10100101b,10101001b
   712                                  %endrep
   711 00000140 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000144 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000148 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 0000014C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000150 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000154 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000158 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 0000015C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000160 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000164 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000168 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 0000016C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000170 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000174 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000178 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 0000017C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000180 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000184 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000188 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 0000018C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000190 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000194 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000198 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 0000019C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001A0 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001A4 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001A8 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001AC 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001B0 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001B4 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001B8 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001BC 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001C0 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001C4 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001C8 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001CC 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001D0 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001D4 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001D8 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001DC 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001E0 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001E4 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001E8 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001EC 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001F0 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001F4 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001F8 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 000001FC 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000200 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000204 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000208 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 0000020C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000210 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000214 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000218 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 0000021C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000220 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000224 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000228 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 0000022C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000230 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000234 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000238 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 0000023C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000240 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000244 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000248 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 0000024C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000250 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000254 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000258 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 0000025C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000260 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000264 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000268 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 0000026C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000270 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000274 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 00000278 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   711 0000027C 5595A5A9            <1>  db 01010101b,10010101b,10100101b,10101001b
   713                                  
   714                                  FillTabLeft:
   715 00000280 00000000                	db	0,0,0,0
   716 00000284 01010101                	db	1,1,1,1
   717 00000288 02020202                	db	2,2,2,2
   718 0000028C 03030303                	db	3,3,3,3
   719 00000290 04040404                	db	4,4,4,4
   720 00000294 05050505                	db	5,5,5,5
   721 00000298 06060606                	db	6,6,6,6
   722 0000029C 07070707                	db	7,7,7,7
   723 000002A0 08080808                	db	8,8,8,8
   724 000002A4 09090909                	db	9,9,9,9
   725 000002A8 0A0A0A0A                	db	10,10,10,10
   726 000002AC 0B0B0B0B                	db	11,11,11,11
   727 000002B0 0C0C0C0C                	db	12,12,12,12
   728 000002B4 0D0D0D0D                	db	13,13,13,13
   729 000002B8 0E0E0E0E                	db	14,14,14,14
   730 000002BC 0F0F0F0F                	db	15,15,15,15
   731 000002C0 10101010                	db	16,16,16,16
   732 000002C4 11111111                	db	17,17,17,17
   733 000002C8 12121212                	db	18,18,18,18
   734 000002CC 13131313                	db	19,19,19,19
   735 000002D0 14141414                	db	20,20,20,20
   736 000002D4 15151515                	db	21,21,21,21
   737 000002D8 16161616                	db	22,22,22,22
   738 000002DC 17171717                	db	23,23,23,23
   739 000002E0 18181818                	db	24,24,24,24
   740 000002E4 19191919                	db	25,25,25,25
   741 000002E8 1A1A1A1A                	db	26,26,26,26
   742 000002EC 1B1B1B1B                	db	27,27,27,27
   743 000002F0 1C1C1C1C                	db	28,28,28,28
   744 000002F4 1D1D1D1D                	db	29,29,29,29
   745 000002F8 1E1E1E1E                	db	30,30,30,30
   746 000002FC 1F1F1F1F                	db	31,31,31,31
   747 00000300 20202020                	db	32,32,32,32
   748 00000304 21212121                	db	33,33,33,33
   749 00000308 22222222                	db	34,34,34,34
   750 0000030C 23232323                	db	35,35,35,35
   751 00000310 24242424                	db	36,36,36,36
   752 00000314 25252525                	db	37,37,37,37
   753 00000318 26262626                	db	38,38,38,38
   754 0000031C 27272727                	db	39,39,39,39
   755 00000320 28282828                	db	40,40,40,40
   756 00000324 29292929                	db	41,41,41,41
   757 00000328 2A2A2A2A                	db	42,42,42,42
   758 0000032C 2B2B2B2B                	db	43,43,43,43
   759 00000330 2C2C2C2C                	db	44,44,44,44
   760 00000334 2D2D2D2D                	db	45,45,45,45
   761 00000338 2E2E2E2E                	db	46,46,46,46
   762 0000033C 2F2F2F2F                	db	47,47,47,47
   763 00000340 30303030                	db	48,48,48,48
   764 00000344 31313131                	db	49,49,49,49
   765 00000348 32323232                	db	50,50,50,50
   766 0000034C 33333333                	db	51,51,51,51
   767 00000350 34343434                	db	52,52,52,52
   768 00000354 35353535                	db	53,53,53,53
   769 00000358 36363636                	db	54,54,54,54
   770 0000035C 37373737                	db	55,55,55,55
   771 00000360 38383838                	db	56,56,56,56
   772 00000364 39393939                	db	57,57,57,57
   773 00000368 3A3A3A3A                	db	58,58,58,58
   774 0000036C 3B3B3B3B                	db	59,59,59,59
   775 00000370 3C3C3C3C                	db	60,60,60,60
   776 00000374 3D3D3D3D                	db	61,61,61,61
   777 00000378 3E3E3E3E                	db	62,62,62,62
   778 0000037C 3F3F3F3F                	db	63,63,63,63
   779 00000380 40404040                	db	64,64,64,64
   780 00000384 41414141                	db	65,65,65,65
   781 00000388 42424242                	db	66,66,66,66
   782 0000038C 43434343                	db	67,67,67,67
   783 00000390 44444444                	db	68,68,68,68
   784 00000394 45454545                	db	69,69,69,69
   785 00000398 46464646                	db	70,70,70,70
   786 0000039C 47474747                	db	71,71,71,71
   787 000003A0 48484848                	db	72,72,72,72
   788 000003A4 49494949                	db	73,73,73,73
   789 000003A8 4A4A4A4A                	db	74,74,74,74
   790 000003AC 4B4B4B4B                	db	75,75,75,75
   791 000003B0 4C4C4C4C                	db	76,76,76,76
   792 000003B4 4D4D4D4D                	db	77,77,77,77
   793 000003B8 4E4E4E4E                	db	78,78,78,78
   794 000003BC 4F4F4F4F                	db	79,79,79,79
   795                                  
   796                                  FillTabRight:
   797 000003C0 4F4F4F4F                	db	79,79,79,79,
   798 000003C4 4E4E4E4E                	db	78,78,78,78,
   799 000003C8 4D4D4D4D                	db	77,77,77,77,
   800 000003CC 4C4C4C4C                	db	76,76,76,76,
   801 000003D0 4B4B4B4B                	db	75,75,75,75,
   802 000003D4 4A4A4A4A                	db	74,74,74,74,
   803 000003D8 49494949                	db	73,73,73,73,
   804 000003DC 48484848                	db	72,72,72,72,
   805 000003E0 47474747                	db	71,71,71,71,
   806 000003E4 46464646                	db	70,70,70,70,
   807 000003E8 45454545                	db	69,69,69,69,
   808 000003EC 44444444                	db	68,68,68,68,
   809 000003F0 43434343                	db	67,67,67,67,
   810 000003F4 42424242                	db	66,66,66,66,
   811 000003F8 41414141                	db	65,65,65,65,
   812 000003FC 40404040                	db	64,64,64,64,
   813 00000400 3F3F3F3F                	db	63,63,63,63,
   814 00000404 3E3E3E3E                	db	62,62,62,62,
   815 00000408 3D3D3D3D                	db	61,61,61,61,
   816 0000040C 3C3C3C3C                	db	60,60,60,60,
   817 00000410 3B3B3B3B                	db	59,59,59,59,
   818 00000414 3A3A3A3A                	db	58,58,58,58,
   819 00000418 39393939                	db	57,57,57,57,
   820 0000041C 38383838                	db	56,56,56,56,
   821 00000420 37373737                	db	55,55,55,55,
   822 00000424 36363636                	db	54,54,54,54,
   823 00000428 35353535                	db	53,53,53,53,
   824 0000042C 34343434                	db	52,52,52,52,
   825 00000430 33333333                	db	51,51,51,51,
   826 00000434 32323232                	db	50,50,50,50,
   827 00000438 31313131                	db	49,49,49,49,
   828 0000043C 30303030                	db	48,48,48,48,
   829 00000440 2F2F2F2F                	db	47,47,47,47,
   830 00000444 2E2E2E2E                	db	46,46,46,46,
   831 00000448 2D2D2D2D                	db	45,45,45,45,
   832 0000044C 2C2C2C2C                	db	44,44,44,44,
   833 00000450 2B2B2B2B                	db	43,43,43,43,
   834 00000454 2A2A2A2A                	db	42,42,42,42,
   835 00000458 29292929                	db	41,41,41,41,
   836 0000045C 28282828                	db	40,40,40,40,
   837 00000460 27272727                	db	39,39,39,39,
   838 00000464 26262626                	db	38,38,38,38,
   839 00000468 25252525                	db	37,37,37,37,
   840 0000046C 24242424                	db	36,36,36,36,
   841 00000470 23232323                	db	35,35,35,35,
   842 00000474 22222222                	db	34,34,34,34,
   843 00000478 21212121                	db	33,33,33,33,
   844 0000047C 20202020                	db	32,32,32,32,
   845 00000480 1F1F1F1F                	db	31,31,31,31,
   846 00000484 1E1E1E1E                	db	30,30,30,30,
   847 00000488 1D1D1D1D                	db	29,29,29,29,
   848 0000048C 1C1C1C1C                	db	28,28,28,28,
   849 00000490 1B1B1B1B                	db	27,27,27,27,
   850 00000494 1A1A1A1A                	db	26,26,26,26,
   851 00000498 19191919                	db	25,25,25,25,
   852 0000049C 18181818                	db	24,24,24,24,
   853 000004A0 17171717                	db	23,23,23,23,
   854 000004A4 16161616                	db	22,22,22,22,
   855 000004A8 15151515                	db	21,21,21,21,
   856 000004AC 14141414                	db	20,20,20,20,
   857 000004B0 13131313                	db	19,19,19,19,
   858 000004B4 12121212                	db	18,18,18,18,
   859 000004B8 11111111                	db	17,17,17,17,
   860 000004BC 10101010                	db	16,16,16,16,
   861 000004C0 0F0F0F0F                	db	15,15,15,15,
   862 000004C4 0E0E0E0E                	db	14,14,14,14,
   863 000004C8 0D0D0D0D                	db	13,13,13,13,
   864 000004CC 0C0C0C0C                	db	12,12,12,12,
   865 000004D0 0B0B0B0B                	db	11,11,11,11,
   866 000004D4 0A0A0A0A                	db	10,10,10,10,
   867 000004D8 09090909                	db	9,9,9,9
   868 000004DC 08080808                	db	8,8,8,8
   869 000004E0 07070707                	db	7,7,7,7
   870 000004E4 06060606                	db	6,6,6,6
   871 000004E8 05050505                	db	5,5,5,5
   872 000004EC 04040404                	db	4,4,4,4
   873 000004F0 03030303                	db	3,3,3,3
   874 000004F4 02020202                	db	2,2,2,2
   875 000004F8 01010101                	db	1,1,1,1
   876 000004FC 00000000                	db	0,0,0,0
   877                                  
   878                                  ; if < 256 ver = 100 + (pitch &255)
   879                                  ; else ver = 100 - ( 255 - (pitch &255) )
   880                                  
   881                                  HorizonTable:
   882 00000500 640065006600670068-     	dw	100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,
   882 00000509 0069006A006B006C00-
   882 00000512 6D006E006F00700071-
   882 0000051B 007200730074007500-
   882 00000524 76007700780079007A-
   882 0000052D 007B007C007D007E00-
   882 00000536 7F0080008100820083-
   882 0000053F 00                 
   883 00000540 840085008600870088-     	dw	132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,
   883 00000549 0089008A008B008C00-
   883 00000552 8D008E008F00900091-
   883 0000055B 009200930094009500-
   883 00000564 96009700980099009A-
   883 0000056D 009B009C009D009E00-
   883 00000576 9F00A000A100A200A3-
   883 0000057F 00                 
   884 00000580 A400A500A600A700A8-     	dw	164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,
   884 00000589 00A900AA00AB00AC00-
   884 00000592 AD00AE00AF00B000B1-
   884 0000059B 00B200B300B400B500-
   884 000005A4 B600B700B800B900BA-
   884 000005AD 00BB00BC00BD00BE00-
   884 000005B6 BF00C000C100C200C3-
   884 000005BF 00                 
   885 000005C0 C400C500C600C700C8-     	dw	196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,
   885 000005C9 00C900CA00CB00CC00-
   885 000005D2 CD00CE00CF00D000D1-
   885 000005DB 00D200D300D400D500-
   885 000005E4 D600D700D800D900DA-
   885 000005ED 00DB00DC00DD00DE00-
   885 000005F6 DF00E000E100E200E3-
   885 000005FF 00                 
   886 00000600 E400E500E600E700E8-     	dw	228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,
   886 00000609 00E900EA00EB00EC00-
   886 00000612 ED00EE00EF00F000F1-
   886 0000061B 00F200F300F400F500-
   886 00000624 F600F700F800F900FA-
   886 0000062D 00FB00FC00FD00FE00-
   886 00000636 FF0000010101020103-
   886 0000063F 01                 
   887 00000640 040105010601070108-     	dw	260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,
   887 00000649 0109010A010B010C01-
   887 00000652 0D010E010F01100111-
   887 0000065B 011201130114011501-
   887 00000664 16011701180119011A-
   887 0000066D 011B011C011D011E01-
   887 00000676 1F0120012101220123-
   887 0000067F 01                 
   888 00000680 240125012601270128-     	dw	292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,
   888 00000689 0129012A012B012C01-
   888 00000692 2D012E012F01300131-
   888 0000069B 013201330134013501-
   888 000006A4 36013701380139013A-
   888 000006AD 013B013C013D013E01-
   888 000006B6 3F0140014101420143-
   888 000006BF 01                 
   889 000006C0 440145014601470148-     	dw	324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,
   889 000006C9 0149014A014B014C01-
   889 000006D2 4D014E014F01500151-
   889 000006DB 015201530154015501-
   889 000006E4 56015701580159015A-
   889 000006ED 015B015C015D015E01-
   889 000006F6 5F0160016101620163-
   889 000006FF 01                 
   890 00000700 64FF65FF66FF67FF68-     	dw	-156,-155,-154,-153,-152,-151,-150,-149,-148,-147,-146,-145,-144,-143,-142,-141,-140,-139,-138,-137,-136,-135,-134,-133,-132,-131,-130,-129,-128,-127,-126,-125,
   890 00000709 FF69FF6AFF6BFF6CFF-
   890 00000712 6DFF6EFF6FFF70FF71-
   890 0000071B FF72FF73FF74FF75FF-
   890 00000724 76FF77FF78FF79FF7A-
   890 0000072D FF7BFF7CFF7DFF7EFF-
   890 00000736 7FFF80FF81FF82FF83-
   890 0000073F FF                 
   891 00000740 84FF85FF86FF87FF88-     	dw	-124,-123,-122,-121,-120,-119,-118,-117,-116,-115,-114,-113,-112,-111,-110,-109,-108,-107,-106,-105,-104,-103,-102,-101,-100,-99,-98,-97,-96,-95,-94,-93,
   891 00000749 FF89FF8AFF8BFF8CFF-
   891 00000752 8DFF8EFF8FFF90FF91-
   891 0000075B FF92FF93FF94FF95FF-
   891 00000764 96FF97FF98FF99FF9A-
   891 0000076D FF9BFF9CFF9DFF9EFF-
   891 00000776 9FFFA0FFA1FFA2FFA3-
   891 0000077F FF                 
   892 00000780 A4FFA5FFA6FFA7FFA8-     	dw	-92,-91,-90,-89,-88,-87,-86,-85,-84,-83,-82,-81,-80,-79,-78,-77,-76,-75,-74,-73,-72,-71,-70,-69,-68,-67,-66,-65,-64,-63,-62,-61,
   892 00000789 FFA9FFAAFFABFFACFF-
   892 00000792 ADFFAEFFAFFFB0FFB1-
   892 0000079B FFB2FFB3FFB4FFB5FF-
   892 000007A4 B6FFB7FFB8FFB9FFBA-
   892 000007AD FFBBFFBCFFBDFFBEFF-
   892 000007B6 BFFFC0FFC1FFC2FFC3-
   892 000007BF FF                 
   893 000007C0 C4FFC5FFC6FFC7FFC8-     	dw	-60,-59,-58,-57,-56,-55,-54,-53,-52,-51,-50,-49,-48,-47,-46,-45,-44,-43,-42,-41,-40,-39,-38,-37,-36,-35,-34,-33,-32,-31,-30,-29,
   893 000007C9 FFC9FFCAFFCBFFCCFF-
   893 000007D2 CDFFCEFFCFFFD0FFD1-
   893 000007DB FFD2FFD3FFD4FFD5FF-
   893 000007E4 D6FFD7FFD8FFD9FFDA-
   893 000007ED FFDBFFDCFFDDFFDEFF-
   893 000007F6 DFFFE0FFE1FFE2FFE3-
   893 000007FF FF                 
   894 00000800 E4FFE5FFE6FFE7FFE8-     	dw	-28,-27,-26,-25,-24,-23,-22,-21,-20,-19,-18,-17,-16,-15,-14,-13,-12,-11,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,
   894 00000809 FFE9FFEAFFEBFFECFF-
   894 00000812 EDFFEEFFEFFFF0FFF1-
   894 0000081B FFF2FFF3FFF4FFF5FF-
   894 00000824 F6FFF7FFF8FFF9FFFA-
   894 0000082D FFFBFFFCFFFDFFFEFF-
   894 00000836 FFFF00000100020003-
   894 0000083F 00                 
   895 00000840 040005000600070008-     	dw	4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,
   895 00000849 0009000A000B000C00-
   895 00000852 0D000E000F00100011-
   895 0000085B 001200130014001500-
   895 00000864 16001700180019001A-
   895 0000086D 001B001C001D001E00-
   895 00000876 1F0020002100220023-
   895 0000087F 00                 
   896 00000880 240025002600270028-     	dw	36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,
   896 00000889 0029002A002B002C00-
   896 00000892 2D002E002F00300031-
   896 0000089B 003200330034003500-
   896 000008A4 36003700380039003A-
   896 000008AD 003B003C003D003E00-
   896 000008B6 3F0040004100420043-
   896 000008BF 00                 
   897 000008C0 440045004600470048-     	dw	68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,
   897 000008C9 0049004A004B004C00-
   897 000008D2 4D004E004F00500051-
   897 000008DB 005200530054005500-
   897 000008E4 56005700580059005A-
   897 000008ED 005B005C005D005E00-
   897 000008F6 5F0060006100620063-
   897 000008FF 00                 
   898                                  
   899                                  FillBlockTab:
   900 00000900 0000280050007800A0-     	dw	0*40,1*40,2*40,3*40,4*40,5*40,6*40,7*40,8*40,9*40,
   900 00000909 00C800F00018014001-
   900 00000912 6801               
   901 00000914 9001B801E001080230-     	dw	10*40,11*40,12*40,13*40,14*40,15*40,16*40,17*40,18*40,19*40,
   901 0000091D 0258028002A802D002-
   901 00000926 F802               
   902 00000928 2003480370039803C0-     	dw	20*40,21*40,22*40,23*40,24*40,25*40,26*40,27*40,28*40,29*40,
   902 00000931 03E803100438046004-
   902 0000093A 8804               
   903 0000093C B004D8040005280550-     	dw	30*40,31*40,32*40,33*40,34*40,35*40,36*40,37*40,38*40,39*40,
   903 00000945 057805A005C805F005-
   903 0000094E 1806               
   904 00000950 400668069006B806E0-     	dw	40*40,41*40,42*40,43*40,44*40,45*40,46*40,47*40,48*40,49*40,
   904 00000959 060807300758078007-
   904 00000962 A807               
   905 00000964 D007F8072008480870-     	dw	50*40,51*40,52*40,53*40,54*40,55*40,56*40,57*40,58*40,59*40,
   905 0000096D 089808C008E8081009-
   905 00000976 3809               
   906 00000978 60098809B009D80900-     	dw	60*40,61*40,62*40,63*40,64*40,65*40,66*40,67*40,68*40,69*40,
   906 00000981 0A280A500A780AA00A-
   906 0000098A C80A               
   907 0000098C F00A180B400B680B90-     	dw	70*40,71*40,72*40,73*40,74*40,75*40,76*40,77*40,78*40,79*40,
   907 00000995 0BB80BE00B080C300C-
   907 0000099E 580C               
   908 000009A0 800CA80CD00CF80C20-     	dw	80*40,81*40,82*40,83*40,84*40,85*40,86*40,87*40,88*40,89*40,
   908 000009A9 0D480D700D980DC00D-
   908 000009B2 E80D               
   909 000009B4 100E380E600E880EB0-     	dw	90*40,91*40,92*40,93*40,94*40,95*40,96*40,97*40,98*40,99*40,
   909 000009BD 0ED80E000F280F500F-
   909 000009C6 780F               
   910                                  
   911 000009C8 FC30FCFCCCFCFCFCFC-     Hex0	db 11111100b,00110000b,11111100b,11111100b,11001100b,11111100b,11111100b,11111100b,11111100b,11111100b,11111100b,11111100b,11111100b,11110000b,11111100b,11111100b
   911 000009D1 FCFCFCFCF0FCFC     
   912 000009D8 CCF00C0CCCC0C00CCC-     Hex1	db 11001100b,11110000b,00001100b,00001100b,11001100b,11000000b,11000000b,00001100b,11001100b,11001100b,11001100b,11001100b,11000000b,11001100b,11000000b,11000000b
   912 000009E1 CCCCCCC0CCC0C0     
   913 000009E8 CC30FCFCFCFCFC0CFC-     Hex2	db 11001100b,00110000b,11111100b,11111100b,11111100b,11111100b,11111100b,00001100b,11111100b,11111100b,11111100b,11110000b,11000000b,11001100b,11111100b,11111100b
   913 000009F1 FCFCF0C0CCFCFC     
   914 000009F8 CC30C00C0C0CCC0CCC-     Hex3	db 11001100b,00110000b,11000000b,00001100b,00001100b,00001100b,11001100b,00001100b,11001100b,00001100b,11001100b,11001100b,11000000b,11001100b,11000000b,11000000b
   914 00000A01 0CCCCCC0CCC0C0     
   915 00000A08 FCFCFCFC0CFCFC0CFC-     Hex4	db 11111100b,11111100b,11111100b,11111100b,00001100b,11111100b,11111100b,00001100b,11111100b,11111100b,11001100b,11111100b,11111100b,11110000b,11111100b,11000000b
   915 00000A11 FCCCFCFCF0FCC0     
   916                                  	
   917                                  %include  'sin256.inc'
     1                              <1> sintab:
     2 00000A18 000001020303040506- <1>  db     0,    0,    1,    2,    3,    3,    4,    5,    6,    7,    7,    8,    9,   10,   10,   11 ; 16
     2 00000A21 070708090A0A0B      <1>
     3 00000A28 0C0D0E0E0F10111112- <1>  db    12,   13,   14,   14,   15,   16,   17,   17,   18,   19,   20,   21,   21,   22,   23,   24 ; 32
     3 00000A31 13141515161718      <1>
     4 00000A38 18191A1B1B1C1D1E1E- <1>  db    24,   25,   26,   27,   27,   28,   29,   30,   30,   31,   32,   33,   34,   34,   35,   36 ; 48
     4 00000A41 1F202122222324      <1>
     5 00000A48 252526272828292A2A- <1>  db    37,   37,   38,   39,   40,   40,   41,   42,   42,   43,   44,   45,   45,   46,   47,   48 ; 64
     5 00000A51 2B2C2D2D2E2F30      <1>
     6 00000A58 303132323334353536- <1>  db    48,   49,   50,   50,   51,   52,   53,   53,   54,   55,   55,   56,   57,   58,   58,   59 ; 80
     6 00000A61 373738393A3A3B      <1>
     7 00000A68 3C3C3D3E3E3F404041- <1>  db    60,   60,   61,   62,   62,   63,   64,   64,   65,   66,   66,   67,   68,   68,   69,   70 ; 96
     7 00000A71 42424344444546      <1>
     8 00000A78 46474848494A4A4B4B- <1>  db    70,   71,   72,   72,   73,   74,   74,   75,   75,   76,   77,   77,   78,   79,   79,   80 ; 112
     8 00000A81 4C4D4D4E4F4F50      <1>
     9 00000A88 505152525353545555- <1>  db    80,   81,   82,   82,   83,   83,   84,   85,   85,   86,   86,   87,   87,   88,   89,   89 ; 128
     9 00000A91 56565757585959      <1>
    10 00000A98 5A5A5B5B5C5C5D5D5E- <1>  db    90,   90,   91,   91,   92,   92,   93,   93,   94,   95,   95,   96,   96,   97,   97,   98 ; 144
    10 00000AA1 5F5F6060616162      <1>
    11 00000AA8 626363646465656566- <1>  db    98,   99,   99,  100,  100,  101,  101,  101,  102,  102,  103,  103,  104,  104,  105,  105 ; 160
    11 00000AB1 66676768686969      <1>
    12 00000AB8 6A6A6A6B6B6C6C6C6D- <1>  db   106,  106,  106,  107,  107,  108,  108,  108,  109,  109,  110,  110,  110,  111,  111,  112 ; 176
    12 00000AC1 6D6E6E6E6F6F70      <1>
    13 00000AC8 707071717172727273- <1>  db   112,  112,  113,  113,  113,  114,  114,  114,  115,  115,  115,  116,  116,  116,  117,  117 ; 192
    13 00000AD1 73737474747575      <1>
    14 00000AD8 757676767677777778- <1>  db   117,  118,  118,  118,  118,  119,  119,  119,  120,  120,  120,  120,  121,  121,  121,  121 ; 208
    14 00000AE1 78787879797979      <1>
    15 00000AE8 7A7A7A7A7A7B7B7B7B- <1>  db   122,  122,  122,  122,  122,  123,  123,  123,  123,  123,  124,  124,  124,  124,  124,  124 ; 224
    15 00000AF1 7B7C7C7C7C7C7C      <1>
    16 00000AF8 7D7D7D7D7D7D7D7E7E- <1>  db   125,  125,  125,  125,  125,  125,  125,  126,  126,  126,  126,  126,  126,  126,  126,  126 ; 240
    16 00000B01 7E7E7E7E7E7E7E      <1>
    17 00000B08 7E7E7F7F7F7F7F7F7F- <1>  db   126,  126,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127 ; 256
    17 00000B11 7F7F7F7F7F7F7F      <1>
    18                              <1> 
    19 00000B18 7F7F7F7F7F7F7F7F7F- <1>  db   127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  126,  126 ; 272
    19 00000B21 7F7F7F7F7F7E7E      <1>
    20 00000B28 7E7E7E7E7E7E7E7E7E- <1>  db   126,  126,  126,  126,  126,  126,  126,  126,  126,  125,  125,  125,  125,  125,  125,  125 ; 288
    20 00000B31 7D7D7D7D7D7D7D      <1>
    21 00000B38 7C7C7C7C7C7C7B7B7B- <1>  db   124,  124,  124,  124,  124,  124,  123,  123,  123,  123,  123,  122,  122,  122,  122,  122 ; 304
    21 00000B41 7B7B7A7A7A7A7A      <1>
    22 00000B48 797979797878787877- <1>  db   121,  121,  121,  121,  120,  120,  120,  120,  119,  119,  119,  118,  118,  118,  118,  117 ; 320
    22 00000B51 77777676767675      <1>
    23 00000B58 757574747473737372- <1>  db   117,  117,  116,  116,  116,  115,  115,  115,  114,  114,  114,  113,  113,  113,  112,  112 ; 336
    23 00000B61 72727171717070      <1>
    24 00000B68 706F6F6E6E6E6D6D6C- <1>  db   112,  111,  111,  110,  110,  110,  109,  109,  108,  108,  108,  107,  107,  106,  106,  106 ; 352
    24 00000B71 6C6C6B6B6A6A6A      <1>
    25 00000B78 696968686767666665- <1>  db   105,  105,  104,  104,  103,  103,  102,  102,  101,  101,  101,  100,  100,   99,   99,   98 ; 368
    25 00000B81 65656464636362      <1>
    26 00000B88 62616160605F5F5E5D- <1>  db    98,   97,   97,   96,   96,   95,   95,   94,   93,   93,   92,   92,   91,   91,   90,   90 ; 384
    26 00000B91 5D5C5C5B5B5A5A      <1>
    27 00000B98 595958575756565555- <1>  db    89,   89,   88,   87,   87,   86,   86,   85,   85,   84,   83,   83,   82,   82,   81,   80 ; 400
    27 00000BA1 54535352525150      <1>
    28 00000BA8 504F4F4E4D4D4C4B4B- <1>  db    80,   79,   79,   78,   77,   77,   76,   75,   75,   74,   74,   73,   72,   72,   71,   70 ; 416
    28 00000BB1 4A4A4948484746      <1>
    29 00000BB8 464544444342424140- <1>  db    70,   69,   68,   68,   67,   66,   66,   65,   64,   64,   63,   62,   62,   61,   60,   60 ; 432
    29 00000BC1 403F3E3E3D3C3C      <1>
    30 00000BC8 3B3A3A393837373635- <1>  db    59,   58,   58,   57,   56,   55,   55,   54,   53,   53,   52,   51,   50,   50,   49,   48 ; 448
    30 00000BD1 35343332323130      <1>
    31 00000BD8 302F2E2D2D2C2B2A2A- <1>  db    48,   47,   46,   45,   45,   44,   43,   42,   42,   41,   40,   40,   39,   38,   37,   37 ; 464
    31 00000BE1 29282827262525      <1>
    32 00000BE8 2423222221201F1E1E- <1>  db    36,   35,   34,   34,   33,   32,   31,   30,   30,   29,   28,   27,   27,   26,   25,   24 ; 480
    32 00000BF1 1D1C1B1B1A1918      <1>
    33 00000BF8 181716151514131211- <1>  db    24,   23,   22,   21,   21,   20,   19,   18,   17,   17,   16,   15,   14,   14,   13,   12 ; 496
    33 00000C01 11100F0E0E0D0C      <1>
    34 00000C08 0B0A0A090807070605- <1>  db    11,   10,   10,    9,    8,    7,    7,    6,    5,    4,    3,    3,    2,    1,    0,    0 ; 512
    34 00000C11 04030302010000      <1>
    35                              <1>  
    36 00000C18 0000FFFEFDFDFCFBFA- <1>  db     0,    0,   -1,   -2,   -3,   -3,   -4,   -5,   -6,   -7,   -7,   -8,   -9,  -10,  -10,  -11 ; 528
    36 00000C21 F9F9F8F7F6F6F5      <1>
    37 00000C28 F4F3F2F2F1F0EFEFEE- <1>  db   -12,  -13,  -14,  -14,  -15,  -16,  -17,  -17,  -18,  -19,  -20,  -21,  -21,  -22,  -23,  -24 ; 544
    37 00000C31 EDECEBEBEAE9E8      <1>
    38 00000C38 E8E7E6E5E5E4E3E2E2- <1>  db   -24,  -25,  -26,  -27,  -27,  -28,  -29,  -30,  -30,  -31,  -32,  -33,  -34,  -34,  -35,  -36 ; 560
    38 00000C41 E1E0DFDEDEDDDC      <1>
    39 00000C48 DBDBDAD9D8D8D7D6D6- <1>  db   -37,  -37,  -38,  -39,  -40,  -40,  -41,  -42,  -42,  -43,  -44,  -45,  -45,  -46,  -47,  -48 ; 576
    39 00000C51 D5D4D3D3D2D1D0      <1>
    40 00000C58 D0CFCECECDCCCBCBCA- <1>  db   -48,  -49,  -50,  -50,  -51,  -52,  -53,  -53,  -54,  -55,  -55,  -56,  -57,  -58,  -58,  -59 ; 592
    40 00000C61 C9C9C8C7C6C6C5      <1>
    41 00000C68 C4C4C3C2C2C1C0C0BF- <1>  db   -60,  -60,  -61,  -62,  -62,  -63,  -64,  -64,  -65,  -66,  -66,  -67,  -68,  -68,  -69,  -70 ; 608
    41 00000C71 BEBEBDBCBCBBBA      <1>
    42 00000C78 BAB9B8B8B7B6B6B5B5- <1>  db   -70,  -71,  -72,  -72,  -73,  -74,  -74,  -75,  -75,  -76,  -77,  -77,  -78,  -79,  -79,  -80 ; 624
    42 00000C81 B4B3B3B2B1B1B0      <1>
    43 00000C88 B0AFAEAEADADACABAB- <1>  db   -80,  -81,  -82,  -82,  -83,  -83,  -84,  -85,  -85,  -86,  -86,  -87,  -87,  -88,  -89,  -89 ; 640
    43 00000C91 AAAAA9A9A8A7A7      <1>
    44 00000C98 A6A6A5A5A4A4A3A3A2- <1>  db   -90,  -90,  -91,  -91,  -92,  -92,  -93,  -93,  -94,  -95,  -95,  -96,  -96,  -97,  -97,  -98 ; 656
    44 00000CA1 A1A1A0A09F9F9E      <1>
    45 00000CA8 9E9D9D9C9C9B9B9B9A- <1>  db   -98,  -99,  -99, -100, -100, -101, -101, -101, -102, -102, -103, -103, -104, -104, -105, -105 ; 672
    45 00000CB1 9A999998989797      <1>
    46 00000CB8 969696959594949493- <1>  db  -106, -106, -106, -107, -107, -108, -108, -108, -109, -109, -110, -110, -110, -111, -111, -112 ; 688
    46 00000CC1 93929292919190      <1>
    47 00000CC8 90908F8F8F8E8E8E8D- <1>  db  -112, -112, -113, -113, -113, -114, -114, -114, -115, -115, -115, -116, -116, -116, -117, -117 ; 704
    47 00000CD1 8D8D8C8C8C8B8B      <1>
    48 00000CD8 8B8A8A8A8A89898988- <1>  db  -117, -118, -118, -118, -118, -119, -119, -119, -120, -120, -120, -120, -121, -121, -121, -121 ; 720
    48 00000CE1 88888887878787      <1>
    49 00000CE8 868686868685858585- <1>  db  -122, -122, -122, -122, -122, -123, -123, -123, -123, -123, -124, -124, -124, -124, -124, -124 ; 736
    49 00000CF1 85848484848484      <1>
    50 00000CF8 838383838383838282- <1>  db  -125, -125, -125, -125, -125, -125, -125, -126, -126, -126, -126, -126, -126, -126, -126, -126 ; 752
    50 00000D01 82828282828282      <1>
    51 00000D08 828281818181818181- <1>  db  -126, -126, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127 ; 768
    51 00000D11 81818181818181      <1>
    52                              <1>  
    53 00000D18 818181818181818181- <1>  db  -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -126, -126 ; 784
    53 00000D21 81818181818282      <1>
    54 00000D28 828282828282828282- <1>  db  -126, -126, -126, -126, -126, -126, -126, -126, -126, -125, -125, -125, -125, -125, -125, -125 ; 800
    54 00000D31 83838383838383      <1>
    55 00000D38 848484848484858585- <1>  db  -124, -124, -124, -124, -124, -124, -123, -123, -123, -123, -123, -122, -122, -122, -122, -122 ; 816
    55 00000D41 85858686868686      <1>
    56 00000D48 878787878888888889- <1>  db  -121, -121, -121, -121, -120, -120, -120, -120, -119, -119, -119, -118, -118, -118, -118, -117 ; 832
    56 00000D51 89898A8A8A8A8B      <1>
    57 00000D58 8B8B8C8C8C8D8D8D8E- <1>  db  -117, -117, -116, -116, -116, -115, -115, -115, -114, -114, -114, -113, -113, -113, -112, -112 ; 848
    57 00000D61 8E8E8F8F8F9090      <1>
    58 00000D68 909191929292939394- <1>  db  -112, -111, -111, -110, -110, -110, -109, -109, -108, -108, -108, -107, -107, -106, -106, -106 ; 864
    58 00000D71 94949595969696      <1>
    59 00000D78 9797989899999A9A9B- <1>  db  -105, -105, -104, -104, -103, -103, -102, -102, -101, -101, -101, -100, -100,  -99,  -99,  -98 ; 880
    59 00000D81 9B9B9C9C9D9D9E      <1>
    60 00000D88 9E9F9FA0A0A1A1A2A3- <1>  db   -98,  -97,  -97,  -96,  -96,  -95,  -95,  -94,  -93,  -93,  -92,  -92,  -91,  -91,  -90,  -90 ; 896
    60 00000D91 A3A4A4A5A5A6A6      <1>
    61 00000D98 A7A7A8A9A9AAAAABAB- <1>  db   -89,  -89,  -88,  -87,  -87,  -86,  -86,  -85,  -85,  -84,  -83,  -83,  -82,  -82,  -81,  -80 ; 912
    61 00000DA1 ACADADAEAEAFB0      <1>
    62 00000DA8 B0B1B1B2B3B3B4B5B5- <1>  db   -80,  -79,  -79,  -78,  -77,  -77,  -76,  -75,  -75,  -74,  -74,  -73,  -72,  -72,  -71,  -70 ; 928
    62 00000DB1 B6B6B7B8B8B9BA      <1>
    63 00000DB8 BABBBCBCBDBEBEBFC0- <1>  db   -70,  -69,  -68,  -68,  -67,  -66,  -66,  -65,  -64,  -64,  -63,  -62,  -62,  -61,  -60,  -60 ; 944
    63 00000DC1 C0C1C2C2C3C4C4      <1>
    64 00000DC8 C5C6C6C7C8C9C9CACB- <1>  db   -59,  -58,  -58,  -57,  -56,  -55,  -55,  -54,  -53,  -53,  -52,  -51,  -50,  -50,  -49,  -48 ; 960
    64 00000DD1 CBCCCDCECECFD0      <1>
    65 00000DD8 D0D1D2D3D3D4D5D6D6- <1>  db   -48,  -47,  -46,  -45,  -45,  -44,  -43,  -42,  -42,  -41,  -40,  -40,  -39,  -38,  -37,  -37 ; 976
    65 00000DE1 D7D8D8D9DADBDB      <1>
    66 00000DE8 DCDDDEDEDFE0E1E2E2- <1>  db   -36,  -35,  -34,  -34,  -33,  -32,  -31,  -30,  -30,  -29,  -28,  -27,  -27,  -26,  -25,  -24 ; 992
    66 00000DF1 E3E4E5E5E6E7E8      <1>
    67 00000DF8 E8E9EAEBEBECEDEEEF- <1>  db   -24,  -23,  -22,  -21,  -21,  -20,  -19,  -18,  -17,  -17,  -16,  -15,  -14,  -14,  -13,  -12 ; 1008
    67 00000E01 EFF0F1F2F2F3F4      <1>
    68 00000E08 F5F6F6F7F8F9F9FAFB- <1>  db   -11,  -10,  -10,   -9,   -8,   -7,   -7,   -6,   -5,   -4,   -3,   -3,   -2,   -1,    0,    0 ; 1024
    68 00000E11 FCFDFDFEFF0000      <1>
   918                                  
   919                                  section .bss 	; put uninitialized data here
   920 00000000 <res 194h>              BackBufferTable: 	resw 202 	; 200 screen lines as words
   921 00000194 <res 8000h>             BackBuffer: 		resw 16384	; 2 screen buffers
   922                                  
   923 00008194 ????                    XAngle:	resw	1
   924 00008196 ????                    YAngle:	resw	1
   925                                  
   926 00008198 ????                    SinX:	resw	1
   927 0000819A ????                    CosX:	resw	1
   928 0000819C ????                    SinY:	resw	1
   929 0000819E ????                    CosY:	resw	1
   930                                  
   931 000081A0 ????                    HorEdge	resw	1
   932                                  
   933 000081A2 ????                    XST		resw	1
   934 000081A4 ????                    YST		resw	1
   935 000081A6 ????                    XEN		resw	1
   936 000081A8 ????                    YEN		resw	1
   937                                  
   938                                  ;Test0: 	resw	1
   939                                  ;Test1: 	resw	1
   940                                  ;Test2: 	resw	1
   941                                  ;Test3: 	resw	1
   942                                  ;Test4: 	resw	1
   943                                  ;Test5: 	resw	1
   944                                  ;Test6: 	resw	1
   945                                  ;Test7: 	resw	1
   946                                  ;Test8: 	resw	1
   947 000081AA ????                    Test9: 	resw	1
   948 000081AC ????                    Test10: resw	1
   949                                  
   950                                  ;Test11: resw	1
   951                                  
   952 000081AE ????                    HDiff:	resw	1
   953 000081B0 ????                    VDiff:	resw	1
   954 000081B2 ????                    Slope: 	resw	1
   955                                  
   956 000081B4 ????                    HorDir:	resw	1
   957                                  
   958 000081B6 ????                    BackBufferSeg	resw	1	; pointer to the segment containing the back buffer
   959                                  
   960 000081B8 ??                      Exit:	resb	1
   961                                  
   962                                  

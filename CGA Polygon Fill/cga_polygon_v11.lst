     1                                  ; nasm cga_line_v7.asm -o cgaline.com -f bin
     2                                  
     3                                  
     4                                  ; list of next line tables - even values = +8192 odd values = -8192 - put into 2 registers - swap registers after each next line
     5                                  
     6                                  VIDEO_SEGMENT	equ	0b800h 	; display memory segment for true CGA graphics modes
     7                                  SW				equ 80 		; screen width
     8                                  SE				equ	0		; screen even start
     9                                  SO				equ	8192	; screen odd start
    10                                  
    11                                  
    12                                  INPUT_STATUS_1	equ	03dah	; VGA status register
    13                                  VSYNC_MASK	equ	08h	; vertical sync bit in status register 1
    14                                  DE_MASK		equ	01h	; display enable bit in status register 1
    15                                  
    16                                  MAP_MASK	equ	2		; SC map mask register
    17                                  SC_INDEX		equ	3c4h	; SC index register
    18                                   
    19                                  TOP_CC		equ	1
    20                                  BOTTOM_CC	equ	2
    21                                  LEFT_CC		equ	4
    22                                  RIGHT_CC	equ	8
    23                                  BEHIND_CC	equ	16
    24                                  BACK_CC		equ 16
    25                                  FRONT_CC 	equ 32
    26                                  
    27                                  MIDDLE_X		equ	160
    28                                  MIDDLE_Y		equ	100
    29                                  TOP_EDGE	equ	MIDDLE_Y-100
    30                                  BOTTOM_EDGE	equ	MIDDLE_Y+99
    31                                  LEFT_EDGE	equ	MIDDLE_X-160
    32                                  RIGHT_EDGE	equ	MIDDLE_X+159
    33                                  
    34                                  KEY_1	EQU	0231h
    35                                  KEY_2	EQU	0332h
    36                                  KEY_3	EQU	0433h
    37                                  KEY_4 	EQU	0534h
    38                                  KEY_5 	EQU	0635h
    39                                  KEY_6 	EQU	0736h
    40                                  KEY_ESC	EQU 27
    41                                  
    42                                  CPU 386
    43                                  bits 16
    44                                  org 100h
    45                                  
    46                                  ; get screen								(ecx) = es:di							mov	ecx,[es:di]
    47                                  ; and with gap (left/right)					(ecx) = screen that is still needed		and ecx,[leftgaptab+bx]
    48                                  ; get colour								(esi) = eax								mov	esi,eax
    49                                  ; and with not_gap (left/right)				(esi) = colour that is still needed		and esi,[leftnongaptab+bx]
    50                                  ; or gap and not_gap						(ecx) = final result					or	ecx,esi
    51                                  ; put on screen								(ecx) = es:di							mov [es:di],ecx
    52                                  
    53                                  %macro left_edge 0 
    54                                  	shl		bx,2			; start hor *4
    55                                  	mov		ecx,[es:di]					; get screen								(ecx) = es:di							mov	ecx,[es:di]
    56                                  	and		ecx,[FillLeftTab32V2+bx]	; and with gap (left/right)					(ecx) = screen that is still needed		and ecx,[leftgaptab+bx]
    57                                  	mov		esi,eax						; get colour								(esi) = eax								mov	esi,eax
    58                                  	and		esi,[FillLeftTab32+bx]		; and with not_gap (left/right)				(esi) = colour that is still needed		and esi,[leftnongaptab+bx]
    59                                  	or		ecx,esi						; or gap and not_gap						(ecx) = final result					or	ecx,esi
    60                                  	mov		[es:di],ecx					; put on screen								(ecx) = es:di							mov [es:di],ecx
    61                                  %endmacro
    62                                  
    63                                  %macro right_edge 0 
    64                                  	shl		bp,2			; start hor *4
    65                                  	mov		ecx,[es:di]					; get screen								(ecx) = es:di							mov	ecx,[es:di]
    66                                  	and		ecx,[FillRightTab32V2+bp]	; and with gap (left/right)					(ecx) = screen that is still needed		and ecx,[leftgaptab+bx]
    67                                  	mov		esi,eax						; get colour								(esi) = eax								mov	esi,eax
    68                                  	and		esi,[FillRightTab32+bp]		; and with not_gap (left/right)				(esi) = colour that is still needed		and esi,[leftnongaptab+bx]
    69                                  	or		ecx,esi						; or gap and not_gap						(ecx) = final result					or	ecx,esi
    70                                  	mov		[es:di],ecx					; put on screen								(ecx) = es:di							mov [es:di],ecx
    71                                  %endmacro
    72                                  
    73                                  %macro fill_cont	0
    74                                  	pop		di
    75                                  	pop 	bp
    76                                  	
    77                                  	ror 	eax,2
    78                                  	
    79                                  	add		bp,8
    80                                  	add 	di,2
    81                                  	dec		dl
    82                                  	jnz		Fill.plotloop
    83                                  %endmacro
    84                                  
    85                                  section .text
    86                                  
    87                                  start:
    88 00000000 E88802                  	call	BuildScreenTable
    89 00000003 B80400                  	mov	ax,04h 	; CGA 320 x 200 4 colors
    90 00000006 CD10                    	int		10h
    91                                  
    92                                  ;	mov	ax,0Bh 	; Pallette
    93                                  ;	mov	bh,1
    94                                  ;	mov	bl,0
    95                                  ;	mov	bx,00000h ; pallette 0 high
    96                                  ;	int	10h 
    97                                  	
    98 00000008 B44A                    	mov	ah, 4ah
    99 0000000A BB0010                  	mov	bx, 1000h
   100 0000000D CD21                    	int	21h
   101 0000000F B448                    	mov	ah, 48h
   102 00000011 BB0010                  	mov	bx, 1000h
   103 00000014 CD21                    	int	21h
   104 00000016 A3[5194]                	mov	[BackBufferSeg], ax
   105                                  
   106 00000019 31C0                    	xor ax,ax
   107 0000001B A2[3094]                	mov	[Exit],al
   108 0000001E A3[2A94]                	mov	[XAngle],ax
   109 00000021 A3[2C94]                	mov	[YAngle],ax		
   110 00000024 A3[2E94]                	mov	[ZAngle],ax
   111                                  	
   112                                  ;	mov	[Test0],ax
   113                                  	
   114                                  MainLoop:
   115 00000027 E8D004                  		call	WaitVSync ; Wait for vertical sync so the new start address has a chance to take effect.
   116 0000002A E8DB04                  		call	CopyClearBackBuffer ; copy back to front
   117                                  	
   118 0000002D 8B1E[5194]              		mov		bx,[BackBufferSeg]
   119 00000031 8EC3                    		mov		es,bx
   120                                  
   121 00000033 B300                    		mov		bl,0
   122 00000035 A1[A826]                		mov		ax,[XOffset]
   123                                  ;		call	Hex16
   124 00000038 B301                    		mov		bl,1
   125 0000003A A1[AA26]                		mov		ax,[YOffset]
   126                                  ;		call	Hex16
   127 0000003D B302                    		mov		bl,2
   128 0000003F A1[AC26]                		mov		ax,[ZOffset]
   129                                  ;		call	Hex16
   130                                  
   131 00000042 B304                    		mov		bl,4
   132 00000044 A1[2A94]                		mov		ax,[XAngle]
   133                                  ;		call	Hex16
   134 00000047 B305                    		mov		bl,5
   135 00000049 A1[2C94]                		mov		ax,[YAngle]
   136                                  ;		call	Hex16
   137 0000004C B306                    		mov		bl,6
   138 0000004E A1[2E94]                		mov		ax,[ZAngle]
   139                                  ;		call	Hex16
   140                                  
   141 00000051 B308                    	mov		bl,8
   142 00000053 A1[AE28]                	mov		ax,[testx]
   143 00000056 E81A13                  	call	Hex16
   144 00000059 B309                    	mov		bl,9
   145 0000005B A1[B028]                	mov		ax,[testy]
   146 0000005E E81213                  	call	Hex16
   147 00000061 B30A                    	mov		bl,10
   148 00000063 A1[B228]                	mov		ax,[testz]
   149 00000066 E80A13                  	call	Hex16
   150                                  
   151 00000069 8B1E[B228]              	mov		bx,[testz]
   152 0000006D 8B16[AE28]              	mov		dx,[testx]
   153 00000071 8B0E[B028]              	mov		cx,[testy]
   154 00000075 E85C15                  	call	PerspectiveZW
   155                                  
   156 00000078 30FF                    	xor		bh,bh
   157 0000007A 53                      	push	bx
   158 0000007B B30C                    	mov		bl,12
   159                                  ;	call	Hex16
   160                                  	
   161 0000007D 58                      	pop		ax
   162 0000007E B30D                    	mov		bl,13
   163                                  ;	call	Hex8
   164                                  
   165 00000080 8B1E[B228]              	mov		bx,[testz]
   166 00000084 8B16[AE28]              	mov		dx,[testx]
   167 00000088 8B0E[B028]              	mov		cx,[testy]
   168 0000008C E84515                  	call	PerspectiveZW
   169 0000008F 89CD                    	mov		bp,cx
   170 00000091 E82605                  	call	Plot11
   171                                  
   172 00000094 BBFE01                  	mov		bx,510
   173 00000097 BAFE01                  	mov		dx,510
   174 0000009A B90100                  	mov		cx,1
   175 0000009D E83415                  	call	PerspectiveZW
   176 000000A0 89CD                    	mov		bp,cx
   177 000000A2 E81505                  	call	Plot11
   178                                  
   179 000000A5 BBFE01                  	mov		bx,510
   180 000000A8 BA0100                  	mov		dx,1
   181 000000AB B90100                  	mov		cx,1
   182 000000AE E82315                  	call	PerspectiveZW
   183 000000B1 89CD                    	mov		bp,cx
   184 000000B3 E80405                  	call	Plot11
   185                                  
   186 000000B6 BBFE01                  	mov		bx,510
   187 000000B9 BAFE01                  	mov		dx,510
   188 000000BC B9FE01                  	mov		cx,510
   189 000000BF E81215                  	call	PerspectiveZW
   190 000000C2 89CD                    	mov		bp,cx
   191 000000C4 E8F304                  	call	Plot11
   192                                  
   193 000000C7 BBFE01                  	mov		bx,510
   194 000000CA BA0100                  	mov		dx,1
   195 000000CD B9FE01                  	mov		cx,510
   196 000000D0 E80115                  	call	PerspectiveZW
   197 000000D3 89CD                    	mov		bp,cx
   198 000000D5 E8E204                  	call	Plot11
   199                                  
   200 000000D8 BB0100                  	mov		bx,1
   201 000000DB BAFE01                  	mov		dx,510
   202 000000DE B90100                  	mov		cx,1
   203 000000E1 E8F014                  	call	PerspectiveZW
   204 000000E4 89CD                    	mov		bp,cx
   205 000000E6 E8D104                  	call	Plot11
   206                                  
   207 000000E9 BB0100                  	mov		bx,1
   208 000000EC BA0100                  	mov		dx,1
   209 000000EF B90100                  	mov		cx,1
   210 000000F2 E8DF14                  	call	PerspectiveZW
   211 000000F5 89CD                    	mov		bp,cx
   212 000000F7 E8C004                  	call	Plot11
   213                                  
   214 000000FA BB0100                  	mov		bx,1
   215 000000FD BAFE01                  	mov		dx,510
   216 00000100 B9FE01                  	mov		cx,510
   217 00000103 E8CE14                  	call	PerspectiveZW
   218 00000106 89CD                    	mov		bp,cx
   219 00000108 E8AF04                  	call	Plot11
   220                                  
   221 0000010B BB0100                  	mov		bx,1
   222 0000010E BA0100                  	mov		dx,1
   223 00000111 B9FE01                  	mov		cx,510
   224 00000114 E8BD14                  	call	PerspectiveZW
   225 00000117 89CD                    	mov		bp,cx
   226 00000119 E89E04                  	call	Plot11
   227                                  
   228 0000011C A1[2A94]                		mov	ax,[XAngle]
   229 0000011F 83C001                  		add	ax,1
   230 00000122 25FF03                  		and ax,03ffh
   231 00000125 A3[2A94]                		mov	[XAngle],ax
   232 00000128 A1[2C94]                		mov	ax,[YAngle]
   233 0000012B 83E801                  		sub	ax,1
   234 0000012E 25FF03                  		and ax,03ffh
   235 00000131 A3[2C94]                		mov	[YAngle],ax
   236 00000134 A1[2E94]                		mov	ax,[ZAngle]
   237 00000137 83C001                  		add	ax,1
   238 0000013A 25FF03                  		and ax,03ffh
   239 0000013D A3[2E94]                		mov	[ZAngle],ax
   240                                  ;		call	BuildRotateMatrix
   241                                  
   242                                  ;		mov word	[XOffset],0
   243                                  ;		mov word	[YOffset],0
   244                                  ;		mov word	[ZOffset],250
   245 00000140 BE[FC25]                		mov	si,ObjectPoints00 ; points
   246 00000143 BF[8C26]                		mov	di,ObjectLines00 ; lines
   247 00000146 B108                    		mov	cl,8 ; 8 		; points
   248 00000148 B50C                    		mov	ch,12 ; 12	; lines
   249                                  ;		call 		DrawObject
   250                                  
   251                                  ;		mov word	[XOffset],200
   252                                  ;		mov word	[YOffset],200
   253                                  ;		mov word	[ZOffset],200
   254 0000014A BE[FC25]                		mov	si,ObjectPoints00 ; points
   255 0000014D BF[8C26]                		mov	di,ObjectLines00 ; lines
   256 00000150 B108                    		mov	cl,8 ; 8 		; points
   257 00000152 B50C                    		mov	ch,12 ; 12	; lines
   258 00000154 E83F12                  		call 		DrawObjectZW
   259                                  
   260                                  
   261 00000157 B90300                  	mov	cx,3
   262 0000015A E8FF03                  	call	Move
   263                                  	
   264 0000015D B90300                  	mov	cx,3
   265 00000160 E8E303                  	call	Plots
   266                                  
   267 00000163 B0DD                    	mov		al,11011101b ;20 ; 100
   268 00000165 B90300                  	mov		cx,3
   269 00000168 8D36[C42C]              	lea		si,[PointList2]		; point list
   270 0000016C E86204                  	call	Fill
   271                                  
   272 0000016F B099                    	mov		al,10011001b ;20 ; 100
   273 00000171 B90300                  	mov		cx,3
   274 00000174 8D36[B42C]              	lea		si,[PointList]		; point list
   275 00000178 E85604                  	call	Fill
   276                                  
   277 0000017B B0BB                    	mov		al,10111011b ;20 ; 100
   278 0000017D B90300                  	mov		cx,3
   279 00000180 8D36[D42C]              	lea		si,[PointList3]
   280                                  ;	call	Fill
   281                                  
   282                                  
   283 00000184 B011                    	mov		al,00010001b
   284 00000186 B90300                  	mov		cx,3
   285 00000189 8D36[E42C]              	lea		si,[PointList4]
   286 0000018D E84104                  	call	Fill
   287                                  
   288 00000190 B000                    	mov		al,00000000b
   289 00000192 B90300                  	mov		cx,3
   290 00000195 8D36[F42C]              	lea		si,[PointList5]
   291 00000199 E83504                  	call	Fill
   292                                  
   293 0000019C B022                    	mov		al,00100010b
   294 0000019E B90300                  	mov		cx,3
   295 000001A1 8D36[042D]              	lea		si,[PointList6]
   296 000001A5 E82904                  	call	Fill
   297                                  
   298 000001A8 B033                    	mov		al,00110011b
   299 000001AA B90300                  	mov		cx,3
   300 000001AD 8D36[142D]              	lea		si,[PointList7]
   301 000001B1 E81D04                  	call	Fill
   302                                  
   303 000001B4 B044                    	mov		al,01000100b
   304 000001B6 B90300                  	mov		cx,3
   305 000001B9 8D36[242D]              	lea		si,[PointList8]
   306 000001BD E81104                  	call	Fill
   307                                  
   308 000001C0 B055                    	mov		al,01010101b
   309 000001C2 B90300                  	mov		cx,3
   310 000001C5 8D36[342D]              	lea		si,[PointList9]
   311 000001C9 E80504                  	call	Fill
   312                                  
   313 000001CC B066                    	mov		al,01100110b
   314 000001CE B90300                  	mov		cx,3
   315 000001D1 8D36[442D]              	lea		si,[PointList10]
   316 000001D5 E8F903                  	call	Fill
   317                                  
   318 000001D8 B077                    	mov		al,01110111b
   319 000001DA B90300                  	mov		cx,3
   320 000001DD 8D36[542D]              	lea		si,[PointList11]
   321 000001E1 E8ED03                  	call	Fill
   322                                  
   323 000001E4 B088                    	mov		al,10001000b
   324 000001E6 B90300                  	mov		cx,3
   325 000001E9 8D36[642D]              	lea		si,[PointList12]
   326 000001ED E8E103                  	call	Fill
   327                                  
   328 000001F0 B099                    	mov		al,10011001b
   329 000001F2 B90300                  	mov		cx,3
   330 000001F5 8D36[742D]              	lea		si,[PointList13]
   331 000001F9 E8D503                  	call	Fill
   332                                  
   333 000001FC B0AA                    	mov		al,10101010b
   334 000001FE B90300                  	mov		cx,3
   335 00000201 8D36[842D]              	lea		si,[PointList14]
   336 00000205 E8C903                  	call	Fill
   337                                  
   338 00000208 B0BB                    	mov		al,10111011b
   339 0000020A B90300                  	mov		cx,3
   340 0000020D 8D36[942D]              	lea		si,[PointList15]
   341 00000211 E8BD03                  	call	Fill
   342                                  
   343 00000214 B0CC                    	mov		al,11001100b
   344 00000216 B90300                  	mov		cx,3
   345 00000219 8D36[A42D]              	lea		si,[PointList16]
   346 0000021D E8B103                  	call	Fill
   347                                  
   348 00000220 B0DD                    	mov		al,11011101b
   349 00000222 B90300                  	mov		cx,3
   350 00000225 8D36[B42D]              	lea		si,[PointList17]
   351 00000229 E8A503                  	call	Fill
   352                                  
   353 0000022C B0EE                    	mov		al,11101110b
   354 0000022E B90300                  	mov		cx,3
   355 00000231 8D36[C42D]              	lea		si,[PointList18]
   356 00000235 E89903                  	call	Fill
   357                                  
   358 00000238 B0FF                    	mov		al,11111111b
   359 0000023A B90300                  	mov		cx,3
   360 0000023D 8D36[D42D]              	lea		si,[PointList19]
   361 00000241 E88D03                  	call	Fill
   362                                  
   363                                  ; 00=0
   364                                  ; 01=1
   365                                  ; 10=2
   366                                  ; 11=3
   367                                  
   368                                  ; 00 00000000
   369                                  ; 01 00010001
   370                                  ; 02 00100010
   371                                  ; 03 00110011
   372                                  ; 10 01000100
   373                                  ; 11 01010101
   374                                  ; 12 01100110
   375                                  ; 13 01110111
   376                                  ; 20 10001000
   377                                  ; 21 10011001
   378                                  ; 22 10101010
   379                                  ; 23 10111011
   380                                  ; 30 11001100
   381                                  ; 31 11011101
   382                                  ; 32 11101110
   383                                  ; 33 11111111
   384                                  
   385                                  
   386                                  
   387 00000244 B316                    		mov		bl,22
   388 00000246 A1[3D94]                		mov		ax,[Test0]
   389 00000249 E82711                  		call	Hex16
   390 0000024C B317                    		mov		bl,23
   391 0000024E A1[3F94]                		mov		ax,[Test1]
   392 00000251 E81F11                  		call	Hex16
   393 00000254 B318                    		mov		bl,24
   394 00000256 A1[4194]                		mov		ax,[Test2]
   395 00000259 E81711                  		call	Hex16
   396 0000025C B319                    		mov		bl,25
   397 0000025E A1[4394]                		mov		ax,[Test3]
   398 00000261 E80F11                  		call	Hex16
   399 00000264 B31A                    		mov		bl,26
   400 00000266 A1[4594]                		mov		ax,[Test4]
   401 00000269 E80711                  		call	Hex16
   402                                  ;		mov		bl,27
   403                                  ;		mov		ax,[Test5]
   404                                  ;		call	Hex16
   405                                  ;		mov		bl,28
   406                                  ;		mov		ax,[Test6]
   407                                  ;		call	Hex16
   408                                  ;		mov		bl,29
   409                                  ;		mov		ax,[Test7]
   410                                  ;		call	Hex16
   411                                  ;		mov		bl,30
   412                                  ;		mov		ax,[Test8]
   413                                  ;		call	Hex16
   414                                  ;		mov		bl,31
   415                                  ;		mov		ax,[Test9]
   416                                  ;		call	Hex16
   417                                  
   418 0000026C B314                    		mov		bl,20
   419 0000026E B85020                  		mov		ax,8192+80
   420                                  ;		call	Hex16
   421 00000271 B315                    		mov		bl,21
   422 00000273 B850E0                  		mov		ax,-8192+80
   423                                  ;		call	Hex16
   424                                  	
   425                                  		
   426                                  ;		call	Test
   427                                  		
   428 00000276 E8D601                  		call	GetKey
   429                                  		
   430 00000279 A0[3094]                	mov		al,[Exit]
   431 0000027C 08C0                    	or		al,al
   432 0000027E 0F84A5FD                	je		MainLoop
   433                                  
   434 00000282 B80300                  Done:	mov		ax,3	; reset to text mode
   435 00000285 CD10                    		int		10h
   436 00000287 B44C                    		mov		ah,4ch	; exit to DOS
   437 00000289 CD21                    		int		21h
   438                                  
   439 0000028B 8D3E[0000]              BuildScreenTable:	lea		di,[BackBufferTable]
   440 0000028F 31ED                    					xor		bp,bp	; even lines
   441 00000291 B96400                  					mov		cx,100
   442 00000294 892D                    .loop:					mov		[di],bp
   443 00000296 81C50020                						add		bp,8192
   444 0000029A 896D02                  						mov		[di+2],bp
   445 0000029D 81EDB01F                						sub		bp,8192-80
   446 000002A1 83C704                  						add		di,4
   447 000002A4 E2EE                    						loop	.loop
   448 000002A6 C3                      					ret
   449                                  
   450 000002A7 39F2                    Line11:		cmp		dx,si 	; vs le ve?
   451 000002A9 7306                    			jnc		.noswap	; yes
   452 000002AB 87F2                    				xchg	si,dx	; swap vs,ve
   453 000002AD 87E9                    				xchg	bp,cx	; swap hs,he
   454 000002AF EB06                    				jmp	.vdiff
   455                                  
   456 000002B1 7504                    .noswap:	jne		.vdiff			; v not same
   457 000002B3 39E9                    			cmp		cx,bp		; v is same 
   458 000002B5 7436                    			je 		.quit		; h is same
   459                                  
   460 000002B7 29F2                    .vdiff:		sub		dx,si	; ver diff = ve-vs
   461 000002B9 29E9                    			sub		cx,bp	; hs le he? - replace with sub below? todo
   462 000002BB 7360                    			jnc		.hforward	; yes
   463                                  
   464 000002BD F7D9                    .hbackward:	neg 	cx	 		; decrement line across everytime and line down every few times
   465 000002BF 39D1                     			cmp		cx,dx
   466 000002C1 7501                    			jne		.hbnodiag ; .quit ; .vbackward ; .quit ;	.vbackward
   467 000002C3 41                      					inc		cx	; diagonal
   468 000002C4 7228                    .hbnodiag:	jc		.vbackward
   469                                  
   470 000002C6 F7F1                    			div 	cx		; dx:ax *bx = ax*65536 *bx
   471 000002C8 01F6                    			add		si,si	; start ver *2
   472 000002CA 01ED                    			add		bp,bp	; start hor *2
   473 000002CC 81C6[0000]              			add		si,BackBufferTable
   474 000002D0 3E8B3C                  			mov		di,[ds:si]	; lookup start ver		
   475                                  	
   476 000002D3 00E0                    .hbloop:		add 	al,ah	; fraction to current
   477 000002D5 7306                    				jnc		.hbplot	;
   478 000002D7 83C602                  					add		si,2
   479 000002DA 3E8B3C                  					mov		di,[ds:si]	; lookup start ver
   480                                  
   481 000002DD 8B9E[000A]              .hbplot:		mov		bx,[HorPosTable+bp]
   482 000002E1 8AB6[0000]              				mov		dh,[OrTable+bp]
   483 000002E5 260831                  				or byte [es:di+bx],dh
   484                                  
   485 000002E8 83ED02                  				sub		bp,2		; next hor
   486 000002EB E2E6                    				loop	.hbloop		; dec cx jnz
   487 000002ED C3                      .quit:		ret
   488                                  
   489 000002EE 87D1                    .vbackward: xchg 	dx,cx			; decrement line down everytime and line across every few times
   490 000002F0 F7F1                    			div 	cx		; dx:ax *bx = ax*65536 *bx
   491                                  
   492 000002F2 01F6                    			add		si,si	; start ver *2
   493 000002F4 01ED                    			add		bp,bp	; start hor *2
   494 000002F6 81C6[0000]              			add		si,BackBufferTable
   495                                  	
   496 000002FA 8AB6[0000]              			mov		dh,[OrTable+bp]
   497 000002FE 8B9E[000A]              			mov		bx,[HorPosTable+bp]
   498                                  	
   499 00000302 00E0                    .vbloop:		add 	al,ah	; fraction to current
   500 00000304 730B                    				jnc		.vbplot	;
   501 00000306 83ED02                  					sub		bp,2
   502 00000309 8AB6[0000]              					mov		dh,[OrTable+bp]
   503 0000030D 8B9E[000A]              					mov		bx,[HorPosTable+bp]
   504                                  		
   505 00000311 3E8B3C                  .vbplot:		mov		di,[ds:si]	; lookup start ver
   506 00000314 260831                  				or byte [es:di+bx],dh
   507                                  
   508 00000317 83C602                  				add		si,2		; next ver
   509 0000031A E2E6                    				loop	.vbloop		; dec cl jnz
   510 0000031C C3                      			ret
   511                                  
   512 0000031D 39D1                    .hforward: 	cmp		cx,dx			; increment line across everytime and line down every few times
   513 0000031F 7501                    			jne		.hfnodiag
   514 00000321 41                      				inc 	cx	; diagonal
   515 00000322 7228                    .hfnodiag:	jc		.vforward
   516                                  
   517 00000324 F7F1                    			div 	cx		; dx:ax *bx = ax*65536 *bx
   518 00000326 01F6                    			add		si,si	; start ver *2
   519 00000328 01ED                    			add		bp,bp	; start hor *2
   520 0000032A 81C6[0000]              			add		si,BackBufferTable
   521 0000032E 3E8B3C                  			mov		di,[ds:si]	; lookup start ver
   522                                  
   523 00000331 00E0                    .hfloop:		add 	al,ah	; fraction to current
   524 00000333 7306                    				jnc		.hfplot	;
   525 00000335 83C602                  					add		si,2
   526 00000338 3E8B3C                  					mov		di,[ds:si]	; lookup start ver		
   527                                  
   528 0000033B 8B9E[000A]              .hfplot:		mov		bx,[HorPosTable+bp]
   529 0000033F 8AB6[0000]              				mov		dh,[OrTable+bp]
   530 00000343 260831                  				or byte [es:di+bx],dh
   531                                  
   532 00000346 83C502                  				add		bp,2		; next hor
   533 00000349 E2E6                    				loop	.hfloop		; dec cx jnz
   534 0000034B C3                      			ret
   535                                  
   536                                  ;	mov		di,[ds:si]
   537                                  
   538 0000034C 87D1                    .vforward:	xchg 	dx,cx			; increment line down everytime and line across every few times
   539 0000034E F7F1                    			div 	cx		; dx:ax *bx = ax*65536 *bx
   540                                  
   541 00000350 01F6                    			add		si,si	; start ver *2
   542 00000352 01ED                    			add		bp,bp	; start hor *2
   543 00000354 81C6[0000]              			add		si,BackBufferTable
   544                                  
   545 00000358 8AB6[0000]              			mov		dh,[OrTable+bp]
   546 0000035C 8B9E[000A]              			mov		bx,[HorPosTable+bp]
   547                                  	
   548 00000360 00E0                    .vfloop:		add 	al,ah	; fraction to current
   549 00000362 730B                    				jnc		.vfplot	;
   550 00000364 83C502                  					add		bp,2
   551 00000367 8AB6[0000]              					mov		dh,[OrTable+bp]
   552 0000036B 8B9E[000A]              					mov		bx,[HorPosTable+bp]
   553                                  		
   554 0000036F 3E8B3C                  .vfplot:		mov		di,[ds:si]	; lookup start ver
   555 00000372 260831                  				or byte [es:di+bx],dh
   556                                  
   557 00000375 83C602                  				add		si,2		; next ver
   558 00000378 E2E6                    				loop	.vfloop		; dec cl jnz
   559 0000037A C3                      			ret
   560                                  
   561 0000037B 39F2                    Line00:		cmp		dx,si 	; vs le ve?
   562 0000037D 7306                    			jnc		.noswap	; yes
   563 0000037F 87F2                    				xchg	si,dx	; swap vs,ve
   564 00000381 87E9                    				xchg	bp,cx	; swap hs,he
   565 00000383 EB06                    				jmp	.vdiff
   566                                  
   567 00000385 7504                    .noswap:	jne		.vdiff			; v not same
   568 00000387 39E9                    				cmp		cx,bp		; v is same 
   569 00000389 7436                    				je 		.quit		; h is same
   570                                  
   571 0000038B 29F2                    .vdiff:		sub		dx,si	; ver diff = ve-vs
   572 0000038D 29E9                    			sub		cx,bp	; hs le he? - replace with sub below? todo
   573 0000038F 7360                    			jnc		.hforward	; yes
   574                                  
   575 00000391 F7D9                    .hbackward:	neg 	cx		; decrement line across everytime and line down every few times
   576                                   
   577 00000393 39D1                    			cmp		cx,dx
   578 00000395 7501                    			jne		.hbnodiag ; .quit ; .vbackward ; .quit ;	.vbackward
   579 00000397 41                      				inc	cx	; diagonal
   580 00000398 7228                    .hbnodiag:	jc		.vbackward
   581                                  
   582 0000039A F7F1                    			div 	cx		; dx:ax *bx = ax*65536 *bx
   583 0000039C 01F6                    			add		si,si	; start ver *2
   584 0000039E 01ED                    			add		bp,bp	; start hor *2
   585 000003A0 81C6[0000]              			add		si,BackBufferTable
   586 000003A4 3E8B3C                  			mov		di,[ds:si]	; lookup start ver
   587                                  	
   588 000003A7 00E0                    .hbloop:		add 	al,ah	; fraction to current
   589 000003A9 7306                    				jnc		.hbplot	;
   590 000003AB 83C602                  					add		si,2
   591 000003AE 3E8B3C                  					mov		di,[ds:si]	; lookup start ver
   592                                  
   593 000003B1 8B9E[000A]              .hbplot:		mov		bx,[HorPosTable+bp]
   594 000003B5 8AB6[0005]              				mov		dh,[AndTable+bp]
   595 000003B9 262031                  				and byte [es:di+bx],dh
   596                                  
   597 000003BC 83ED02                  				sub		bp,2		; next hor
   598 000003BF E2E6                    				loop	.hbloop		; dec cx jnz
   599 000003C1 C3                      .quit:		ret
   600                                  
   601 000003C2 87D1                    .vbackward:	xchg 	dx,cx		; decrement line down everytime and line across every few times
   602 000003C4 F7F1                    			div 	cx		; dx:ax *bx = ax*65536 *bx
   603                                  
   604 000003C6 01F6                    			add		si,si	; start ver *2
   605 000003C8 01ED                    			add		bp,bp	; start hor *2
   606 000003CA 81C6[0000]              			add		si,BackBufferTable
   607 000003CE 8AB6[0005]              			mov		dh,[AndTable+bp]
   608 000003D2 8B9E[000A]              			mov		bx,[HorPosTable+bp]
   609                                  	
   610 000003D6 00E0                    .vbloop:		add 	al,ah	; fraction to current
   611 000003D8 730B                    				jnc		.vbplot	;
   612 000003DA 83ED02                  					sub		bp,2
   613 000003DD 8AB6[0005]              					mov		dh,[AndTable+bp]
   614 000003E1 8B9E[000A]              					mov		bx,[HorPosTable+bp]
   615                                  		
   616 000003E5 3E8B3C                  .vbplot:		mov		di,[ds:si]	; lookup start ver
   617 000003E8 262031                  				and byte [es:di+bx],dh
   618                                  
   619 000003EB 83C602                  				add		si,2		; next ver
   620 000003EE E2E6                    				loop	.vbloop		; dec cl jnz
   621 000003F0 C3                      			ret
   622                                  
   623 000003F1 39D1                    .hforward: 	cmp		cx,dx		; increment line across everytime and line down every few times
   624 000003F3 7501                    			jne		.hfnodiag
   625 000003F5 41                      				inc 	cx	; diagonal
   626 000003F6 7228                    .hfnodiag:	jc		.vforward
   627                                  
   628 000003F8 F7F1                    			div 	cx		; dx:ax *bx = ax*65536 *bx
   629 000003FA 01F6                    			add		si,si	; start ver *2
   630 000003FC 01ED                    			add		bp,bp	; start hor *2
   631 000003FE 81C6[0000]              			add		si,BackBufferTable
   632 00000402 3E8B3C                  			mov		di,[ds:si]	; lookup start ver
   633                                  	
   634 00000405 00E0                    .hfloop:		add 	al,ah	; fraction to current
   635 00000407 7306                    				jnc		.hfplot	;
   636 00000409 83C602                  					add		si,2
   637 0000040C 3E8B3C                  					mov		di,[ds:si]	; lookup start ver		
   638                                  
   639 0000040F 8B9E[000A]              .hfplot:		mov		bx,[HorPosTable+bp]
   640 00000413 8AB6[0005]              				mov		dh,[AndTable+bp]
   641 00000417 262031                  				and byte [es:di+bx],dh
   642                                  	
   643 0000041A 83C502                  				add		bp,2		; next hor
   644 0000041D E2E6                    				loop	.hfloop		; dec cx jnz
   645 0000041F C3                      			ret
   646                                  
   647 00000420 87D1                    .vforward: 	xchg 	dx,cx			; increment line down everytime and line across every few times
   648 00000422 F7F1                    			div 	cx		; dx:ax *bx = ax*65536 *bx
   649                                  
   650 00000424 01F6                    			add		si,si	; start ver *2
   651 00000426 01ED                    			add		bp,bp	; start hor *2
   652 00000428 81C6[0000]              			add		si,BackBufferTable
   653 0000042C 8AB6[0005]              			mov		dh,[AndTable+bp]
   654 00000430 8B9E[000A]              			mov		bx,[HorPosTable+bp]
   655                                  	
   656 00000434 00E0                    .vfloop:		add 	al,ah	; fraction to current
   657 00000436 730B                    				jnc		.vfplot	;
   658 00000438 83C502                  					add		bp,2
   659 0000043B 8AB6[0005]              					mov		dh,[AndTable+bp]
   660 0000043F 8B9E[000A]              					mov		bx,[HorPosTable+bp]
   661                                  		
   662 00000443 3E8B3C                  .vfplot:		mov		di,[ds:si]	; lookup start ver
   663 00000446 262031                  				and byte [es:di+bx],dh
   664                                  
   665 00000449 83C602                  				add		si,2		; next ver
   666 0000044C E2E6                    				loop	.vfloop		; dec cl jnz
   667 0000044E C3                      			ret
   668                                  
   669                                  GetKey:
   670 0000044F B411                    	mov	ah,11h
   671 00000451 CD16                    	int	16h         	; has a key been pressed
   672 00000453 7426                    	jz	.key_none ; no
   673 00000455 B410                    	mov	ah,10h      ; yes 
   674 00000457 CD16                    	int	16h         	; get it in AX (al= ascii, ah=scan code)
   675 00000459 3C1B                    	cmp	al,KEY_ESC
   676 0000045B 741F                    	je	.key_esc
   677 0000045D 3D3102                  	cmp 	ax,KEY_1
   678 00000460 7420                    	je 	.key_1
   679 00000462 3D3203                  	cmp 	ax,KEY_2
   680 00000465 742F                    	je 	.key_2
   681 00000467 3D3304                  	cmp 	ax,KEY_3
   682 0000046A 743E                    	je 	.key_3
   683 0000046C 3D3405                  	cmp 	ax,KEY_4
   684 0000046F 744D                    	je 	.key_4
   685 00000471 3D3506                  	cmp 	ax,KEY_5
   686 00000474 745C                    	je 	.key_5
   687 00000476 3D3607                  	cmp 	ax,KEY_6
   688 00000479 746B                    	je 	.key_6
   689                                  .key_none:
   690 0000047B C3                      	ret
   691                                  .key_esc:
   692 0000047C B001                    	mov	al,1
   693 0000047E A2[3094]                	mov	[Exit],al
   694 00000481 C3                      	ret
   695                                  .key_1:
   696 00000482 A1[A426]                	mov ax,[HOffset]
   697 00000485 83E801                  	sub ax,1
   698 00000488 A3[A426]                	mov [HOffset],ax
   699 0000048B A1[AE28]                	mov ax,[testx]
   700 0000048E 48                      	dec ax
   701 0000048F 25FF01                  	and ax,511
   702 00000492 A3[AE28]                	mov [testx],ax
   703 00000495 C3                      	ret
   704                                  .key_2:
   705 00000496 A1[A426]                	mov ax,[HOffset]
   706 00000499 83C001                  	add ax,1
   707 0000049C A3[A426]                	mov [HOffset],ax
   708 0000049F A1[AE28]                	mov ax,[testx]
   709 000004A2 40                      	inc ax
   710 000004A3 25FF01                  	and ax,511
   711 000004A6 A3[AE28]                	mov [testx],ax
   712 000004A9 C3                      	ret
   713                                  .key_3:
   714 000004AA A1[A626]                	mov ax,[VOffset]
   715 000004AD 83E801                  	sub ax,1
   716 000004B0 A3[A626]                	mov [VOffset],ax
   717 000004B3 A1[B028]                	mov ax,[testy]
   718 000004B6 48                      	dec ax
   719 000004B7 25FF01                  	and ax,511
   720 000004BA A3[B028]                	mov [testy],ax
   721 000004BD C3                      	ret
   722                                  .key_4:
   723 000004BE A1[A626]                	mov ax,[VOffset]
   724 000004C1 83C001                  	add ax,1
   725 000004C4 A3[A626]                	mov [VOffset],ax
   726 000004C7 A1[B028]                	mov ax,[testy]
   727 000004CA 40                      	inc ax
   728 000004CB 25FF01                  	and ax,511
   729 000004CE A3[B028]                	mov [testy],ax
   730 000004D1 C3                      	ret
   731                                  .key_5:
   732 000004D2 A1[AC26]                	mov ax,[ZOffset]
   733 000004D5 83E801                  	sub ax,1
   734 000004D8 A3[AC26]                	mov [ZOffset],ax
   735 000004DB A1[B228]                	mov ax,[testz]
   736 000004DE 48                      	dec ax
   737 000004DF 25FF01                  	and ax,511
   738 000004E2 A3[B228]                	mov [testz],ax
   739 000004E5 C3                      	ret
   740                                  .key_6:
   741 000004E6 A1[AC26]                	mov ax,[ZOffset]
   742 000004E9 83C001                  	add ax,1
   743 000004EC A3[AC26]                	mov [ZOffset],ax
   744 000004EF A1[B228]                	mov ax,[testz]
   745 000004F2 40                      	inc ax
   746 000004F3 25FF01                  	and ax,511
   747 000004F6 A3[B228]                	mov [testz],ax
   748 000004F9 C3                      	ret
   749                                  
   750 000004FA BADA03                  WaitVSync: 			mov		dx,INPUT_STATUS_1	; Wait for the leading edge of vertical sync pulse.
   751 000004FD EC                      WaitNotVSyncLoop:		in		al,dx
   752 000004FE 2408                    						and		al,VSYNC_MASK
   753 00000500 75FB                    						jnz		WaitNotVSyncLoop
   754 00000502 EC                      WaitVSyncLoop:			in		al,dx
   755 00000503 2408                    						and		al,VSYNC_MASK
   756 00000505 74FB                    						jz		WaitVSyncLoop
   757 00000507 C3                      					ret
   758                                  		
   759                                  CopyClearBackBuffer:
   760 00000508 FC                      	cld
   761                                  
   762 00000509 8CDD                    	mov		bp,ds			; backup ds
   763                                  
   764 0000050B 8B16[5194]              	mov		dx,[BackBufferSeg]
   765 0000050F 8EDA                    	mov		ds,dx
   766                                  
   767 00000511 B800B8                  	mov		ax,VIDEO_SEGMENT
   768 00000514 8EC0                    	mov		es,ax
   769                                  
   770 00000516 31F6                    	xor		si,si		; DS:SI points to even back buffer
   771 00000518 89F7                    	mov		di,si		; ES:DI points to CGA memory.
   772                                  
   773 0000051A B9D007                  	mov		cx,2000
   774 0000051D F366A5                  	rep	movsd			; copy from ds:si to es:di
   775                                  
   776 00000520 BE0020                  	mov		si,8192		; DS:SI points to odd back buffer
   777 00000523 89F7                    	mov		di,si		; ES:DI points to CGA memory.
   778                                  
   779 00000525 B9D007                  	mov		cx,2000
   780 00000528 F366A5                  	rep	movsd			; copy from ds:si to es:di
   781                                  
   782 0000052B 8CD8                    	mov		ax,ds		; es points to ds
   783 0000052D 8EC0                    	mov		es,ax
   784                                  
   785 0000052F 6631C0                  	xor eax,eax ; mov		ax,00101101001011010b ;
   786                                  	
   787 00000532 31FF                    	xor		di,di		; DS:SI points to even back buffer	
   788 00000534 B9D007                  	mov		cx,2000
   789 00000537 F366AB                  	rep	stosd			; clear odd back buffer
   790                                  
   791 0000053A BF0020                  	mov		di,8192		; DS:SI points to odd back buffer	
   792 0000053D B9D007                  	mov		cx,2000
   793 00000540 F366AB                  	rep	stosd			; clear odd back buffer
   794                                  
   795 00000543 8EDD                    	mov		ds,bp			; restore ds
   796                                  
   797 00000545 C3                      	ret
   798                                  
   799 00000546 8D36[B42C]              Plots:	lea 	si,[PointList]
   800                                   
   801 0000054A 51                      .loop		push	cx
   802 0000054B 8B1C                    			mov		bx,[si]
   803 0000054D 8B6C02                  			mov		bp,[si+2]
   804 00000550 E86700                  			call 	Plot11
   805 00000553 59                      			pop		cx
   806                                   
   807 00000554 83C604                  			add	si,4
   808 00000557 FEC9                    			dec	cl
   809 00000559 75EF                    			jne	.loop
   810 0000055B C3                      		ret
   811                                  
   812 0000055C 8D36[B42C]              Move:	lea 	si,[PointList]
   813 00000560 8D3E[E42D]              		lea		di,[DirList]
   814                                   
   815 00000564 8B04                    .loop		mov		ax,[si]
   816 00000566 8B5C02                  			mov		bx,[si+2]
   817 00000569 8B15                    			mov		dx,[di]
   818 0000056B 8B6D02                  			mov		bp,[di+2]
   819 0000056E 01D0                    			add		ax,dx
   820 00000570 01EB                    			add		bx,bp
   821 00000572 8904                    			mov		[si],ax
   822 00000574 895C02                  			mov		[si+2],bx
   823                                  	
   824 00000577 83F800                  			cmp 	ax,0
   825 0000057A 7502                    			jne 	.testxl
   826 0000057C F7DA                    				neg 	dx
   827 0000057E 83FB00                  .testxl		cmp 	bx,0
   828 00000581 7502                    			jne 	.testyl
   829 00000583 F7DD                    				neg 	bp
   830 00000585 3DC700                  .testyl		cmp 	ax,199
   831 00000588 7502                    			jne 	.testxr
   832 0000058A F7DA                    				neg 	dx
   833 0000058C 81FB3F01                .testxr		cmp 	bx,319
   834 00000590 7502                    			jne 	.testyr
   835 00000592 F7DD                    				neg 	bp
   836 00000594 8915                    .testyr		mov 	[di],dx
   837 00000596 896D02                  			mov	[di+2],bp
   838                                   
   839 00000599 83C604                  			add		si,4
   840 0000059C 83C704                  			add		di,4
   841 0000059F 49                      			dec		cx
   842 000005A0 75C2                    			jne		.loop
   843 000005A2 C3                      		ret
   844                                  
   845                                  Plot00:
   846 000005A3 01DB                    	add		bx,bx 			; start ver *2
   847 000005A5 8BBF[0000]              	mov		di,[BackBufferTable+bx]	; lookup start ver
   848 000005A9 01ED                    	add		bp,bp			; start hor *2
   849 000005AB 03BE[000A]              	add		di,[HorPosTable+bp]	; add start hor
   850 000005AF 268A0D                  	mov		cl,[es:di]
   851 000005B2 228E[0005]              	and		cl,[AndTable+bp]
   852 000005B6 26880D                  	mov		[es:di],cl
   853 000005B9 C3                      	ret
   854                                  
   855                                  Plot11:
   856 000005BA 01DB                    	add		bx,bx 			; start ver *2
   857 000005BC 8BBF[0000]              	mov		di,[BackBufferTable+bx]	; lookup start ver
   858 000005C0 01ED                    	add		bp,bp			; start hor *2
   859 000005C2 03BE[000A]              	add		di,[HorPosTable+bp]	; add start hor
   860 000005C6 268A0D                  	mov		cl,[es:di]
   861 000005C9 0A8E[0000]              	or		cl,[OrTable+bp] 
   862 000005CD 26880D                  	mov		[es:di],cl
   863 000005D0 C3                      	ret
   864                                  
   865 000005D1 A2[5394]                Fill:	mov		[Colour],al		; backup colour
   866                                  	
   867                                  ;		lea		si,[PointList]		; point list
   868 000005D4 89CB                    		mov		bx,cx			; points
   869 000005D6 C1E302                  		shl		bx,2			; copy first point to last point
   870 000005D9 668B2C                  		mov		ebp,[si]			; get start xy words
   871 000005DC 668928                  		mov		[si+bx],ebp		; put xy words to end
   872                                  
   873 000005DF BBFF00                  		mov		bx,000ffh		; set lowest and highest
   874                                  
   875 000005E2 51                      .point_loop		push	cx
   876                                  
   877 000005E3 8B04                    				mov		ax,[si]		; vstart
   878 000005E5 8B6C02                  				mov		bp,[si+2]	; hstart
   879 000005E8 8B4C04                  				mov		cx,[si+4]	; vend
   880 000005EB 8B5406                  				mov		dx,[si+6]	; hend
   881                                  
   882 000005EE 8D3E[9481]              				lea		di,[EdgeTable]	; get edge table start - default left edge
   883 000005F2 39C8                    				cmp 	ax,cx 		; compare vstart vend
   884 000005F4 7443                    				jz 		.next 		; if same ignore
   885 000005F6 7206                    				jc		.noswap
   886 000005F8 91                      					xchg 	ax,cx 		; swap vstart vend
   887 000005F9 87EA                    					xchg 	bp,dx 		; swap hstart hend
   888 000005FB 83C704                  					add		di,4		; add 4 for right edge
   889                                  
   890 000005FE 38C3                    .noswap:		cmp 	bl,al 	; smallest xpos
   891 00000600 7202                    				jc 	.low
   892 00000602 88C3                    					mov 	bl,al 	; yes
   893                                  
   894 00000604 38CF                    .low:			cmp 	bh,cl	; biggest xpos
   895 00000606 7302                    				jnc 	.high
   896 00000608 88CF                    					mov		bh,cl 	; yes
   897                                  
   898 0000060A 29C1                    .high			sub		cx,ax		; vdiff
   899                                  
   900 0000060C C1E003                  				shl		ax,3		; *8
   901 0000060F 01C7                    				add		di,ax		; added to di
   902                                  	
   903 00000611 29EA                    				sub		dx,bp		; hdiff
   904                                  
   905 00000613 66C1E510                .positive		shl		ebp,16		; hstart *65536
   906                                  
   907 00000617 660FBFC2                				movsx	eax,dx		; hdiff
   908 0000061B 660FBFC9                				movsx	ecx,cx
   909 0000061F 6699                    				CDQ
   910 00000621 66C1E009                				shl		eax,9		; shift left ax 9 times
   911 00000625 66F7F9                  				idiv	ecx			; divide dx:ax by cx
   912 00000628 66C1E007                				shl		eax,7		; shift result left 7 times so becomes 16:16
   913                                  
   914 0000062C 66892D                  .edge_loop		mov		[di],ebp		; store hstart = temp
   915 0000062F 6601C5                  				add		ebp,eax
   916 00000632 83C708                  				add		di,8
   917 00000635 FEC9                    				dec		cl
   918 00000637 75F3                    				jnz		.edge_loop
   919                                  
   920 00000639 83C604                  .next			add		si,4
   921 0000063C 59                      				pop		cx
   922 0000063D FEC9                    				dec		cl
   923 0000063F 75A1                    				jnz		.point_loop
   924                                   
   925 00000641 28DF                    			sub		bh,bl			; end - start
   926 00000643 7262                    			jc		FillExit		; all on same line?
   927                                  	
   928 00000645 88FA                    			mov		dl,bh
   929 00000647 30FF                    			xor		bh,bh
   930                                  	
   931 00000649 A0[5394]                			mov		al,[Colour]
   932 0000064C 88C4                    			mov 	ah,al
   933 0000064E 66C1E008                			shl 	eax,8
   934 00000652 88E0                    			mov 	al,ah
   935 00000654 66C1E008                			shl 	eax,8
   936 00000658 88E0                    			mov 	al,ah
   937                                  
   938 0000065A 01DB                    			add		bx,bx 			; start ver *2
   939 0000065C 89DF                    			mov		di,bx			; screen line
   940 0000065E C1E302                  			shl		bx,2			; start ver *4*8
   941 00000661 8DBD[0000]              			lea		di,[BackBufferTable+di]
   942 00000665 8DAF[9681]              			lea		bp,[EdgeTable+bx+2]	; point to first 
   943                                  
   944 00000669 55                      .plotloop		push	bp
   945 0000066A 57                      				push 	di
   946                                  
   947 0000066B 8B5E04                  				mov		bx,[bp+4]
   948 0000066E 8B6E00                  				mov		bp,[bp]
   949 00000671 8B3D                    				mov		di,[di]	; lookup start ver
   950                                  
   951 00000673 39DD                    				cmp		bp,bx
   952 00000675 7302                    				jnc		.no_swap
   953 00000677 87EB                    					xchg 	bp, bx
   954                                  
   955 00000679 89D9                    .no_swap:		mov 	cx,bx
   956 0000067B C1E904                  				shr 	cx,4
   957 0000067E C1E102                  				shl 	cx,2
   958 00000681 01CF                    				add 	di,cx
   959                                  
   960 00000683 89D9                    				mov		cx,bx
   961 00000685 89EE                    				mov		si,bp
   962                                  			
   963 00000687 C1EE04                  				shr		si,4
   964 0000068A C1E904                  				shr		cx,4
   965                                  
   966 0000068D 29CE                    				sub		si,cx
   967 0000068F 01F6                    				add		si,si
   968 00000691 8BB4[8025]              				mov		si,[FillTable+si]
   969 00000695 FFE6                    				JMP		(si)
   970                                  
   971                                  Fill000:	fill_cont
   971                              <1> Fill000: 
    74 00000697 5F                  <1>  pop di
    75 00000698 5D                  <1>  pop bp
    76                              <1> 
    77 00000699 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 0000069D 83C508              <1>  add bp,8
    80 000006A0 83C702              <1>  add di,2
    81 000006A3 FECA                <1>  dec dl
    82 000006A5 75C2                <1>  jnz Fill.plotloop
   972 000006A7 C3                      FillExit:	ret
   973                                  
   974                                  Fill004:	left_edge
   974                              <1> Fill004: 
    54 000006A8 C1E302              <1>  shl bx,2
    55 000006AB 26668B0D            <1>  mov ecx,[es:di]
    56 000006AF 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 000006B4 6689C6              <1>  mov esi,eax
    58 000006B7 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 000006BC 6609F1              <1>  or ecx,esi
    60 000006BF 2666890D            <1>  mov [es:di],ecx
   975 000006C3 83C704                  			add		di,4
   976                                  			right_edge
    64 000006C6 C1E502              <1>  shl bp,2
    65 000006C9 26668B0D            <1>  mov ecx,[es:di]
    66 000006CD 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 000006D2 6689C6              <1>  mov esi,eax
    68 000006D5 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 000006DA 6609F1              <1>  or ecx,esi
    70 000006DD 2666890D            <1>  mov [es:di],ecx
   977                                  			fill_cont
    74 000006E1 5F                  <1>  pop di
    75 000006E2 5D                  <1>  pop bp
    76                              <1> 
    77 000006E3 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 000006E7 83C508              <1>  add bp,8
    80 000006EA 83C702              <1>  add di,2
    81 000006ED FECA                <1>  dec dl
    82 000006EF 0F8576FF            <1>  jnz Fill.plotloop
   978 000006F3 C3                      			ret
   979                                  
   980                                  Fill008:	left_edge
   980                              <1> Fill008: 
    54 000006F4 C1E302              <1>  shl bx,2
    55 000006F7 26668B0D            <1>  mov ecx,[es:di]
    56 000006FB 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 00000700 6689C6              <1>  mov esi,eax
    58 00000703 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 00000708 6609F1              <1>  or ecx,esi
    60 0000070B 2666890D            <1>  mov [es:di],ecx
   981 0000070F 83C704                  			add		di,4
   982 00000712 66AB                    			stosd
   983                                  			right_edge
    64 00000714 C1E502              <1>  shl bp,2
    65 00000717 26668B0D            <1>  mov ecx,[es:di]
    66 0000071B 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 00000720 6689C6              <1>  mov esi,eax
    68 00000723 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 00000728 6609F1              <1>  or ecx,esi
    70 0000072B 2666890D            <1>  mov [es:di],ecx
   984                                  			fill_cont
    74 0000072F 5F                  <1>  pop di
    75 00000730 5D                  <1>  pop bp
    76                              <1> 
    77 00000731 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 00000735 83C508              <1>  add bp,8
    80 00000738 83C702              <1>  add di,2
    81 0000073B FECA                <1>  dec dl
    82 0000073D 0F8528FF            <1>  jnz Fill.plotloop
   985 00000741 C3                      			ret
   986                                  
   987                                  Fill012:	left_edge
   987                              <1> Fill012: 
    54 00000742 C1E302              <1>  shl bx,2
    55 00000745 26668B0D            <1>  mov ecx,[es:di]
    56 00000749 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 0000074E 6689C6              <1>  mov esi,eax
    58 00000751 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 00000756 6609F1              <1>  or ecx,esi
    60 00000759 2666890D            <1>  mov [es:di],ecx
   988 0000075D 83C704                  			add		di,4
   989 00000760 B90200                  			mov		cx,2
   990 00000763 F366AB                  			rep		stosd
   991                                  			right_edge
    64 00000766 C1E502              <1>  shl bp,2
    65 00000769 26668B0D            <1>  mov ecx,[es:di]
    66 0000076D 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 00000772 6689C6              <1>  mov esi,eax
    68 00000775 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 0000077A 6609F1              <1>  or ecx,esi
    70 0000077D 2666890D            <1>  mov [es:di],ecx
   992                                  			fill_cont
    74 00000781 5F                  <1>  pop di
    75 00000782 5D                  <1>  pop bp
    76                              <1> 
    77 00000783 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 00000787 83C508              <1>  add bp,8
    80 0000078A 83C702              <1>  add di,2
    81 0000078D FECA                <1>  dec dl
    82 0000078F 0F85D6FE            <1>  jnz Fill.plotloop
   993 00000793 C3                      			ret
   994                                  
   995                                  Fill016:	left_edge
   995                              <1> Fill016: 
    54 00000794 C1E302              <1>  shl bx,2
    55 00000797 26668B0D            <1>  mov ecx,[es:di]
    56 0000079B 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 000007A0 6689C6              <1>  mov esi,eax
    58 000007A3 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 000007A8 6609F1              <1>  or ecx,esi
    60 000007AB 2666890D            <1>  mov [es:di],ecx
   996 000007AF 83C704                  			add		di,4
   997 000007B2 B90300                  			mov		cx,3
   998 000007B5 F366AB                  			rep		stosd
   999                                  			right_edge
    64 000007B8 C1E502              <1>  shl bp,2
    65 000007BB 26668B0D            <1>  mov ecx,[es:di]
    66 000007BF 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 000007C4 6689C6              <1>  mov esi,eax
    68 000007C7 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 000007CC 6609F1              <1>  or ecx,esi
    70 000007CF 2666890D            <1>  mov [es:di],ecx
  1000                                  			fill_cont
    74 000007D3 5F                  <1>  pop di
    75 000007D4 5D                  <1>  pop bp
    76                              <1> 
    77 000007D5 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 000007D9 83C508              <1>  add bp,8
    80 000007DC 83C702              <1>  add di,2
    81 000007DF FECA                <1>  dec dl
    82 000007E1 0F8584FE            <1>  jnz Fill.plotloop
  1001 000007E5 C3                      			ret
  1002                                  
  1003                                  Fill020:left_edge
  1003                              <1> Fill020:
    54 000007E6 C1E302              <1>  shl bx,2
    55 000007E9 26668B0D            <1>  mov ecx,[es:di]
    56 000007ED 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 000007F2 6689C6              <1>  mov esi,eax
    58 000007F5 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 000007FA 6609F1              <1>  or ecx,esi
    60 000007FD 2666890D            <1>  mov [es:di],ecx
  1004 00000801 83C704                  			add		di,4
  1005 00000804 B90400                  			mov		cx,4
  1006 00000807 F366AB                  			rep		stosd
  1007                                  			right_edge
    64 0000080A C1E502              <1>  shl bp,2
    65 0000080D 26668B0D            <1>  mov ecx,[es:di]
    66 00000811 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 00000816 6689C6              <1>  mov esi,eax
    68 00000819 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 0000081E 6609F1              <1>  or ecx,esi
    70 00000821 2666890D            <1>  mov [es:di],ecx
  1008                                  			fill_cont
    74 00000825 5F                  <1>  pop di
    75 00000826 5D                  <1>  pop bp
    76                              <1> 
    77 00000827 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 0000082B 83C508              <1>  add bp,8
    80 0000082E 83C702              <1>  add di,2
    81 00000831 FECA                <1>  dec dl
    82 00000833 0F8532FE            <1>  jnz Fill.plotloop
  1009 00000837 C3                      			ret
  1010                                  
  1011                                  Fill024:left_edge
  1011                              <1> Fill024:
    54 00000838 C1E302              <1>  shl bx,2
    55 0000083B 26668B0D            <1>  mov ecx,[es:di]
    56 0000083F 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 00000844 6689C6              <1>  mov esi,eax
    58 00000847 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 0000084C 6609F1              <1>  or ecx,esi
    60 0000084F 2666890D            <1>  mov [es:di],ecx
  1012 00000853 83C704                  			add		di,4
  1013 00000856 B90500                  			mov		cx,5
  1014 00000859 F366AB                  			rep		stosd
  1015                                  			right_edge
    64 0000085C C1E502              <1>  shl bp,2
    65 0000085F 26668B0D            <1>  mov ecx,[es:di]
    66 00000863 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 00000868 6689C6              <1>  mov esi,eax
    68 0000086B 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 00000870 6609F1              <1>  or ecx,esi
    70 00000873 2666890D            <1>  mov [es:di],ecx
  1016                                  			fill_cont
    74 00000877 5F                  <1>  pop di
    75 00000878 5D                  <1>  pop bp
    76                              <1> 
    77 00000879 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 0000087D 83C508              <1>  add bp,8
    80 00000880 83C702              <1>  add di,2
    81 00000883 FECA                <1>  dec dl
    82 00000885 0F85E0FD            <1>  jnz Fill.plotloop
  1017 00000889 C3                      			ret
  1018                                  
  1019                                  Fill028:left_edge
  1019                              <1> Fill028:
    54 0000088A C1E302              <1>  shl bx,2
    55 0000088D 26668B0D            <1>  mov ecx,[es:di]
    56 00000891 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 00000896 6689C6              <1>  mov esi,eax
    58 00000899 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 0000089E 6609F1              <1>  or ecx,esi
    60 000008A1 2666890D            <1>  mov [es:di],ecx
  1020 000008A5 83C704                  			add		di,4
  1021 000008A8 B90600                  			mov		cx,6
  1022 000008AB F366AB                  			rep		stosd
  1023                                  			right_edge
    64 000008AE C1E502              <1>  shl bp,2
    65 000008B1 26668B0D            <1>  mov ecx,[es:di]
    66 000008B5 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 000008BA 6689C6              <1>  mov esi,eax
    68 000008BD 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 000008C2 6609F1              <1>  or ecx,esi
    70 000008C5 2666890D            <1>  mov [es:di],ecx
  1024                                  			fill_cont
    74 000008C9 5F                  <1>  pop di
    75 000008CA 5D                  <1>  pop bp
    76                              <1> 
    77 000008CB 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 000008CF 83C508              <1>  add bp,8
    80 000008D2 83C702              <1>  add di,2
    81 000008D5 FECA                <1>  dec dl
    82 000008D7 0F858EFD            <1>  jnz Fill.plotloop
  1025 000008DB C3                      			ret
  1026                                  
  1027                                  Fill032:	left_edge
  1027                              <1> Fill032: 
    54 000008DC C1E302              <1>  shl bx,2
    55 000008DF 26668B0D            <1>  mov ecx,[es:di]
    56 000008E3 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 000008E8 6689C6              <1>  mov esi,eax
    58 000008EB 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 000008F0 6609F1              <1>  or ecx,esi
    60 000008F3 2666890D            <1>  mov [es:di],ecx
  1028 000008F7 83C704                  			add		di,4
  1029 000008FA B90700                  			mov		cx,7
  1030 000008FD F366AB                  			rep		stosd
  1031                                  			right_edge
    64 00000900 C1E502              <1>  shl bp,2
    65 00000903 26668B0D            <1>  mov ecx,[es:di]
    66 00000907 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 0000090C 6689C6              <1>  mov esi,eax
    68 0000090F 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 00000914 6609F1              <1>  or ecx,esi
    70 00000917 2666890D            <1>  mov [es:di],ecx
  1032                                  			fill_cont
    74 0000091B 5F                  <1>  pop di
    75 0000091C 5D                  <1>  pop bp
    76                              <1> 
    77 0000091D 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 00000921 83C508              <1>  add bp,8
    80 00000924 83C702              <1>  add di,2
    81 00000927 FECA                <1>  dec dl
    82 00000929 0F853CFD            <1>  jnz Fill.plotloop
  1033 0000092D C3                      			ret
  1034                                  
  1035                                  Fill036:	left_edge
  1035                              <1> Fill036: 
    54 0000092E C1E302              <1>  shl bx,2
    55 00000931 26668B0D            <1>  mov ecx,[es:di]
    56 00000935 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 0000093A 6689C6              <1>  mov esi,eax
    58 0000093D 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 00000942 6609F1              <1>  or ecx,esi
    60 00000945 2666890D            <1>  mov [es:di],ecx
  1036 00000949 83C704                  			add		di,4
  1037 0000094C B90800                  			mov		cx,8
  1038 0000094F F366AB                  			rep		stosd
  1039                                  			right_edge
    64 00000952 C1E502              <1>  shl bp,2
    65 00000955 26668B0D            <1>  mov ecx,[es:di]
    66 00000959 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 0000095E 6689C6              <1>  mov esi,eax
    68 00000961 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 00000966 6609F1              <1>  or ecx,esi
    70 00000969 2666890D            <1>  mov [es:di],ecx
  1040                                  			fill_cont
    74 0000096D 5F                  <1>  pop di
    75 0000096E 5D                  <1>  pop bp
    76                              <1> 
    77 0000096F 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 00000973 83C508              <1>  add bp,8
    80 00000976 83C702              <1>  add di,2
    81 00000979 FECA                <1>  dec dl
    82 0000097B 0F85EAFC            <1>  jnz Fill.plotloop
  1041 0000097F C3                      			ret
  1042                                  
  1043                                  Fill040:	left_edge
  1043                              <1> Fill040: 
    54 00000980 C1E302              <1>  shl bx,2
    55 00000983 26668B0D            <1>  mov ecx,[es:di]
    56 00000987 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 0000098C 6689C6              <1>  mov esi,eax
    58 0000098F 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 00000994 6609F1              <1>  or ecx,esi
    60 00000997 2666890D            <1>  mov [es:di],ecx
  1044 0000099B 83C704                  			add		di,4
  1045 0000099E B90900                  			mov		cx,9
  1046 000009A1 F366AB                  			rep		stosd
  1047                                  			right_edge
    64 000009A4 C1E502              <1>  shl bp,2
    65 000009A7 26668B0D            <1>  mov ecx,[es:di]
    66 000009AB 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 000009B0 6689C6              <1>  mov esi,eax
    68 000009B3 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 000009B8 6609F1              <1>  or ecx,esi
    70 000009BB 2666890D            <1>  mov [es:di],ecx
  1048                                  			fill_cont
    74 000009BF 5F                  <1>  pop di
    75 000009C0 5D                  <1>  pop bp
    76                              <1> 
    77 000009C1 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 000009C5 83C508              <1>  add bp,8
    80 000009C8 83C702              <1>  add di,2
    81 000009CB FECA                <1>  dec dl
    82 000009CD 0F8598FC            <1>  jnz Fill.plotloop
  1049 000009D1 C3                      			ret
  1050                                  
  1051                                  Fill044:	left_edge
  1051                              <1> Fill044: 
    54 000009D2 C1E302              <1>  shl bx,2
    55 000009D5 26668B0D            <1>  mov ecx,[es:di]
    56 000009D9 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 000009DE 6689C6              <1>  mov esi,eax
    58 000009E1 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 000009E6 6609F1              <1>  or ecx,esi
    60 000009E9 2666890D            <1>  mov [es:di],ecx
  1052 000009ED 83C704                  			add		di,4
  1053 000009F0 B90A00                  			mov		cx,10
  1054 000009F3 F366AB                  			rep		stosd
  1055                                  			right_edge
    64 000009F6 C1E502              <1>  shl bp,2
    65 000009F9 26668B0D            <1>  mov ecx,[es:di]
    66 000009FD 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 00000A02 6689C6              <1>  mov esi,eax
    68 00000A05 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 00000A0A 6609F1              <1>  or ecx,esi
    70 00000A0D 2666890D            <1>  mov [es:di],ecx
  1056                                  			fill_cont
    74 00000A11 5F                  <1>  pop di
    75 00000A12 5D                  <1>  pop bp
    76                              <1> 
    77 00000A13 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 00000A17 83C508              <1>  add bp,8
    80 00000A1A 83C702              <1>  add di,2
    81 00000A1D FECA                <1>  dec dl
    82 00000A1F 0F8546FC            <1>  jnz Fill.plotloop
  1057 00000A23 C3                      			ret
  1058                                  
  1059                                  Fill048:	left_edge
  1059                              <1> Fill048: 
    54 00000A24 C1E302              <1>  shl bx,2
    55 00000A27 26668B0D            <1>  mov ecx,[es:di]
    56 00000A2B 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 00000A30 6689C6              <1>  mov esi,eax
    58 00000A33 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 00000A38 6609F1              <1>  or ecx,esi
    60 00000A3B 2666890D            <1>  mov [es:di],ecx
  1060 00000A3F 83C704                  			add		di,4
  1061 00000A42 B90B00                  			mov		cx,11
  1062 00000A45 F366AB                  			rep		stosd
  1063                                  			right_edge
    64 00000A48 C1E502              <1>  shl bp,2
    65 00000A4B 26668B0D            <1>  mov ecx,[es:di]
    66 00000A4F 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 00000A54 6689C6              <1>  mov esi,eax
    68 00000A57 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 00000A5C 6609F1              <1>  or ecx,esi
    70 00000A5F 2666890D            <1>  mov [es:di],ecx
  1064                                  			fill_cont
    74 00000A63 5F                  <1>  pop di
    75 00000A64 5D                  <1>  pop bp
    76                              <1> 
    77 00000A65 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 00000A69 83C508              <1>  add bp,8
    80 00000A6C 83C702              <1>  add di,2
    81 00000A6F FECA                <1>  dec dl
    82 00000A71 0F85F4FB            <1>  jnz Fill.plotloop
  1065 00000A75 C3                      			ret
  1066                                  
  1067                                  Fill052:	left_edge
  1067                              <1> Fill052: 
    54 00000A76 C1E302              <1>  shl bx,2
    55 00000A79 26668B0D            <1>  mov ecx,[es:di]
    56 00000A7D 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 00000A82 6689C6              <1>  mov esi,eax
    58 00000A85 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 00000A8A 6609F1              <1>  or ecx,esi
    60 00000A8D 2666890D            <1>  mov [es:di],ecx
  1068 00000A91 83C704                  			add		di,4
  1069 00000A94 B90C00                  			mov		cx,12
  1070 00000A97 F366AB                  			rep		stosd
  1071                                  			right_edge
    64 00000A9A C1E502              <1>  shl bp,2
    65 00000A9D 26668B0D            <1>  mov ecx,[es:di]
    66 00000AA1 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 00000AA6 6689C6              <1>  mov esi,eax
    68 00000AA9 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 00000AAE 6609F1              <1>  or ecx,esi
    70 00000AB1 2666890D            <1>  mov [es:di],ecx
  1072                                  			fill_cont
    74 00000AB5 5F                  <1>  pop di
    75 00000AB6 5D                  <1>  pop bp
    76                              <1> 
    77 00000AB7 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 00000ABB 83C508              <1>  add bp,8
    80 00000ABE 83C702              <1>  add di,2
    81 00000AC1 FECA                <1>  dec dl
    82 00000AC3 0F85A2FB            <1>  jnz Fill.plotloop
  1073 00000AC7 C3                      			ret
  1074                                  
  1075                                  Fill056:	left_edge
  1075                              <1> Fill056: 
    54 00000AC8 C1E302              <1>  shl bx,2
    55 00000ACB 26668B0D            <1>  mov ecx,[es:di]
    56 00000ACF 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 00000AD4 6689C6              <1>  mov esi,eax
    58 00000AD7 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 00000ADC 6609F1              <1>  or ecx,esi
    60 00000ADF 2666890D            <1>  mov [es:di],ecx
  1076 00000AE3 83C704                  			add		di,4
  1077 00000AE6 B90D00                  			mov		cx,13
  1078 00000AE9 F366AB                  			rep		stosd
  1079                                  			right_edge
    64 00000AEC C1E502              <1>  shl bp,2
    65 00000AEF 26668B0D            <1>  mov ecx,[es:di]
    66 00000AF3 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 00000AF8 6689C6              <1>  mov esi,eax
    68 00000AFB 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 00000B00 6609F1              <1>  or ecx,esi
    70 00000B03 2666890D            <1>  mov [es:di],ecx
  1080                                  			fill_cont
    74 00000B07 5F                  <1>  pop di
    75 00000B08 5D                  <1>  pop bp
    76                              <1> 
    77 00000B09 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 00000B0D 83C508              <1>  add bp,8
    80 00000B10 83C702              <1>  add di,2
    81 00000B13 FECA                <1>  dec dl
    82 00000B15 0F8550FB            <1>  jnz Fill.plotloop
  1081 00000B19 C3                      			ret
  1082                                  
  1083                                  Fill060:	left_edge
  1083                              <1> Fill060: 
    54 00000B1A C1E302              <1>  shl bx,2
    55 00000B1D 26668B0D            <1>  mov ecx,[es:di]
    56 00000B21 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 00000B26 6689C6              <1>  mov esi,eax
    58 00000B29 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 00000B2E 6609F1              <1>  or ecx,esi
    60 00000B31 2666890D            <1>  mov [es:di],ecx
  1084 00000B35 83C704                  			add		di,4
  1085 00000B38 B90E00                  			mov		cx,14
  1086 00000B3B F366AB                  			rep		stosd
  1087                                  			right_edge
    64 00000B3E C1E502              <1>  shl bp,2
    65 00000B41 26668B0D            <1>  mov ecx,[es:di]
    66 00000B45 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 00000B4A 6689C6              <1>  mov esi,eax
    68 00000B4D 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 00000B52 6609F1              <1>  or ecx,esi
    70 00000B55 2666890D            <1>  mov [es:di],ecx
  1088                                  			fill_cont
    74 00000B59 5F                  <1>  pop di
    75 00000B5A 5D                  <1>  pop bp
    76                              <1> 
    77 00000B5B 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 00000B5F 83C508              <1>  add bp,8
    80 00000B62 83C702              <1>  add di,2
    81 00000B65 FECA                <1>  dec dl
    82 00000B67 0F85FEFA            <1>  jnz Fill.plotloop
  1089 00000B6B C3                      			ret
  1090                                  
  1091                                  Fill064:	left_edge
  1091                              <1> Fill064: 
    54 00000B6C C1E302              <1>  shl bx,2
    55 00000B6F 26668B0D            <1>  mov ecx,[es:di]
    56 00000B73 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 00000B78 6689C6              <1>  mov esi,eax
    58 00000B7B 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 00000B80 6609F1              <1>  or ecx,esi
    60 00000B83 2666890D            <1>  mov [es:di],ecx
  1092 00000B87 83C704                  			add		di,4
  1093 00000B8A B90F00                  			mov		cx,15
  1094 00000B8D F366AB                  			rep		stosd
  1095                                  			right_edge
    64 00000B90 C1E502              <1>  shl bp,2
    65 00000B93 26668B0D            <1>  mov ecx,[es:di]
    66 00000B97 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 00000B9C 6689C6              <1>  mov esi,eax
    68 00000B9F 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 00000BA4 6609F1              <1>  or ecx,esi
    70 00000BA7 2666890D            <1>  mov [es:di],ecx
  1096                                  			fill_cont
    74 00000BAB 5F                  <1>  pop di
    75 00000BAC 5D                  <1>  pop bp
    76                              <1> 
    77 00000BAD 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 00000BB1 83C508              <1>  add bp,8
    80 00000BB4 83C702              <1>  add di,2
    81 00000BB7 FECA                <1>  dec dl
    82 00000BB9 0F85ACFA            <1>  jnz Fill.plotloop
  1097 00000BBD C3                      			ret
  1098                                  
  1099                                  Fill068:	left_edge
  1099                              <1> Fill068: 
    54 00000BBE C1E302              <1>  shl bx,2
    55 00000BC1 26668B0D            <1>  mov ecx,[es:di]
    56 00000BC5 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 00000BCA 6689C6              <1>  mov esi,eax
    58 00000BCD 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 00000BD2 6609F1              <1>  or ecx,esi
    60 00000BD5 2666890D            <1>  mov [es:di],ecx
  1100 00000BD9 83C704                  			add		di,4
  1101 00000BDC B91000                  			mov		cx,16
  1102 00000BDF F366AB                  			rep		stosd
  1103                                  			right_edge
    64 00000BE2 C1E502              <1>  shl bp,2
    65 00000BE5 26668B0D            <1>  mov ecx,[es:di]
    66 00000BE9 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 00000BEE 6689C6              <1>  mov esi,eax
    68 00000BF1 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 00000BF6 6609F1              <1>  or ecx,esi
    70 00000BF9 2666890D            <1>  mov [es:di],ecx
  1104                                  			fill_cont
    74 00000BFD 5F                  <1>  pop di
    75 00000BFE 5D                  <1>  pop bp
    76                              <1> 
    77 00000BFF 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 00000C03 83C508              <1>  add bp,8
    80 00000C06 83C702              <1>  add di,2
    81 00000C09 FECA                <1>  dec dl
    82 00000C0B 0F855AFA            <1>  jnz Fill.plotloop
  1105 00000C0F C3                      			ret
  1106                                  
  1107                                  Fill072:	left_edge
  1107                              <1> Fill072: 
    54 00000C10 C1E302              <1>  shl bx,2
    55 00000C13 26668B0D            <1>  mov ecx,[es:di]
    56 00000C17 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 00000C1C 6689C6              <1>  mov esi,eax
    58 00000C1F 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 00000C24 6609F1              <1>  or ecx,esi
    60 00000C27 2666890D            <1>  mov [es:di],ecx
  1108 00000C2B 83C704                  			add		di,4
  1109 00000C2E B91100                  			mov		cx,17
  1110 00000C31 F366AB                  			rep		stosd
  1111                                  			right_edge
    64 00000C34 C1E502              <1>  shl bp,2
    65 00000C37 26668B0D            <1>  mov ecx,[es:di]
    66 00000C3B 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 00000C40 6689C6              <1>  mov esi,eax
    68 00000C43 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 00000C48 6609F1              <1>  or ecx,esi
    70 00000C4B 2666890D            <1>  mov [es:di],ecx
  1112                                  			fill_cont
    74 00000C4F 5F                  <1>  pop di
    75 00000C50 5D                  <1>  pop bp
    76                              <1> 
    77 00000C51 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 00000C55 83C508              <1>  add bp,8
    80 00000C58 83C702              <1>  add di,2
    81 00000C5B FECA                <1>  dec dl
    82 00000C5D 0F8508FA            <1>  jnz Fill.plotloop
  1113 00000C61 C3                      			ret
  1114                                  
  1115                                  Fill076:	left_edge
  1115                              <1> Fill076: 
    54 00000C62 C1E302              <1>  shl bx,2
    55 00000C65 26668B0D            <1>  mov ecx,[es:di]
    56 00000C69 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 00000C6E 6689C6              <1>  mov esi,eax
    58 00000C71 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 00000C76 6609F1              <1>  or ecx,esi
    60 00000C79 2666890D            <1>  mov [es:di],ecx
  1116 00000C7D 83C704                  			add		di,4
  1117 00000C80 B91200                  			mov		cx,18
  1118 00000C83 F366AB                  			rep		stosd
  1119                                  			right_edge
    64 00000C86 C1E502              <1>  shl bp,2
    65 00000C89 26668B0D            <1>  mov ecx,[es:di]
    66 00000C8D 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 00000C92 6689C6              <1>  mov esi,eax
    68 00000C95 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 00000C9A 6609F1              <1>  or ecx,esi
    70 00000C9D 2666890D            <1>  mov [es:di],ecx
  1120                                  			fill_cont
    74 00000CA1 5F                  <1>  pop di
    75 00000CA2 5D                  <1>  pop bp
    76                              <1> 
    77 00000CA3 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 00000CA7 83C508              <1>  add bp,8
    80 00000CAA 83C702              <1>  add di,2
    81 00000CAD FECA                <1>  dec dl
    82 00000CAF 0F85B6F9            <1>  jnz Fill.plotloop
  1121 00000CB3 C3                      			ret
  1122                                  
  1123                                  Fill080:	left_edge
  1123                              <1> Fill080: 
    54 00000CB4 C1E302              <1>  shl bx,2
    55 00000CB7 26668B0D            <1>  mov ecx,[es:di]
    56 00000CBB 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 00000CC0 6689C6              <1>  mov esi,eax
    58 00000CC3 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 00000CC8 6609F1              <1>  or ecx,esi
    60 00000CCB 2666890D            <1>  mov [es:di],ecx
  1124 00000CCF 83C704                  			add		di,4
  1125 00000CD2 B91300                  			mov		cx,19
  1126 00000CD5 F366AB                  			rep		stosd
  1127                                  			right_edge
    64 00000CD8 C1E502              <1>  shl bp,2
    65 00000CDB 26668B0D            <1>  mov ecx,[es:di]
    66 00000CDF 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 00000CE4 6689C6              <1>  mov esi,eax
    68 00000CE7 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 00000CEC 6609F1              <1>  or ecx,esi
    70 00000CEF 2666890D            <1>  mov [es:di],ecx
  1128                                  			fill_cont
    74 00000CF3 5F                  <1>  pop di
    75 00000CF4 5D                  <1>  pop bp
    76                              <1> 
    77 00000CF5 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 00000CF9 83C508              <1>  add bp,8
    80 00000CFC 83C702              <1>  add di,2
    81 00000CFF FECA                <1>  dec dl
    82 00000D01 0F8564F9            <1>  jnz Fill.plotloop
  1129 00000D05 C3                      			ret
  1130                                  
  1131                                  Fill084:	left_edge
  1131                              <1> Fill084: 
    54 00000D06 C1E302              <1>  shl bx,2
    55 00000D09 26668B0D            <1>  mov ecx,[es:di]
    56 00000D0D 66238F[801B]        <1>  and ecx,[FillLeftTab32V2+bx]
    57 00000D12 6689C6              <1>  mov esi,eax
    58 00000D15 6623B7[8011]        <1>  and esi,[FillLeftTab32+bx]
    59 00000D1A 6609F1              <1>  or ecx,esi
    60 00000D1D 2666890D            <1>  mov [es:di],ecx
  1132 00000D21 83C704                  			add		di,4
  1133 00000D24 B91400                  			mov		cx,20
  1134 00000D27 F366AB                  			rep		stosd
  1135                                  			right_edge
    64 00000D2A C1E502              <1>  shl bp,2
    65 00000D2D 26668B0D            <1>  mov ecx,[es:di]
    66 00000D31 66238E[8020]        <1>  and ecx,[FillRightTab32V2+bp]
    67 00000D36 6689C6              <1>  mov esi,eax
    68 00000D39 6623B6[8016]        <1>  and esi,[FillRightTab32+bp]
    69 00000D3E 6609F1              <1>  or ecx,esi
    70 00000D41 2666890D            <1>  mov [es:di],ecx
  1136                                  			fill_cont
    74 00000D45 5F                  <1>  pop di
    75 00000D46 5D                  <1>  pop bp
    76                              <1> 
    77 00000D47 66C1C802            <1>  ror eax,2
    78                              <1> 
    79 00000D4B 83C508              <1>  add bp,8
    80 00000D4E 83C702              <1>  add di,2
    81 00000D51 FECA                <1>  dec dl
    82 00000D53 0F8512F9            <1>  jnz Fill.plotloop
  1137 00000D57 C3                      			ret
  1138                                  
  1139                                  ; classify3d
  1140                                  ;  get z
  1141                                  ;  if minus
  1142                                  ;   classify eq 16
  1143                                  ;  else
  1144                                  ;   do perspective
  1145                                  ;    classify eq 0
  1146                                  ;    if x lt 32767-100
  1147                                  ;     classify eq 1
  1148                                  ;    if x gt 32767+100
  1149                                  ;    classify eq 2
  1150                                  ;   if y lt 32767-160
  1151                                  ;    classify +=4
  1152                                  ;   if y gt 32767+160
  1153                                  ;    classify +=8
  1154                                  	
  1155 00000D58 57                      DrawObject2:		push	di ; object lines
  1156 00000D59 51                      				push	cx ; number of lines
  1157                                  
  1158                                  ;				mov		di,ObjectPointsResults
  1159                                  
  1160 00000D5A 30ED                    				xor		ch,ch
  1161 00000D5C FEC9                    				dec		cl
  1162 00000D5E 00C9                    				add		cl,cl
  1163 00000D60 89CF                    				mov		di,cx	; point count
  1164                                  		
  1165 00000D62 BBFF00                  				mov		bx,255 ; high = or clip codes / low = and clip codes
  1166                                  	
  1167 00000D65 53                      .rotate_point_loop:	push	bx
  1168 00000D66 3E8B0C                  					mov		cx,[ds:si]	; xpos
  1169 00000D69 3E8B4402                					mov		ax,[ds:si+2]	; ypos
  1170 00000D6D 3E8B6C04                					mov		bp,[ds:si+4]	; zpos
  1171                                  		
  1172 00000D71 E89B04                  					call	Rotate
  1173                                  
  1174 00000D74 89C8                    					mov		ax,cx
  1175 00000D76 89E9                    					mov		cx,bp
  1176 00000D78 89DD                    					mov		bp,bx
  1177                                  		
  1178 00000D7A 0306[AA26]              					add		ax,[YOffset]
  1179 00000D7E 8985[1492]              					mov		[ObjectYRot+di],ax 		; yrot
  1180                                  
  1181 00000D82 032E[A826]              					add		bp,[XOffset]
  1182 00000D86 89AD[1491]              					mov		[ObjectXRot+di],bp 			; xrot
  1183                                  
  1184 00000D8A 030E[AC26]              					add		cx,[ZOffset]
  1185 00000D8E 898D[1493]              					mov		[ObjectZRot+di],cx 	; zrot
  1186                                  
  1187 00000D92 7904                    					jns		.point_in_front
  1188 00000D94 B210                    						mov		dl,BEHIND_CC
  1189 00000D96 EB0E                    						jmp		.point_behind	
  1190                                  
  1191 00000D98 E82805                  .point_in_front:	call	Perspective
  1192 00000D9B 8985[148E]              					mov		[ObjectYPos+di],ax 		; xpos
  1193 00000D9F 89AD[148F]              					mov		[ObjectXPos+di],bp 		; ypos
  1194 00000DA3 E8F804                  					call	ClassifyPoint
  1195                                  
  1196 00000DA6 8895[1490]              .point_behind:		mov		[ObjectClipCode+di],dl 	; clip code
  1197                                  
  1198 00000DAA 5B                      					pop		bx
  1199 00000DAB 20D3                    					and		bl,dl	; object and clip code
  1200 00000DAD 08D7                    					or		bh,dl	; object or clip code
  1201                                  		
  1202 00000DAF 83C606                  					add		si,6				
  1203 00000DB2 83EF02                  					sub		di,2
  1204 00000DB5 79AE                    					jns		.rotate_point_loop
  1205                                  
  1206 00000DB7 59                      				pop		cx 	; number of lines
  1207 00000DB8 5E                      				pop 	si 	; object lines
  1208                                  
  1209 00000DB9 80FB00                  				cmp		bl,0				; if and_object_clip_code ne 0 all off one side so exit
  1210 00000DBC 7530                    				jnz		.off_screen
  1211                                   
  1212 00000DBE 80FF00                  				cmp		bh,0				; if or_object_clip_code eq 0 all on screen so no clip needed
  1213 00000DC1 752C                    				jnz		.draw_clipped_object
  1214                                  
  1215                                  .draw_whole_object:
  1216 00000DC3 51                      .draw_whole_object_line_loop:	push	cx
  1217 00000DC4 56                      								push	si
  1218                                  
  1219 00000DC5 30FF                    								xor		bh,bh
  1220 00000DC7 3E8A1C                  								mov		bl,[ds:si]
  1221 00000DCA 00DB                    								add		bl,bl	
  1222 00000DCC 8B8F[148E]              								mov		cx,[ObjectYPos+bx] ; endy
  1223 00000DD0 8B97[148F]              								mov		dx,[ObjectXPos+bx] ; endx
  1224                                   
  1225 00000DD4 3E8A5C01                								mov		bl,[ds:si+1]
  1226 00000DD8 00DB                    								add		bl,bl
  1227 00000DDA 8BAF[148E]              								mov		bp,[ObjectYPos+bx] ; starty
  1228 00000DDE 8BB7[148F]              								mov		si,[ObjectXPos+bx] ; startx
  1229 00000DE2 E896F5                  								call	Line00
  1230                                  	 
  1231 00000DE5 5E                      								pop		si
  1232 00000DE6 59                      								pop		cx
  1233 00000DE7 83C602                  								add		si,2
  1234                                  
  1235 00000DEA FECD                    								dec		ch
  1236 00000DEC 75D5                    								jnz		.draw_whole_object_line_loop
  1237                                  
  1238 00000DEE C3                      .off_screen:				ret
  1239                                  	
  1240                                  .draw_clipped_object:	
  1241 00000DEF 30FF                    .draw_clipped_object_line_loop:	xor		bh,bh
  1242 00000DF1 51                      								push	cx
  1243 00000DF2 56                      								push	si
  1244                                  		
  1245 00000DF3 3E8A1C                  								mov		bl,[ds:si]
  1246 00000DF6 00DB                    								add		bl,bl
  1247 00000DF8 8A87[1490]              								mov		al,[ObjectClipCode+bx] 	; start clip code
  1248 00000DFC 3E8A5C01                								mov		bl,[ds:si+1]
  1249 00000E00 00DB                    								add		bl,bl
  1250 00000E02 8AA7[1490]              								mov		ah,[ObjectClipCode+bx] 	; end clip code
  1251                                  
  1252 00000E06 88C3                    								mov		bl,al		; backup start clip code
  1253 00000E08 20E3                    								and		bl,ah	; both points are off 
  1254 00000E0A 7522                    								jnz		.line_off_screen	; then line is off screen
  1255                                  
  1256 00000E0C 08E0                    								or		al,ah 	; if any point is off
  1257 00000E0E 7528                    								jnz		.line_clip	; then line needs clipped
  1258                                  		
  1259 00000E10 3E8A1C                  								mov		bl,[ds:si]
  1260 00000E13 00DB                    								add		bl,bl	
  1261 00000E15 8B8F[148E]              								mov		cx,[ObjectYPos+bx] ; starty
  1262 00000E19 8B97[148F]              								mov		dx,[ObjectXPos+bx] ; startx
  1263                                  
  1264 00000E1D 3E8A5C01                								mov		bl,[ds:si+1]
  1265 00000E21 00DB                    								add		bl,bl
  1266 00000E23 8BAF[148E]              								mov		bp,[ObjectYPos+bx] ; endy 
  1267 00000E27 8BB7[148F]              								mov		si,[ObjectXPos+bx] ; endx - todo - si is the problem?
  1268                                  
  1269 00000E2B E879F4                  .draw_clipped_line:				call	Line11
  1270                                  
  1271 00000E2E 5E                      .line_off_screen:				pop		si
  1272 00000E2F 59                      								pop		cx
  1273 00000E30 83C602                  								add		si,2
  1274                                  		
  1275 00000E33 FECD                    								dec		ch
  1276 00000E35 75B8                    								jnz		.draw_clipped_object_line_loop
  1277 00000E37 C3                      							ret
  1278                                  
  1279                                  .line_clip:	; al = point 1 clip ; ah = point 2 clip
  1280                                  
  1281                                  ; copy point details to 2 sets of coords temp coords zyx and temp perspective xy
  1282                                  ; if either point is behind
  1283                                  ;  do z clip on required point
  1284                                  ;  do perspective
  1285                                  ;  do rest of tests
  1286                                  
  1287 00000E38 30FF                    					xor		bh,bh
  1288 00000E3A 3E8A1C                  					mov		bl,[ds:si]
  1289 00000E3D 00DB                    					add		bl,bl	
  1290 00000E3F 8B97[1491]              					mov		dx,[ObjectXRot+bx]
  1291 00000E43 8916[3194]              					mov		[STX],dx
  1292 00000E47 8B97[1492]              					mov		dx,[ObjectYRot+bx]
  1293 00000E4B 8916[3394]              					mov		[STY],dx
  1294 00000E4F 8B97[1493]              					mov		dx,[ObjectZRot+bx]
  1295 00000E53 8916[3594]              					mov		[STZ],dx
  1296 00000E57 8B97[148F]              					mov		dx,[ObjectXPos+bx]
  1297 00000E5B 8916[2094]              					mov		[XST],dx
  1298 00000E5F 8B97[148E]              					mov		dx,[ObjectYPos+bx]	
  1299 00000E63 8916[2294]              					mov		[YST],dx	
  1300 00000E67 8A87[1490]              					mov		al,[ObjectClipCode+bx]
  1301                                  	
  1302 00000E6B 3E8A5C01                					mov		bl,[ds:si+1]
  1303 00000E6F 00DB                    					add		bl,bl
  1304 00000E71 8B97[1491]              					mov		dx,[ObjectXRot+bx]
  1305 00000E75 8916[3794]              					mov		[ENX],dx
  1306 00000E79 8B97[1492]              					mov		dx,[ObjectYRot+bx]
  1307 00000E7D 8916[3994]              					mov		[ENY],dx
  1308 00000E81 8B97[1493]              					mov		dx,[ObjectZRot+bx]
  1309 00000E85 8916[3B94]              					mov		[ENZ],dx	
  1310 00000E89 8B97[148F]              					mov		dx,[ObjectXPos+bx]
  1311 00000E8D 8916[2494]              					mov		[XEN],dx
  1312 00000E91 8B97[148E]              					mov		dx,[ObjectYPos+bx]
  1313 00000E95 8916[2694]              					mov		[YEN],dx
  1314 00000E99 8AA7[1490]              					mov		ah,[ObjectClipCode+bx]
  1315                                  
  1316 00000E9D A3[2894]                					mov		[CCST],ax
  1317                                  	
  1318 00000EA0 A1[2894]                .line_clip_loop:	mov		ax,[CCST]
  1319 00000EA3 88C3                    					mov		bl,al			; start cc
  1320 00000EA5 20E0                    					and		al,ah			; and with end cc
  1321 00000EA7 7585                    					jnz		.line_off_screen		; both off same side
  1322                                  	
  1323 00000EA9 08E3                    					or		bl,ah			; or with end cc
  1324 00000EAB 746F                    					jz		.clip_draw_test		; all on so draw line
  1325                                  
  1326 00000EAD F6C310                  .clip_behind_test:	test	bl,BEHIND_CC	; test if either point is off (al=al or ah)
  1327 00000EB0 7412                    					jz		.clip_left_test
  1328 00000EB2 E87A00                  					call	LineClipBehind
  1329                                  
  1330 00000EB5 A1[2894]                					mov		ax,[CCST]
  1331 00000EB8 88C3                    					mov		bl,al			; start cc
  1332 00000EBA 20E0                    					and		al,ah			; and with end cc
  1333 00000EBC 0F856EFF                					jnz		.line_off_screen		; both off same side
  1334                                  
  1335 00000EC0 08E3                    					or		bl,ah			; or with end cc
  1336 00000EC2 7458                    					jz		.clip_draw_test		; all on so draw line
  1337                                  	
  1338 00000EC4 F6C304                  .clip_left_test:	test	bl,LEFT_CC
  1339 00000EC7 7412                    					jz		.clip_right_test
  1340 00000EC9 E83D01                  					call	LineClipLeft
  1341 00000ECC A1[2894]                					mov		ax,[CCST]
  1342 00000ECF 88C3                    					mov		bl,al			; start cc
  1343 00000ED1 20E0                    					and		al,ah			; and with end cc
  1344 00000ED3 0F8557FF                					jnz		.line_off_screen		; both off same side
  1345                                  
  1346 00000ED7 08E3                    					or		bl,ah			; or with end cc
  1347 00000ED9 7441                    					jz		.clip_draw_test		; all on so draw line
  1348                                  		
  1349 00000EDB F6C308                  .clip_right_test:	test	bl,RIGHT_CC
  1350 00000EDE 7412                    					jz		.clip_top_test
  1351 00000EE0 E88301                  					call	LineClipRight
  1352 00000EE3 A1[2894]                					mov		ax,[CCST]
  1353 00000EE6 88C3                    					mov		bl,al			; start cc
  1354 00000EE8 20E0                    					and		al,ah			; and with end cc
  1355 00000EEA 0F8540FF                					jnz		.line_off_screen		; both off same side
  1356                                  	
  1357 00000EEE 08E3                    					or		bl,ah			; or with end cc
  1358 00000EF0 742A                    					jz		.clip_draw_test		; all on so draw line
  1359                                  		
  1360                                  
  1361 00000EF2 F6C301                  .clip_top_test:		test	bl,TOP_CC
  1362 00000EF5 7412                    					jz		.clip_bottom_test
  1363 00000EF7 E8B200                  					call	LineClipTop
  1364 00000EFA A1[2894]                					mov		ax,[CCST]
  1365 00000EFD 88C3                    					mov		bl,al			; start cc
  1366 00000EFF 20E0                    					and		al,ah			; and with end cc
  1367 00000F01 0F8529FF                					jnz		.line_off_screen		; both off same side
  1368                                  
  1369 00000F05 08E3                    					or		bl,ah			; or with end cc
  1370 00000F07 7413                    					jz		.clip_draw_test		; all on so draw line
  1371                                  
  1372 00000F09 F6C302                  .clip_bottom_test:	test	bl,BOTTOM_CC
  1373 00000F0C 7492                    					jz		.line_clip_loop
  1374 00000F0E E8B401                  					call	LineClipBottom
  1375 00000F11 A1[2894]                					mov		ax,[CCST]
  1376 00000F14 88C3                    					mov		bl,al			; start cc
  1377 00000F16 20E0                    					and		al,ah			; and with end cc
  1378 00000F18 0F8512FF                					jnz		.line_off_screen		; both off same side
  1379                                  
  1380 00000F1C 8B0E[2294]              .clip_draw_test:	mov		cx,[YST]
  1381 00000F20 8B16[2094]              					mov		dx,[XST]
  1382 00000F24 8B2E[2694]              					mov		bp,[YEN]
  1383 00000F28 8B36[2494]              					mov		si,[XEN]
  1384 00000F2C E9FCFE                  					jmp		.draw_clipped_line
  1385                                  	
  1386 00000F2F F6C410                  LineClipBehind:	test	ah,BEHIND_CC
  1387 00000F32 743C                    				jz		.behind_sback_efront
  1388 00000F34 A1[3194]                .behind_sfront_eback:	mov		ax,[STX]
  1389 00000F37 8B0E[3594]              						mov		cx,[STZ]
  1390 00000F3B 8B3E[3B94]              						mov		di,[ENZ]
  1391 00000F3F 8B1E[3794]              						mov		bx,[ENX]
  1392 00000F43 E8DC01                  						call	ClipBehind
  1393 00000F46 57                      						push	di
  1394                                  	
  1395 00000F47 A1[3394]                						mov		ax,[STY]
  1396 00000F4A 8B0E[3594]              						mov		cx,[STZ]
  1397 00000F4E 8B3E[3B94]              						mov		di,[ENZ]
  1398 00000F52 8B1E[3994]              						mov		bx,[ENY]
  1399 00000F56 E8C901                  						call	ClipBehind
  1400                                  
  1401 00000F59 89F8                    						mov		ax,di
  1402 00000F5B 5D                      						pop		bp
  1403                                  
  1404 00000F5C 31C9                    						xor		cx,cx
  1405 00000F5E E86203                  						call	Perspective
  1406 00000F61 A3[2694]                						mov		[YEN],ax 
  1407 00000F64 892E[2494]              						mov		[XEN],bp
  1408 00000F68 E83303                  						call	ClassifyPoint
  1409 00000F6B 8816[2994]              						mov		[CCEN],dl
  1410 00000F6F C3                      						ret
  1411 00000F70 A1[3794]                .behind_sback_efront:	mov		ax,[ENX]
  1412 00000F73 8B0E[3B94]              						mov		cx,[ENZ]
  1413 00000F77 8B3E[3594]              						mov		di,[STZ]
  1414 00000F7B 8B1E[3194]              						mov		bx,[STX]
  1415 00000F7F E8A001                  						call	ClipBehind
  1416 00000F82 57                      						push	di
  1417                                  	
  1418 00000F83 A1[3994]                						mov		ax,[ENY]
  1419 00000F86 8B0E[3B94]              						mov		cx,[ENZ]
  1420 00000F8A 8B3E[3594]              						mov		di,[STZ]
  1421 00000F8E 8B1E[3394]              						mov		bx,[STY]
  1422 00000F92 E88D01                  						call	ClipBehind
  1423                                  
  1424 00000F95 89F8                    						mov		ax,di
  1425 00000F97 5D                      						pop		bp
  1426                                  		
  1427 00000F98 31C9                    						xor		cx,cx
  1428 00000F9A E82603                  						call	Perspective
  1429 00000F9D A3[2294]                						mov		[YST],ax 
  1430 00000FA0 892E[2094]              						mov		[XST],bp 
  1431 00000FA4 E8F702                  						call	ClassifyPoint
  1432 00000FA7 8816[2894]              						mov		[CCST],dl
  1433 00000FAB C3                      						ret
  1434                                  	
  1435 00000FAC F6C401                  LineClipTop:	test	ah,TOP_CC
  1436 00000FAF 742C                    				jz		.top_p1on_p2off
  1437 00000FB1 A1[2294]                .top_p1off_p2on:	mov		ax,[YST]
  1438 00000FB4 8B0E[2094]              					mov		cx,[XST]
  1439 00000FB8 8B3E[2494]              					mov		di,[XEN]
  1440 00000FBC 8B1E[2694]              					mov		bx,[YEN]
  1441 00000FC0 E86E01                  					call	ClipTop
  1442                                  
  1443 00000FC3 893E[2694]              					mov		[YEN],di
  1444 00000FC7 BB0000                  					mov		bx,TOP_EDGE
  1445 00000FCA 891E[2494]              					mov		[XEN],bx
  1446                                  
  1447 00000FCE A1[2694]                					mov		ax,[YEN]
  1448 00000FD1 8B2E[2494]              					mov		bp,[XEN]
  1449 00000FD5 E8C602                  					call	ClassifyPoint
  1450 00000FD8 8816[2994]              					mov		[CCEN],dl
  1451 00000FDC C3                      					ret
  1452 00000FDD A1[2694]                .top_p1on_p2off:	mov		ax,[YEN]
  1453 00000FE0 8B0E[2494]              					mov		cx,[XEN]
  1454 00000FE4 8B3E[2094]              					mov		di,[XST]
  1455 00000FE8 8B1E[2294]              					mov		bx,[YST]
  1456 00000FEC E84201                  					call	ClipTop
  1457                                  
  1458 00000FEF 893E[2294]              					mov		[YST],di
  1459 00000FF3 BB0000                  					mov		bx,TOP_EDGE
  1460 00000FF6 891E[2094]              					mov		[XST],bx
  1461                                  
  1462 00000FFA A1[2294]                					mov		ax,[YST]
  1463 00000FFD 8B2E[2094]              					mov		bp,[XST]
  1464 00001001 E89A02                  					call	ClassifyPoint
  1465 00001004 8816[2894]              					mov		[CCST],dl
  1466 00001008 C3                      					ret
  1467                                  	
  1468 00001009 F6C404                  LineClipLeft:	test	ah,LEFT_CC	; end clip code is off left?
  1469 0000100C 742C                    				jz		.left_p1on_p2off
  1470 0000100E 8B0E[2294]              .left_p1off_p2on:	mov		cx,[YST]
  1471 00001012 A1[2094]                					mov		ax,[XST]
  1472 00001015 8B3E[2494]              					mov		di,[XEN]
  1473 00001019 8B1E[2694]              					mov		bx,[YEN]	
  1474 0000101D E82001                  					call	ClipLeft 	; ax returned 
  1475                                  	
  1476 00001020 891E[2494]              					mov		[XEN],bx
  1477 00001024 BB0000                  					mov		bx,LEFT_EDGE
  1478 00001027 891E[2694]              					mov		[YEN],bx
  1479                                  		
  1480 0000102B A1[2694]                					mov		ax,[YEN]
  1481 0000102E 8B2E[2494]              					mov		bp,[XEN]
  1482 00001032 E86902                  					call	ClassifyPoint
  1483 00001035 8816[2994]              					mov		[CCEN],dl
  1484 00001039 C3                      					ret
  1485 0000103A 8B0E[2694]              .left_p1on_p2off:	mov		cx,[YEN]
  1486 0000103E A1[2494]                					mov		ax,[XEN]
  1487 00001041 8B3E[2094]              					mov		di,[XST]
  1488 00001045 8B1E[2294]              					mov		bx,[YST]
  1489 00001049 E8F400                  					call	ClipLeft
  1490                                  
  1491 0000104C 891E[2094]              					mov		[XST],bx
  1492 00001050 BB0000                  					mov		bx,LEFT_EDGE
  1493 00001053 891E[2294]              					mov		[YST],bx
  1494                                  
  1495 00001057 A1[2294]                					mov		ax,[YST]
  1496 0000105A 8B2E[2094]              					mov		bp,[XST]
  1497 0000105E E83D02                  					call	ClassifyPoint
  1498 00001061 8816[2894]              					mov		[CCST],dl
  1499 00001065 C3                      					ret
  1500                                  
  1501 00001066 F6C408                  LineClipRight:	test	ah,RIGHT_CC
  1502 00001069 742D                    				jz		.right_p1on_p2off
  1503 0000106B 8B2E[2294]              .right_p1off_p2on:	mov		bp,[YST]
  1504 0000106F 8B16[2094]              					mov		dx,[XST]
  1505 00001073 8B3E[2494]              					mov		di,[XEN]
  1506 00001077 8B1E[2694]              					mov		bx,[YEN]	
  1507 0000107B E8E300                  					call	ClipRight
  1508                                  
  1509 0000107E 892E[2494]              					mov		[XEN],bp
  1510 00001082 BB3F01                  					mov		bx,RIGHT_EDGE
  1511 00001085 891E[2694]              					mov		[YEN],bx
  1512                                  	
  1513 00001089 A1[2694]                					mov		ax,[YEN]
  1514 0000108C 8B2E[2494]              					mov		bp,[XEN]
  1515 00001090 E80B02                  					call	ClassifyPoint
  1516 00001093 8816[2994]              					mov		[CCEN],dl		
  1517 00001097 C3                      					ret
  1518                                  
  1519 00001098 8B2E[2694]              .right_p1on_p2off:	mov		bp,[YEN]
  1520 0000109C 8B16[2494]              					mov		dx,[XEN]
  1521 000010A0 8B3E[2094]              					mov		di,[XST]
  1522 000010A4 8B1E[2294]              					mov		bx,[YST]	
  1523 000010A8 E8B600                  					call	ClipRight
  1524                                  
  1525 000010AB 892E[2094]              					mov		[XST],bp
  1526 000010AF BB3F01                  					mov		bx,RIGHT_EDGE
  1527 000010B2 891E[2294]              					mov		[YST],bx
  1528                                  
  1529 000010B6 A1[2294]                					mov		ax,[YST]
  1530 000010B9 8B2E[2094]              					mov		bp,[XST]
  1531 000010BD E8DE01                  					call	ClassifyPoint
  1532 000010C0 8816[2894]              					mov		[CCST],dl
  1533 000010C4 C3                      					ret
  1534                                  	
  1535 000010C5 F6C402                  LineClipBottom:	test	ah,BOTTOM_CC
  1536 000010C8 742C                    				jz		.bottom_p1on_p2off
  1537 000010CA A1[2294]                .bottom_p1off_p2on:	mov		ax,[YST]
  1538 000010CD 8B16[2094]              					mov		dx,[XST]
  1539 000010D1 8B3E[2494]              					mov		di,[XEN]
  1540 000010D5 8B1E[2694]              					mov		bx,[YEN]	
  1541 000010D9 E87300                  					call	ClipBottom
  1542                                  
  1543 000010DC 890E[2694]              					mov		[YEN],cx
  1544 000010E0 BBC700                  					mov		bx,BOTTOM_EDGE
  1545 000010E3 891E[2494]              					mov		[XEN],bx
  1546                                  
  1547 000010E7 A1[2694]                					mov		ax,[YEN]
  1548 000010EA 8B2E[2494]              					mov		bp,[XEN]
  1549 000010EE E8AD01                  					call	ClassifyPoint
  1550 000010F1 8816[2994]              					mov		[CCEN],dl		
  1551 000010F5 C3                      					ret
  1552 000010F6 A1[2694]                .bottom_p1on_p2off:	mov		ax,[YEN]
  1553 000010F9 8B16[2494]              					mov		dx,[XEN]
  1554 000010FD 8B3E[2094]              					mov		di,[XST]
  1555 00001101 8B1E[2294]              					mov		bx,[YST]	
  1556 00001105 E84700                  					call	ClipBottom
  1557                                  
  1558 00001108 890E[2294]              					mov		[YST],cx
  1559 0000110C BBC700                  					mov		bx,BOTTOM_EDGE
  1560 0000110F 891E[2094]              					mov		[XST],bx
  1561                                  
  1562 00001113 A1[2294]                					mov		ax,[YST]
  1563 00001116 8B2E[2094]              					mov		bp,[XST]
  1564 0000111A E88101                  					call	ClassifyPoint
  1565 0000111D 8816[2894]              					mov		[CCST],dl
  1566 00001121 C3                      					ret
  1567                                  	
  1568 00001122 89CD                    ClipBehind:	mov		bp,cx	; backup pon.z (onh)
  1569 00001124 29F9                    			sub		cx,di 	; pon.z-poff.z (dh)
  1570                                  
  1571 00001126 89C7                    			mov		di,ax	; backup pon.x (onv)
  1572 00001128 29D8                    			sub		ax,bx	; pon.x-poff.x (dv)
  1573                                  
  1574 0000112A F7ED                    			imul	bp	; pon.x-poff.x (dx) * pon.z (onh) 
  1575 0000112C F7F9                    			idiv	cx	; 	/ pon.z-poff.z (dh) (pon.z+poff.z)
  1576                                  
  1577 0000112E 29C7                    			sub	di,ax
  1578 00001130 C3                      			ret
  1579                                  	
  1580                                  ; input
  1581                                  ; ax = x on screen ; pon.x = +ve
  1582                                  ; bx = x off screen ; poff.x = -ve
  1583                                  ; dx = y on screen ; pon.y
  1584                                  ; di = y off screen ; poff.y
  1585                                  ; output
  1586                                  ; ax = clippedy
  1587                                  
  1588 00001131 89CD                    ClipTop:	mov		bp,cx	; backup pon.x (onh)
  1589 00001133 29F9                    			sub		cx,di 	; pon.x-poff.x (dh)
  1590                                  
  1591 00001135 89C7                    			mov		di,ax	; backup pon.y (onv)
  1592 00001137 29D8                    			sub		ax,bx	; pon.y-poff.y (dv)
  1593                                  
  1594 00001139 F7ED                    			imul	bp	; pon.y-poff.y (dv) * pon.x (onh) 
  1595 0000113B F7F9                    			idiv	cx	; 	/ pon.x-poff.x (dh) (pon.x+poff.x)
  1596                                  
  1597 0000113D 29C7                    			sub		di,ax
  1598 0000113F C3                      			ret
  1599                                  
  1600 00001140 89CD                    ClipLeft:	mov		bp,cx	; backup pon.x (onh)
  1601 00001142 29D9                    			sub		cx,bx 	; pon.x-poff.x (dh)
  1602                                  
  1603 00001144 89C3                    			mov		bx,ax	; backup pon.y (onv)
  1604 00001146 29F8                    			sub		ax,di	; pon.y-poff.y (dv)
  1605                                  
  1606 00001148 F7ED                    			imul	bp	; pon.y-poff.y (dv) * pon.x (onh) 
  1607 0000114A F7F9                    			idiv	cx	; 	/ pon.x-poff.x (dh) (pon.x+poff.x)
  1608                                  
  1609 0000114C 29C3                    			sub		bx,ax
  1610 0000114E C3                      			ret
  1611                                  
  1612 0000114F BDC700                  ClipBottom:	mov		bp,BOTTOM_EDGE
  1613 00001152 29D5                    			sub		bp,dx	; rightedge - pon.x (onh)
  1614 00001154 29D7                    			sub		di,dx	; poff.x - pon.x (dh)
  1615                                  
  1616 00001156 89C1                    			mov		cx,ax
  1617 00001158 29D8                    			sub		ax,bx	; pon.y-poff.y (dv)
  1618                                  
  1619 0000115A F7ED                    			imul	bp
  1620 0000115C F7FF                    			idiv	di
  1621                                  	
  1622 0000115E 29C1                    			sub		cx,ax
  1623 00001160 C3                      			ret
  1624                                  
  1625 00001161 B83F01                  ClipRight:	mov		ax,RIGHT_EDGE
  1626 00001164 29E8                    			sub		ax,bp	; rightedge - pon.x (onh)
  1627 00001166 29EB                    			sub		bx,bp	; poff.x - pon.x (dh)
  1628                                  	
  1629 00001168 89D5                    			mov		bp,dx
  1630 0000116A 29FA                    			sub		dx,di	; pon.y-poff.y (dv)
  1631                                  
  1632 0000116C F7EA                    			imul	dx
  1633 0000116E F7FB                    			idiv	bx
  1634                                  
  1635 00001170 29C5                    			sub		bp,ax
  1636 00001172 C3                      			ret
  1637                                  	
  1638 00001173 80FF00                  GetSin256:	cmp		bh,0
  1639 00001176 740A                    			je		.s000090
  1640 00001178 80FF01                  .s090180:	cmp		bh,1
  1641 0000117B 750A                    			jne		.s180270
  1642 0000117D 30FF                    				xor		bh,bh
  1643 0000117F 80F3FF                  				xor		bl,255
  1644 00001182 8A87[B428]              .s000090		mov		al,[sintab+bx]
  1645 00001186 C3                      				ret
  1646 00001187 80FF02                  .s180270:	cmp		bh,2
  1647 0000118A 7509                    			jne		.s270000
  1648 0000118C 30FF                    				xor		bh,bh
  1649 0000118E 8A87[B428]              				mov		al,[sintab+bx]
  1650 00001192 F6D8                    				neg		al
  1651 00001194 C3                      				ret
  1652 00001195 30FF                    .s270000:	xor		bh,bh
  1653 00001197 80F3FF                  			xor		bl,255
  1654 0000119A 8A87[B428]              			mov		al,[sintab+bx]
  1655 0000119E F6D8                    			neg		al
  1656 000011A0 C3                      			ret
  1657                                  
  1658 000011A1 89EB                    SinCos:		mov		bx,bp
  1659 000011A3 E8CDFF                  			call	GetSin256
  1660 000011A6 98                      			cbw
  1661 000011A7 89EB                    			mov		bx,bp
  1662 000011A9 01C0                    			add		ax,ax
  1663 000011AB 89C5                    			mov		bp,ax
  1664 000011AD FEC7                    			inc		bh
  1665 000011AF 80E703                  			and		bh,3
  1666 000011B2 E8BEFF                  			call	GetSin256
  1667 000011B5 98                      			cbw
  1668 000011B6 01C0                    			add		ax,ax
  1669 000011B8 C3                      			ret
  1670                                  
  1671 000011B9 8B2E[2A94]              RotationMatrix:	mov		bp,[XAngle]
  1672 000011BD E8E1FF                  				call	SinCos
  1673 000011C0 892E[1494]              				mov		[SinX],bp
  1674 000011C4 A3[1694]                				mov		[CosX],ax
  1675                                  
  1676 000011C7 8B2E[2C94]              				mov		bp,[YAngle]
  1677 000011CB E8D3FF                  				call	SinCos
  1678 000011CE 892E[1894]              				mov		[SinY],bp
  1679 000011D2 A3[1A94]                				mov		[CosY],ax
  1680                                  	
  1681 000011D5 8B2E[2E94]              				mov		bp,[ZAngle]
  1682 000011D9 E8C5FF                  				call	SinCos
  1683 000011DC 892E[1C94]              				mov		[SinZ],bp
  1684 000011E0 A3[1E94]                				mov		[CosZ],ax
  1685                                  
  1686 000011E3 C3                      				ret
  1687                                  
  1688                                  ; cos(x) * cos(z) 										= mz3 ?
  1689                                  ; sin(x)												= my3 ?
  1690                                  ; cos(x) * -sin(z)										= mx3 ?
  1691                                   
  1692                                  ; (cos(y) * -sin(x) * cos(z)) + (sin(y) * sin(z)),		= mz2 ?
  1693                                  ; cos(y) * cos(x),										= my2 ?
  1694                                  ; (cos(y) * -sin(x) * -sin(z)) + (sin(y) * cos(z))		= mx2 ?
  1695                                  
  1696                                  ; (-sin(y) * -sin(x) * cos(z)) + (cos(y) * sin(z))		= mz1 ?
  1697                                  ; -sin(y) * cos(x) 										= my1 ?
  1698                                  ; (-sin(y) * -sin(x) * -sin(z)) + (cos(y) * cos(z)) 	= mx1 ?
  1699                                  
  1700                                  
  1701                                  ; mx1= (sin(gam)*sin(bet)*sin(alp)) + (cos(gam)*cos(alp))
  1702                                  ; my1= (-cos(bet))*sin(alp)
  1703                                  ; mz1= (sin(gam)*cos(alp)) - (cos(gam)*sin(bet)*sin(alp))
  1704                                  
  1705                                  ; mx2= (cos(gam)*sin(alp)) - (sin(gam)*sin(bet)*cos(alp))
  1706                                  ; my2= (cos(bet)*cos(alp))
  1707                                  ; mz2= ((-cos(gam))*sin(bet)*cos(alp)) - (sin(gam)*sin(alp))
  1708                                  
  1709                                  ; mx3 = cos(bet)*sin(gam)
  1710                                  ; my3 = sin(bet)
  1711                                  ; mz3 = cos(gam)*cos(bet)
  1712                                  
  1713                                  ; x"'=x*mx1 + y*my1 + z*mz1
  1714                                  ; y"'=x*mx2 + y*my2 + z*mz2
  1715                                  ; z"'=x*mx3 + y*my3 + z*mz3.
  1716                                  
  1717                                  ; alp=X
  1718                                  ; bet=Y
  1719                                  ; gam=Z
  1720                                  
  1721                                  ; mx1= (SinZ*SinY*SinX) + (CosZ*CosX)
  1722                                  ; #1 = SinZ * SinY
  1723                                  ; #2 = #1 * SinX
  1724                                  ; #3 = CosZ * CosX
  1725                                  ; #4 = #2 + #3
  1726                                  
  1727                                  ; my1= (-CosY)*SinX
  1728                                  ; #1 = -CosY
  1729                                  ; #2 = #1 * SinX
  1730                                  
  1731                                  ; mz1= (SinZ*CosX) - (CosZ*SinY*SinX)
  1732                                  ; #1 = SinZ * CosX
  1733                                  ; #2 = CosZ * SinY
  1734                                  ; #3 = #2 * SinX
  1735                                  ; #4 = #1 - #3
  1736                                  
  1737                                  ; mx2= (CosZ*SinX) - (SinZ*SinY*CosX)
  1738                                  ; #1 = CosZ * SinX
  1739                                  ; #2 = SinZ * SinY
  1740                                  ; #3 = #2 * CosX
  1741                                  ; #4 = #1 - #2
  1742                                  
  1743                                  ; my2= (CosY*CosX)
  1744                                  ; #1 = CosY * CosX
  1745                                  
  1746                                  ; mz2= ((-CosZ)*SinY*CosX) - (SinZ*SinX)
  1747                                  ; #1 = -CosZ
  1748                                  ; #2 = #1 * SinY
  1749                                  ; #3 = #2 * CosX
  1750                                  ; #4 = Sinz * SinX
  1751                                  ; #5 = #3 - #4
  1752                                  
  1753                                  ; mx3 = CosY*SinZ
  1754                                  ; #1 = CosY * SinZ
  1755                                  
  1756                                  ; my3 = SinY
  1757                                  ; #1 = SinY
  1758                                  
  1759                                  ; mz3 = CosZ*CosY
  1760                                  ; #1 = CosZ * CosY
  1761                                  
  1762 000011E4 8B2E[2A94]              BuildRotateMatrix:	mov		bp,[XAngle]
  1763 000011E8 E8B6FF                  					call	SinCos
  1764 000011EB 892E[1494]              					mov		[SinX],bp
  1765 000011EF A3[1694]                					mov		[CosX],ax
  1766                                  
  1767 000011F2 8B2E[2C94]              					mov		bp,[YAngle]
  1768 000011F6 E8A8FF                  					call	SinCos
  1769 000011F9 892E[1894]              					mov		[SinY],bp
  1770 000011FD A3[1A94]                					mov		[CosY],ax
  1771                                  	
  1772 00001200 8B2E[2E94]              					mov		bp,[ZAngle]
  1773 00001204 E89AFF                  					call	SinCos
  1774 00001207 892E[1C94]              					mov		[SinZ],bp
  1775 0000120B A3[1E94]                					mov		[CosZ],ax
  1776 0000120E C3                      					ret
  1777                                  	
  1778                                  Rotate:
  1779 0000120F 06                      	push es
  1780                                  ;rotate around x-axis:
  1781                                  ;	y'' = y'*cos(C) + z'*sin(C)
  1782                                  ;	z'' = y'*sin(C) - z'*cos(C)
  1783                                  	
  1784                                  RotateX:
  1785 00001210 8EC0                    	mov	es,ax	; y
  1786 00001212 F72E[1694]              	imul	word [CosX] ; y*cos(x)
  1787 00001216 88E3                    	mov	bl,ah
  1788 00001218 88D7                    	mov	bh,dl
  1789                                  
  1790 0000121A 89E8                    	mov	ax,bp	; z
  1791 0000121C F72E[1494]              	imul	word [SinX]	; z*sin(x)
  1792 00001220 88E0                    	mov	al,ah
  1793 00001222 88D4                    	mov	ah,dl
  1794 00001224 01C3                    	add		bx,ax
  1795                                  
  1796 00001226 8CC0                    	mov	ax,es	; y
  1797 00001228 8EC3                    	mov	es,bx
  1798 0000122A F72E[1494]              	imul	word [SinX]	 ; y*sin(x)
  1799 0000122E 88E3                    	mov	bl,ah
  1800 00001230 88D7                    	mov	bh,dl
  1801                                  
  1802 00001232 89E8                    	mov	ax,bp	; z
  1803 00001234 F72E[1694]              	imul	word [CosX]	; z*cos(x)
  1804 00001238 88E0                    	mov	al,ah
  1805 0000123A 88D4                    	mov	ah,dl
  1806                                  
  1807 0000123C 29C3                    	sub	bx,ax
  1808 0000123E 89DD                    	mov	bp,bx
  1809                                  
  1810                                  ; rotate around y-axis:
  1811                                  ;	x'' = x'*cos(B) + z*sin(B)
  1812                                  ;	z'  = x'*sin(B) - z*cos(B)
  1813                                  
  1814                                  RotateY:
  1815 00001240 89C8                    	mov	ax,cx	; x
  1816 00001242 F72E[1A94]              	imul	word [CosY]	 ; x*cos(y)
  1817 00001246 88E3                    	mov	bl,ah
  1818 00001248 88D7                    	mov	bh,dl
  1819                                  
  1820 0000124A 89E8                    	mov	ax,bp	; z
  1821 0000124C F72E[1894]              	imul	word [SinY]	; z*sin(y)
  1822 00001250 88E0                    	mov	al,ah
  1823 00001252 88D4                    	mov	ah,dl
  1824 00001254 01C3                    	add	bx,ax
  1825                                  
  1826 00001256 89C8                    	mov	ax,cx	; x
  1827 00001258 89D9                    	mov	cx,bx
  1828 0000125A F72E[1894]              	imul	word [SinY]	; x*sin(y)
  1829 0000125E 88E3                    	mov	bl,ah
  1830 00001260 88D7                    	mov	bh,dl
  1831                                  
  1832 00001262 89E8                    	mov	ax,bp	; z
  1833 00001264 F72E[1A94]              	imul	word [CosY]	; z*cos(y)
  1834 00001268 88E0                    	mov	al,ah
  1835 0000126A 88D4                    	mov	ah,dl
  1836                                  
  1837 0000126C 29C3                    	sub	bx,ax
  1838 0000126E 89DD                    	mov	bp,bx
  1839                                  
  1840                                  ;rotate around z-axis:
  1841                                  ;	x'  = x*cos(A) + y*sin(A)
  1842                                  ;	y'  = x*sin(A) - y*cos(A)
  1843                                  
  1844                                  RotateZ:
  1845 00001270 89C8                    	mov	ax,cx	; x
  1846 00001272 F72E[1E94]              	imul	word [CosZ] 	; x*cos(z)
  1847 00001276 88E3                    	mov	bl,ah
  1848 00001278 88D7                    	mov	bh,dl
  1849                                  
  1850 0000127A 8CC0                    	mov	ax,es	; y
  1851 0000127C F72E[1C94]              	imul	word [SinZ]; y*sin(z)
  1852 00001280 88E0                    	mov	al,ah
  1853 00001282 88D4                    	mov	ah,dl
  1854 00001284 01C3                    	add		bx,ax
  1855                                  
  1856 00001286 89C8                    	mov	ax,cx 	; x
  1857 00001288 F72E[1C94]              	imul 	word [SinZ]	; x*sin(z)
  1858 0000128C 88E1                    	mov	cl,ah
  1859 0000128E 88D5                    	mov	ch,dl
  1860                                  
  1861 00001290 8CC0                    	mov	ax,es	; y
  1862 00001292 F72E[1E94]              	imul	word [CosZ]	; y*cos(z)
  1863 00001296 88E0                    	mov	al,ah
  1864 00001298 88D4                    	mov	ah,dl
  1865                                  
  1866 0000129A 29C1                    	sub	cx,ax
  1867                                  
  1868                                  
  1869 0000129C 07                      	pop es
  1870                                  
  1871 0000129D C3                      	ret
  1872                                  
  1873 0000129E 30D2                    ClassifyPoint:	xor		dl,dl	; in = ax/bp	; out = dl	; clear clipcodes
  1874                                  
  1875 000012A0 83FD00                  				cmp		bp,TOP_EDGE
  1876 000012A3 7D04                    				jge		.right_test
  1877 000012A5 B201                    					mov		dl,TOP_CC
  1878 000012A7 EB08                    					jmp		.hor_test_end
  1879                                  
  1880 000012A9 81FDC700                .right_test:	cmp		bp,BOTTOM_EDGE
  1881 000012AD 7E02                    				jle		.hor_test_end
  1882 000012AF B202                    					mov		dl,BOTTOM_CC
  1883                                  
  1884 000012B1 83F800                  .hor_test_end:	cmp		ax,LEFT_EDGE
  1885 000012B4 7D04                    				jge		.bottom_test
  1886 000012B6 80CA04                  					or		dl,LEFT_CC
  1887 000012B9 C3                      					ret
  1888 000012BA 3D3F01                  .bottom_test:	cmp		ax,RIGHT_EDGE
  1889 000012BD 7E03                    				jle		.ver_test_end
  1890 000012BF 80CA08                  					or		dl,RIGHT_CC 			
  1891 000012C2 C3                      .ver_test_end:	ret
  1892                                  
  1893 000012C3 FEC5                    Perspective:	inc		ch	; in - bp = z / ax = x  dx = y	; z +256
  1894                                  		
  1895 000012C5 99                      				cwd
  1896 000012C6 88E2                    				mov		dl,ah
  1897 000012C8 88C4                    				mov		ah,al		; dx:ax = ypos *256 = ypos *256	
  1898 000012CA F7F9                    				idiv	cx 		; ax = dx:ax = ypos*256 / zpos+256
  1899 000012CC 83C064                  				add		ax,MIDDLE_Y	; ypos
  1900                                  	
  1901 000012CF 95                      				xchg	ax,bp
  1902                                  
  1903 000012D0 99                      				cwd
  1904 000012D1 88E2                    				mov		dl,ah
  1905 000012D3 88C4                    				mov		ah,al		; dx:ax = xpos *256 = xpos *256
  1906 000012D5 F7F9                    				idiv	cx 		; ax = dx:ax = xpos*256 / zpos+256
  1907 000012D7 05A000                  				add		ax,MIDDLE_X	; xpos
  1908                                  	
  1909 000012DA C3                      				ret			; output bl=clip codes / ax=xpos / bp=ypos
  1910                                  	
  1911 000012DB 89FE                    HexChar:	mov		si,di
  1912 000012DD 88C3                    			mov		bl,al
  1913 000012DF D0EB                    			shr		bl,1
  1914 000012E1 D0EB                    			shr		bl,1
  1915 000012E3 D0EB                    			shr		bl,1
  1916 000012E5 D0EB                    			shr		bl,1
  1917 000012E7 83E30F                  			and		bx,15
  1918 000012EA 8AA7[AC25]              			mov		ah,[Hex0+bx]
  1919 000012EE 268825                  			mov		[es:di],ah
  1920 000012F1 81C70020                			add		di,8192
  1921 000012F5 8AA7[BC25]              			mov		ah,[Hex1+bx]
  1922 000012F9 268825                  			mov		[es:di],ah
  1923 000012FC 81EFB01F                			sub		di,8192-80
  1924 00001300 8AA7[CC25]              			mov		ah,[Hex2+bx]
  1925 00001304 268825                  			mov		[es:di],ah
  1926 00001307 81C70020                			add		di,8192
  1927 0000130B 8AA7[DC25]              			mov		ah,[Hex3+bx]
  1928 0000130F 268825                  			mov		[es:di],ah
  1929 00001312 81EFB01F                			sub		di,8192-80
  1930 00001316 8AA7[EC25]              			mov		ah,[Hex4+bx]
  1931 0000131A 268825                  			mov		[es:di],ah
  1932                                  
  1933 0000131D 89F7                    			mov		di,si
  1934 0000131F 47                      			inc		di
  1935                                  
  1936 00001320 88C3                    			mov		bl,al
  1937 00001322 80E30F                  			and		bl,15
  1938 00001325 8A87[AC25]              			mov		al,[Hex0+bx]
  1939 00001329 268805                  			mov		[es:di],al
  1940 0000132C 81C70020                			add		di,8192
  1941 00001330 8A87[BC25]              			mov		al,[Hex1+bx]
  1942 00001334 268805                  			mov		[es:di],al
  1943 00001337 81EFB01F                			sub		di,8192-80
  1944 0000133B 8A87[CC25]              			mov		al,[Hex2+bx]
  1945 0000133F 268805                  			mov		[es:di],al
  1946 00001342 81C70020                			add		di,8192
  1947 00001346 8A87[DC25]              			mov		al,[Hex3+bx]
  1948 0000134A 268805                  			mov		[es:di],al
  1949 0000134D 81EFB01F                			sub		di,8192-80
  1950 00001351 8A87[EC25]              			mov		al,[Hex4+bx]
  1951 00001355 268805                  			mov		[es:di],al
  1952 00001358 C3                      			ret
  1953                                  
  1954 00001359 50                      Hex24:		push	ax
  1955 0000135A 53                      			push	bx
  1956                                  
  1957 0000135B 88F8                    			mov		al,bh
  1958 0000135D E82100                  			call	Hex8
  1959                                  						
  1960 00001360 5B                      			pop		bx
  1961 00001361 58                      			pop		ax
  1962                                  
  1963 00001362 50                      			push	ax
  1964 00001363 53                      			push	bx
  1965                                  
  1966 00001364 BF0200                  			mov		di,2
  1967 00001367 E81900                  			call	HexByte
  1968                                  
  1969 0000136A 5B                      			pop		bx
  1970 0000136B 58                      			pop		ax
  1971                                  
  1972 0000136C 88E0                    			mov		al,ah
  1973 0000136E BF0400                  			mov		di,4
  1974 00001371 EB10                    			jmp		HexByte	; does ret
  1975                                  
  1976 00001373 50                      Hex16:		push	ax
  1977 00001374 53                      			push	bx
  1978                                  
  1979 00001375 88E0                    			mov		al,ah
  1980 00001377 E80700                  			call	Hex8
  1981                                  						
  1982 0000137A 5B                      			pop		bx
  1983 0000137B 58                      			pop		ax
  1984                                  
  1985 0000137C BF0200                  			mov		di,2
  1986 0000137F EB02                    			jmp		HexByte ; does ret
  1987                                  
  1988 00001381 31FF                    Hex8:		xor		di,di
  1989 00001383 30FF                    HexByte:	xor		bh,bh
  1990 00001385 88DC                    			mov		ah,bl
  1991 00001387 00E4                    			add		ah,ah	; *2
  1992 00001389 00E3                    			add		bl,ah	; *3
  1993 0000138B 01DB                    			add		bx,bx	; *6
  1994 0000138D 01DB                    			add		bx,bx	; *12
  1995 0000138F 03BF[0000]              			add		di,[BackBufferTable+bx]	; lookup start ver
  1996 00001393 E945FF                  			jmp		HexChar	 ; does ret
  1997                                  ;			ret
  1998                                  
  1999                                  
  2000                                  ; pre-classify point
  2001                                  ; get camera v
  2002                                  ; sub 255
  2003                                  ; store start_v
  2004                                  ; get camera_h
  2005                                  ; sub 255
  2006                                  ; store start_h
  2007                                  ; get camera_z
  2008                                  ; sub 255
  2009                                  ; store start_z
  2010                                  
  2011                                  ; classify point
  2012                                  ; get v
  2013                                  ; sub start_v from v
  2014                                  ; if v neg
  2015                                  ;  off left
  2016                                  ; if v gt 510
  2017                                  ;  off right
  2018                                  ; get z
  2019                                  ; sub start_z from z
  2020                                  ; if z neg
  2021                                  ;  off back
  2022                                  ; if z gt 510
  2023                                  ;  off front
  2024                                  
  2025                                  ; get h
  2026                                  ; sub start_h from h
  2027                                  ; if h neg
  2028                                  ;  off top
  2029                                  ; if h gt 510
  2030                                  ;  off bot
  2031                                   
  2032                                  ; get object
  2033                                  ; rotate it
  2034                                  ; translate it
  2035                                  ; classify each point
  2036                                  ; if onscreen 
  2037                                  ;  do perspective
  2038                                  
  2039                                  ; read through lines
  2040                                  
  2041                                  MAX_EDGE EQU 510
  2042                                  MIDDLE_H EQU MIDDLE_X
  2043                                  
  2044 00001396 57                      DrawObjectZW:	push	di ; object lines
  2045 00001397 51                      				push	cx ; number of lines
  2046                                  
  2047 00001398 30ED                    				xor		ch,ch
  2048 0000139A FEC9                    				dec		cl
  2049 0000139C 00C9                    				add		cl,cl
  2050 0000139E 89CF                    				mov		di,cx	; point count
  2051                                  
  2052 000013A0 57                       push di
  2053 000013A1 BBFF00                  				mov		bx,255 ; high = or clip codes / low = and clip codes
  2054                                  	
  2055 000013A4 53                      .rotate_point_loop:	push	bx
  2056 000013A5 3E8B04                  					mov		ax,[ds:si]		; vpos
  2057 000013A8 3E8B5C02                					mov		bx,[ds:si+2]	; hpos
  2058 000013AC 3E8B4C04                					mov		cx,[ds:si+4]	; zpos
  2059 000013B0 890E[4394]              	mov		[Test3],cx
  2060                                  		
  2061 000013B4 30D2                    					xor		dl,dl					; clip code
  2062                                  
  2063 000013B6 0306[A626]              					add		ax,[VOffset]
  2064                                  
  2065                                  ;					jns		.off_right
  2066                                  ;						mov		dl,LEFT_CC
  2067                                  ;						jmp		.off_ver
  2068                                  ;.off_right			cmp		ax,MAX_EDGE
  2069                                  ;					jle		.off_ver
  2070                                  ;						mov		dl,RIGHT_CC
  2071                                  
  2072                                  
  2073 000013BA 031E[A426]              .off_ver			add		bx,[HOffset]
  2074                                  
  2075                                  ;					jns		.off_bottom
  2076                                  ;						or		dl,TOP_CC
  2077                                  ;						jmp		.off_z
  2078                                  ;.off_bottom			cmp		bx,MAX_EDGE
  2079                                  ;					jle		.off_z
  2080                                  ;						or		dl,BOTTOM_CC
  2081                                  
  2082                                  
  2083 000013BE 030E[AC26]              .off_z				add		cx,[ZOffset]
  2084 000013C2 890E[4594]              	mov		[Test4],cx
  2085                                  
  2086                                  
  2087                                  
  2088                                  ;					jns		.off_back
  2089                                  ;						or		dl,FRONT_CC
  2090                                  ;						jmp		.off_clip
  2091                                  ;.off_back			cmp		cx,MAX_EDGE
  2092                                  ;					jle		.off_clip
  2093                                  ;						or		dl,BACK_CC
  2094                                  
  2095                                  .off_clip:
  2096 000013C6 8985[1492]              					mov		[ObjectYRot+di],ax 	; yrot
  2097 000013CA 899D[1491]              					mov		[ObjectXRot+di],bx 	; xrot
  2098 000013CE 898D[1493]              					mov		[ObjectZRot+di],cx 	; zrot
  2099                                  
  2100 000013D2 8895[1490]              					mov		[ObjectClipCode+di],dl 	; clip code
  2101                                  
  2102 000013D6 84D2                    					test	dl,dl
  2103 000013D8 751B                    					jnz		.off_scn
  2104 000013DA 89C2                    						mov		dx,ax
  2105                                  
  2106 000013DC 8916[3D94]              	mov		[Test0],dx
  2107 000013E0 891E[3F94]              	mov		[Test1],bx
  2108 000013E4 890E[4194]              	mov		[Test2],cx
  2109                                  
  2110 000013E8 E8E901                  						call	PerspectiveZW
  2111 000013EB 899D[148E]              						mov		[ObjectYPos+di],bx 		; xpos
  2112 000013EF 898D[148F]              						mov		[ObjectXPos+di],cx 		; ypos
  2113                                  						
  2114                                  ;	mov		[Test1],bx
  2115                                  ;	mov		[Test2],cx
  2116                                  
  2117 000013F3 30D2                    						xor		dl,dl	; if it reaches here it must be onscreen?
  2118                                  
  2119                                  .off_scn:
  2120 000013F5 5B                      					pop		bx
  2121 000013F6 20D3                    					and		bl,dl	; object and clip code
  2122 000013F8 08D7                    					or		bh,dl	; object or clip code
  2123                                  		
  2124 000013FA 83C606                  					add		si,6				
  2125 000013FD 83EF02                  					sub		di,2
  2126 00001400 79A2                    					jns		.rotate_point_loop
  2127                                  				
  2128 00001402 59                      				pop		cx 	; number of lines
  2129 00001403 5E                      				pop 	si 	; object lines
  2130                                  
  2131 00001404 5F                       pop di ; number of points
  2132                                  
  2133                                  ;	mov		[Test0],bx
  2134                                  
  2135 00001405 8B1E[148E]              						mov		bx,[ObjectYPos+0] 		; xpos
  2136 00001409 8B2E[148F]              						mov		bp,[ObjectXPos+0] 		; ypos
  2137 0000140D E8AAF1                  						call	Plot11
  2138 00001410 8B1E[168E]              						mov		bx,[ObjectYPos+2] 		; xpos
  2139 00001414 8B2E[168F]              						mov		bp,[ObjectXPos+2] 		; ypos
  2140 00001418 E89FF1                  						call	Plot11
  2141 0000141B 8B1E[188E]              						mov		bx,[ObjectYPos+4] 		; xpos
  2142 0000141F 8B2E[188F]              						mov		bp,[ObjectXPos+4] 		; ypos
  2143 00001423 E894F1                  						call	Plot11
  2144 00001426 8B1E[1A8E]              						mov		bx,[ObjectYPos+6] 		; xpos
  2145 0000142A 8B2E[1A8F]              						mov		bp,[ObjectXPos+6] 		; ypos
  2146 0000142E E889F1                  						call	Plot11
  2147                                  
  2148 00001431 8B1E[1C8E]              						mov		bx,[ObjectYPos+8] 		; xpos
  2149 00001435 8B2E[1C8F]              						mov		bp,[ObjectXPos+8] 		; ypos
  2150 00001439 E87EF1                  						call	Plot11
  2151 0000143C 8B1E[1E8E]              						mov		bx,[ObjectYPos+10] 		; xpos
  2152 00001440 8B2E[1E8F]              						mov		bp,[ObjectXPos+10] 		; ypos
  2153 00001444 E873F1                  						call	Plot11
  2154 00001447 8B1E[208E]              						mov		bx,[ObjectYPos+12] 		; xpos
  2155 0000144B 8B2E[208F]              						mov		bp,[ObjectXPos+12] 		; ypos
  2156 0000144F E868F1                  						call	Plot11
  2157 00001452 8B1E[228E]              						mov		bx,[ObjectYPos+14] 		; xpos
  2158 00001456 8B2E[228F]              						mov		bp,[ObjectXPos+14] 		; ypos
  2159 0000145A E85DF1                  						call	Plot11
  2160                                    
  2161 0000145D C3                      	ret
  2162 0000145E 80FB00                  				cmp		bl,0				; if and_object_clip_code ne 0 all off one side so exit
  2163 00001461 7530                    				jnz		.off_screen
  2164                                   
  2165 00001463 80FF00                  				cmp		bh,0				; if or_object_clip_code eq 0 all on screen so no clip needed
  2166 00001466 752C                    				jnz		.draw_clipped_object
  2167                                  
  2168                                  .draw_whole_object:
  2169 00001468 51                      .draw_whole_object_line_loop:	push	cx
  2170 00001469 56                      								push	si
  2171                                  
  2172 0000146A 30FF                    								xor		bh,bh
  2173 0000146C 3E8A1C                  								mov		bl,[ds:si]
  2174 0000146F 00DB                    								add		bl,bl	
  2175 00001471 8B8F[148E]              								mov		cx,[ObjectYPos+bx] ; endy
  2176 00001475 8B97[148F]              								mov		dx,[ObjectXPos+bx] ; endx
  2177                                   
  2178 00001479 3E8A5C01                								mov		bl,[ds:si+1]
  2179 0000147D 00DB                    								add		bl,bl
  2180 0000147F 8BAF[148E]              								mov		bp,[ObjectYPos+bx] ; starty
  2181 00001483 8BB7[148F]              								mov		si,[ObjectXPos+bx] ; startx
  2182 00001487 E8F1EE                  								call	Line00
  2183                                  	 
  2184 0000148A 5E                      								pop		si
  2185 0000148B 59                      								pop		cx
  2186 0000148C 83C602                  								add		si,2
  2187                                  
  2188 0000148F FECD                    								dec		ch
  2189 00001491 75D5                    								jnz		.draw_whole_object_line_loop
  2190                                  
  2191 00001493 C3                      .off_screen:				ret
  2192                                  	
  2193                                  .draw_clipped_object:	
  2194 00001494 30FF                    .draw_clipped_object_line_loop:	xor		bh,bh
  2195 00001496 51                      								push	cx
  2196 00001497 56                      								push	si
  2197                                  		
  2198 00001498 3E8A1C                  								mov		bl,[ds:si]
  2199 0000149B 00DB                    								add		bl,bl
  2200 0000149D 8A87[1490]              								mov		al,[ObjectClipCode+bx] 	; start clip code
  2201 000014A1 3E8A5C01                								mov		bl,[ds:si+1]
  2202 000014A5 00DB                    								add		bl,bl
  2203 000014A7 8AA7[1490]              								mov		ah,[ObjectClipCode+bx] 	; end clip code
  2204                                  
  2205 000014AB 88C3                    								mov		bl,al		; backup start clip code
  2206 000014AD 20E3                    								and		bl,ah	; both points are off 
  2207 000014AF 7522                    								jnz		.line_off_screen	; then line is off screen
  2208                                  
  2209 000014B1 08E0                    								or		al,ah 	; if any point is off
  2210 000014B3 7528                    								jnz		.line_clip	; then line needs clipped
  2211                                  		
  2212 000014B5 3E8A1C                  								mov		bl,[ds:si]
  2213 000014B8 00DB                    								add		bl,bl	
  2214 000014BA 8B8F[148E]              								mov		cx,[ObjectYPos+bx] ; starty
  2215 000014BE 8B97[148F]              								mov		dx,[ObjectXPos+bx] ; startx
  2216                                  
  2217 000014C2 3E8A5C01                								mov		bl,[ds:si+1]
  2218 000014C6 00DB                    								add		bl,bl
  2219 000014C8 8BAF[148E]              								mov		bp,[ObjectYPos+bx] ; endy 
  2220 000014CC 8BB7[148F]              								mov		si,[ObjectXPos+bx] ; endx - todo - si is the problem?
  2221                                  
  2222 000014D0 E8D4ED                  .draw_clipped_line:				call	Line11
  2223                                  
  2224 000014D3 5E                      .line_off_screen:				pop		si
  2225 000014D4 59                      								pop		cx
  2226 000014D5 83C602                  								add		si,2
  2227                                  		
  2228 000014D8 FECD                    								dec		ch
  2229 000014DA 75B8                    								jnz		.draw_clipped_object_line_loop
  2230 000014DC C3                      							ret
  2231                                  
  2232                                  .line_clip:	; al = point 1 clip ; ah = point 2 clip
  2233                                  
  2234                                  ; copy point details to 2 sets of coords temp coords zyx and temp perspective xy
  2235                                  ; if either point is behind
  2236                                  ;  do z clip on required point
  2237                                  ;  do perspective
  2238                                  ;  do rest of tests
  2239                                  
  2240 000014DD 30FF                    					xor		bh,bh
  2241 000014DF 3E8A1C                  					mov		bl,[ds:si]
  2242 000014E2 00DB                    					add		bl,bl	
  2243 000014E4 8B97[1491]              					mov		dx,[ObjectXRot+bx]
  2244 000014E8 8916[3194]              					mov		[STX],dx
  2245 000014EC 8B97[1492]              					mov		dx,[ObjectYRot+bx]
  2246 000014F0 8916[3394]              					mov		[STY],dx
  2247 000014F4 8B97[1493]              					mov		dx,[ObjectZRot+bx]
  2248 000014F8 8916[3594]              					mov		[STZ],dx
  2249 000014FC 8B97[148F]              					mov		dx,[ObjectXPos+bx]
  2250 00001500 8916[2094]              					mov		[XST],dx
  2251 00001504 8B97[148E]              					mov		dx,[ObjectYPos+bx]	
  2252 00001508 8916[2294]              					mov		[YST],dx	
  2253 0000150C 8A87[1490]              					mov		al,[ObjectClipCode+bx]
  2254                                  	
  2255 00001510 3E8A5C01                					mov		bl,[ds:si+1]
  2256 00001514 00DB                    					add		bl,bl
  2257 00001516 8B97[1491]              					mov		dx,[ObjectXRot+bx]
  2258 0000151A 8916[3794]              					mov		[ENX],dx
  2259 0000151E 8B97[1492]              					mov		dx,[ObjectYRot+bx]
  2260 00001522 8916[3994]              					mov		[ENY],dx
  2261 00001526 8B97[1493]              					mov		dx,[ObjectZRot+bx]
  2262 0000152A 8916[3B94]              					mov		[ENZ],dx	
  2263 0000152E 8B97[148F]              					mov		dx,[ObjectXPos+bx]
  2264 00001532 8916[2494]              					mov		[XEN],dx
  2265 00001536 8B97[148E]              					mov		dx,[ObjectYPos+bx]
  2266 0000153A 8916[2694]              					mov		[YEN],dx
  2267 0000153E 8AA7[1490]              					mov		ah,[ObjectClipCode+bx]
  2268                                  
  2269 00001542 A3[2894]                					mov		[CCST],ax
  2270                                  	
  2271 00001545 A1[2894]                .line_clip_loop:	mov		ax,[CCST]
  2272 00001548 88C3                    					mov		bl,al			; start cc
  2273 0000154A 20E0                    					and		al,ah			; and with end cc
  2274 0000154C 7585                    					jnz		.line_off_screen		; both off same side
  2275                                  	
  2276 0000154E 08E3                    					or		bl,ah			; or with end cc
  2277 00001550 746F                    					jz		.clip_draw_test		; all on so draw line
  2278                                  
  2279 00001552 F6C310                  .clip_behind_test:	test	bl,BEHIND_CC	; test if either point is off (al=al or ah)
  2280 00001555 7412                    					jz		.clip_left_test
  2281 00001557 E8D5F9                  					call	LineClipBehind
  2282                                  
  2283 0000155A A1[2894]                					mov		ax,[CCST]
  2284 0000155D 88C3                    					mov		bl,al			; start cc
  2285 0000155F 20E0                    					and		al,ah			; and with end cc
  2286 00001561 0F856EFF                					jnz		.line_off_screen		; both off same side
  2287                                  
  2288 00001565 08E3                    					or		bl,ah			; or with end cc
  2289 00001567 7458                    					jz		.clip_draw_test		; all on so draw line
  2290                                  	
  2291 00001569 F6C304                  .clip_left_test:	test	bl,LEFT_CC
  2292 0000156C 7412                    					jz		.clip_right_test
  2293 0000156E E898FA                  					call	LineClipLeft
  2294 00001571 A1[2894]                					mov		ax,[CCST]
  2295 00001574 88C3                    					mov		bl,al			; start cc
  2296 00001576 20E0                    					and		al,ah			; and with end cc
  2297 00001578 0F8557FF                					jnz		.line_off_screen		; both off same side
  2298                                  
  2299 0000157C 08E3                    					or		bl,ah			; or with end cc
  2300 0000157E 7441                    					jz		.clip_draw_test		; all on so draw line
  2301                                  		
  2302 00001580 F6C308                  .clip_right_test:	test	bl,RIGHT_CC
  2303 00001583 7412                    					jz		.clip_top_test
  2304 00001585 E8DEFA                  					call	LineClipRight
  2305 00001588 A1[2894]                					mov		ax,[CCST]
  2306 0000158B 88C3                    					mov		bl,al			; start cc
  2307 0000158D 20E0                    					and		al,ah			; and with end cc
  2308 0000158F 0F8540FF                					jnz		.line_off_screen		; both off same side
  2309                                  	
  2310 00001593 08E3                    					or		bl,ah			; or with end cc
  2311 00001595 742A                    					jz		.clip_draw_test		; all on so draw line
  2312                                  		
  2313                                  
  2314 00001597 F6C301                  .clip_top_test:		test	bl,TOP_CC
  2315 0000159A 7412                    					jz		.clip_bottom_test
  2316 0000159C E80DFA                  					call	LineClipTop
  2317 0000159F A1[2894]                					mov		ax,[CCST]
  2318 000015A2 88C3                    					mov		bl,al			; start cc
  2319 000015A4 20E0                    					and		al,ah			; and with end cc
  2320 000015A6 0F8529FF                					jnz		.line_off_screen		; both off same side
  2321                                  
  2322 000015AA 08E3                    					or		bl,ah			; or with end cc
  2323 000015AC 7413                    					jz		.clip_draw_test		; all on so draw line
  2324                                  
  2325 000015AE F6C302                  .clip_bottom_test:	test	bl,BOTTOM_CC
  2326 000015B1 7492                    					jz		.line_clip_loop
  2327 000015B3 E80FFB                  					call	LineClipBottom
  2328 000015B6 A1[2894]                					mov		ax,[CCST]
  2329 000015B9 88C3                    					mov		bl,al			; start cc
  2330 000015BB 20E0                    					and		al,ah			; and with end cc
  2331 000015BD 0F8512FF                					jnz		.line_off_screen		; both off same side
  2332                                  
  2333 000015C1 8B0E[2294]              .clip_draw_test:	mov		cx,[YST]
  2334 000015C5 8B16[2094]              					mov		dx,[XST]
  2335 000015C9 8B2E[2694]              					mov		bp,[YEN]
  2336 000015CD 8B36[2494]              					mov		si,[XEN]
  2337 000015D1 E9FCFE                  					jmp		.draw_clipped_line
  2338                                  
  2339                                  ; hor = 0 to 510
  2340                                  ; ver = 0 to 510
  2341                                  ; z = 0 to 510
  2342                                  
  2343                                  PerspectiveZW: ; in = bx=z/cx=v/dx=h/dh=hsign - out = bx=v/cx=h
  2344 000015D4 D1EB                    	shr		bx,1
  2345 000015D6 8A87[AE27]              	mov		al,[persvtab8+bx]
  2346 000015DA D1E9                    	shr		cx,1
  2347 000015DC F6E1                    	MUL		cl
  2348                                  
  2349 000015DE 8A87[AE26]              	mov		al,[pershtab8+bx]
  2350 000015E2 88E3                    	mov		bl,ah
  2351 000015E4 42                      	inc 	dx
  2352 000015E5 84F6                        test 	dh,dh
  2353 000015E7 750D                    	jnz		.pos
  2354                                  
  2355 000015E9 F6DA                    .neg	neg		dl
  2356 000015EB F6E2                    		MUL		dl
  2357 000015ED 88E1                    		mov		cl,ah
  2358 000015EF F7D9                    		neg		cx
  2359 000015F1 81C1A000                		add		cx,MIDDLE_H
  2360 000015F5 C3                      		ret
  2361                                  
  2362 000015F6 F6E2                    .pos	MUL		dl
  2363 000015F8 88E1                    		mov		cl,ah
  2364 000015FA 81C1A000                		add		cx,MIDDLE_H
  2365 000015FE C3                      		ret
  2366                                  
  2367                                  section .data align=8 ; 16 ; 8 ; 16
  2368                                  
  2369                                  OrTable:	
  2370 00000000 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2370 00000009 0030000C000300C000-
  2370 00000012 30000C000300C00030-
  2370 0000001B 000C000300C0003000-
  2370 00000024 0C000300C00030000C-
  2370 0000002D 000300C00030000C00-
  2370 00000036 0300C00030000C0003-
  2370 0000003F 00                 
  2371 00000040 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2371 00000049 0030000C000300C000-
  2371 00000052 30000C000300C00030-
  2371 0000005B 000C000300C0003000-
  2371 00000064 0C000300C00030000C-
  2371 0000006D 000300C00030000C00-
  2371 00000076 0300C00030000C0003-
  2371 0000007F 00                 
  2372 00000080 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2372 00000089 0030000C000300C000-
  2372 00000092 30000C000300C00030-
  2372 0000009B 000C000300C0003000-
  2372 000000A4 0C000300C00030000C-
  2372 000000AD 000300C00030000C00-
  2372 000000B6 0300C00030000C0003-
  2372 000000BF 00                 
  2373 000000C0 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2373 000000C9 0030000C000300C000-
  2373 000000D2 30000C000300C00030-
  2373 000000DB 000C000300C0003000-
  2373 000000E4 0C000300C00030000C-
  2373 000000ED 000300C00030000C00-
  2373 000000F6 0300C00030000C0003-
  2373 000000FF 00                 
  2374 00000100 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2374 00000109 0030000C000300C000-
  2374 00000112 30000C000300C00030-
  2374 0000011B 000C000300C0003000-
  2374 00000124 0C000300C00030000C-
  2374 0000012D 000300C00030000C00-
  2374 00000136 0300C00030000C0003-
  2374 0000013F 00                 
  2375 00000140 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2375 00000149 0030000C000300C000-
  2375 00000152 30000C000300C00030-
  2375 0000015B 000C000300C0003000-
  2375 00000164 0C000300C00030000C-
  2375 0000016D 000300C00030000C00-
  2375 00000176 0300C00030000C0003-
  2375 0000017F 00                 
  2376 00000180 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2376 00000189 0030000C000300C000-
  2376 00000192 30000C000300C00030-
  2376 0000019B 000C000300C0003000-
  2376 000001A4 0C000300C00030000C-
  2376 000001AD 000300C00030000C00-
  2376 000001B6 0300C00030000C0003-
  2376 000001BF 00                 
  2377 000001C0 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2377 000001C9 0030000C000300C000-
  2377 000001D2 30000C000300C00030-
  2377 000001DB 000C000300C0003000-
  2377 000001E4 0C000300C00030000C-
  2377 000001ED 000300C00030000C00-
  2377 000001F6 0300C00030000C0003-
  2377 000001FF 00                 
  2378 00000200 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2378 00000209 0030000C000300C000-
  2378 00000212 30000C000300C00030-
  2378 0000021B 000C000300C0003000-
  2378 00000224 0C000300C00030000C-
  2378 0000022D 000300C00030000C00-
  2378 00000236 0300C00030000C0003-
  2378 0000023F 00                 
  2379 00000240 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2379 00000249 0030000C000300C000-
  2379 00000252 30000C000300C00030-
  2379 0000025B 000C000300C0003000-
  2379 00000264 0C000300C00030000C-
  2379 0000026D 000300C00030000C00-
  2379 00000276 0300C00030000C0003-
  2379 0000027F 00                 
  2380 00000280 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2380 00000289 0030000C000300C000-
  2380 00000292 30000C000300C00030-
  2380 0000029B 000C000300C0003000-
  2380 000002A4 0C000300C00030000C-
  2380 000002AD 000300C00030000C00-
  2380 000002B6 0300C00030000C0003-
  2380 000002BF 00                 
  2381 000002C0 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2381 000002C9 0030000C000300C000-
  2381 000002D2 30000C000300C00030-
  2381 000002DB 000C000300C0003000-
  2381 000002E4 0C000300C00030000C-
  2381 000002ED 000300C00030000C00-
  2381 000002F6 0300C00030000C0003-
  2381 000002FF 00                 
  2382 00000300 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2382 00000309 0030000C000300C000-
  2382 00000312 30000C000300C00030-
  2382 0000031B 000C000300C0003000-
  2382 00000324 0C000300C00030000C-
  2382 0000032D 000300C00030000C00-
  2382 00000336 0300C00030000C0003-
  2382 0000033F 00                 
  2383 00000340 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2383 00000349 0030000C000300C000-
  2383 00000352 30000C000300C00030-
  2383 0000035B 000C000300C0003000-
  2383 00000364 0C000300C00030000C-
  2383 0000036D 000300C00030000C00-
  2383 00000376 0300C00030000C0003-
  2383 0000037F 00                 
  2384 00000380 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2384 00000389 0030000C000300C000-
  2384 00000392 30000C000300C00030-
  2384 0000039B 000C000300C0003000-
  2384 000003A4 0C000300C00030000C-
  2384 000003AD 000300C00030000C00-
  2384 000003B6 0300C00030000C0003-
  2384 000003BF 00                 
  2385 000003C0 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2385 000003C9 0030000C000300C000-
  2385 000003D2 30000C000300C00030-
  2385 000003DB 000C000300C0003000-
  2385 000003E4 0C000300C00030000C-
  2385 000003ED 000300C00030000C00-
  2385 000003F6 0300C00030000C0003-
  2385 000003FF 00                 
  2386 00000400 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2386 00000409 0030000C000300C000-
  2386 00000412 30000C000300C00030-
  2386 0000041B 000C000300C0003000-
  2386 00000424 0C000300C00030000C-
  2386 0000042D 000300C00030000C00-
  2386 00000436 0300C00030000C0003-
  2386 0000043F 00                 
  2387 00000440 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2387 00000449 0030000C000300C000-
  2387 00000452 30000C000300C00030-
  2387 0000045B 000C000300C0003000-
  2387 00000464 0C000300C00030000C-
  2387 0000046D 000300C00030000C00-
  2387 00000476 0300C00030000C0003-
  2387 0000047F 00                 
  2388 00000480 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2388 00000489 0030000C000300C000-
  2388 00000492 30000C000300C00030-
  2388 0000049B 000C000300C0003000-
  2388 000004A4 0C000300C00030000C-
  2388 000004AD 000300C00030000C00-
  2388 000004B6 0300C00030000C0003-
  2388 000004BF 00                 
  2389 000004C0 C00030000C000300C0-     	dw	192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3,192,48,12,3
  2389 000004C9 0030000C000300C000-
  2389 000004D2 30000C000300C00030-
  2389 000004DB 000C000300C0003000-
  2389 000004E4 0C000300C00030000C-
  2389 000004ED 000300C00030000C00-
  2389 000004F6 0300C00030000C0003-
  2389 000004FF 00                 
  2390                                  
  2391                                  AndTable:	
  2392 00000500 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2392 00000509 00CF00F300FC003F00-
  2392 00000512 CF00F300FC003F00CF-
  2392 0000051B 00F300FC003F00CF00-
  2392 00000524 F300FC003F00CF00F3-
  2392 0000052D 00FC003F00CF00F300-
  2392 00000536 FC003F00CF00F300FC-
  2392 0000053F 00                 
  2393 00000540 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2393 00000549 00CF00F300FC003F00-
  2393 00000552 CF00F300FC003F00CF-
  2393 0000055B 00F300FC003F00CF00-
  2393 00000564 F300FC003F00CF00F3-
  2393 0000056D 00FC003F00CF00F300-
  2393 00000576 FC003F00CF00F300FC-
  2393 0000057F 00                 
  2394 00000580 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2394 00000589 00CF00F300FC003F00-
  2394 00000592 CF00F300FC003F00CF-
  2394 0000059B 00F300FC003F00CF00-
  2394 000005A4 F300FC003F00CF00F3-
  2394 000005AD 00FC003F00CF00F300-
  2394 000005B6 FC003F00CF00F300FC-
  2394 000005BF 00                 
  2395 000005C0 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2395 000005C9 00CF00F300FC003F00-
  2395 000005D2 CF00F300FC003F00CF-
  2395 000005DB 00F300FC003F00CF00-
  2395 000005E4 F300FC003F00CF00F3-
  2395 000005ED 00FC003F00CF00F300-
  2395 000005F6 FC003F00CF00F300FC-
  2395 000005FF 00                 
  2396 00000600 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2396 00000609 00CF00F300FC003F00-
  2396 00000612 CF00F300FC003F00CF-
  2396 0000061B 00F300FC003F00CF00-
  2396 00000624 F300FC003F00CF00F3-
  2396 0000062D 00FC003F00CF00F300-
  2396 00000636 FC003F00CF00F300FC-
  2396 0000063F 00                 
  2397 00000640 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2397 00000649 00CF00F300FC003F00-
  2397 00000652 CF00F300FC003F00CF-
  2397 0000065B 00F300FC003F00CF00-
  2397 00000664 F300FC003F00CF00F3-
  2397 0000066D 00FC003F00CF00F300-
  2397 00000676 FC003F00CF00F300FC-
  2397 0000067F 00                 
  2398 00000680 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2398 00000689 00CF00F300FC003F00-
  2398 00000692 CF00F300FC003F00CF-
  2398 0000069B 00F300FC003F00CF00-
  2398 000006A4 F300FC003F00CF00F3-
  2398 000006AD 00FC003F00CF00F300-
  2398 000006B6 FC003F00CF00F300FC-
  2398 000006BF 00                 
  2399 000006C0 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2399 000006C9 00CF00F300FC003F00-
  2399 000006D2 CF00F300FC003F00CF-
  2399 000006DB 00F300FC003F00CF00-
  2399 000006E4 F300FC003F00CF00F3-
  2399 000006ED 00FC003F00CF00F300-
  2399 000006F6 FC003F00CF00F300FC-
  2399 000006FF 00                 
  2400 00000700 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2400 00000709 00CF00F300FC003F00-
  2400 00000712 CF00F300FC003F00CF-
  2400 0000071B 00F300FC003F00CF00-
  2400 00000724 F300FC003F00CF00F3-
  2400 0000072D 00FC003F00CF00F300-
  2400 00000736 FC003F00CF00F300FC-
  2400 0000073F 00                 
  2401 00000740 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2401 00000749 00CF00F300FC003F00-
  2401 00000752 CF00F300FC003F00CF-
  2401 0000075B 00F300FC003F00CF00-
  2401 00000764 F300FC003F00CF00F3-
  2401 0000076D 00FC003F00CF00F300-
  2401 00000776 FC003F00CF00F300FC-
  2401 0000077F 00                 
  2402 00000780 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2402 00000789 00CF00F300FC003F00-
  2402 00000792 CF00F300FC003F00CF-
  2402 0000079B 00F300FC003F00CF00-
  2402 000007A4 F300FC003F00CF00F3-
  2402 000007AD 00FC003F00CF00F300-
  2402 000007B6 FC003F00CF00F300FC-
  2402 000007BF 00                 
  2403 000007C0 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2403 000007C9 00CF00F300FC003F00-
  2403 000007D2 CF00F300FC003F00CF-
  2403 000007DB 00F300FC003F00CF00-
  2403 000007E4 F300FC003F00CF00F3-
  2403 000007ED 00FC003F00CF00F300-
  2403 000007F6 FC003F00CF00F300FC-
  2403 000007FF 00                 
  2404 00000800 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2404 00000809 00CF00F300FC003F00-
  2404 00000812 CF00F300FC003F00CF-
  2404 0000081B 00F300FC003F00CF00-
  2404 00000824 F300FC003F00CF00F3-
  2404 0000082D 00FC003F00CF00F300-
  2404 00000836 FC003F00CF00F300FC-
  2404 0000083F 00                 
  2405 00000840 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2405 00000849 00CF00F300FC003F00-
  2405 00000852 CF00F300FC003F00CF-
  2405 0000085B 00F300FC003F00CF00-
  2405 00000864 F300FC003F00CF00F3-
  2405 0000086D 00FC003F00CF00F300-
  2405 00000876 FC003F00CF00F300FC-
  2405 0000087F 00                 
  2406 00000880 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2406 00000889 00CF00F300FC003F00-
  2406 00000892 CF00F300FC003F00CF-
  2406 0000089B 00F300FC003F00CF00-
  2406 000008A4 F300FC003F00CF00F3-
  2406 000008AD 00FC003F00CF00F300-
  2406 000008B6 FC003F00CF00F300FC-
  2406 000008BF 00                 
  2407 000008C0 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2407 000008C9 00CF00F300FC003F00-
  2407 000008D2 CF00F300FC003F00CF-
  2407 000008DB 00F300FC003F00CF00-
  2407 000008E4 F300FC003F00CF00F3-
  2407 000008ED 00FC003F00CF00F300-
  2407 000008F6 FC003F00CF00F300FC-
  2407 000008FF 00                 
  2408 00000900 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2408 00000909 00CF00F300FC003F00-
  2408 00000912 CF00F300FC003F00CF-
  2408 0000091B 00F300FC003F00CF00-
  2408 00000924 F300FC003F00CF00F3-
  2408 0000092D 00FC003F00CF00F300-
  2408 00000936 FC003F00CF00F300FC-
  2408 0000093F 00                 
  2409 00000940 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2409 00000949 00CF00F300FC003F00-
  2409 00000952 CF00F300FC003F00CF-
  2409 0000095B 00F300FC003F00CF00-
  2409 00000964 F300FC003F00CF00F3-
  2409 0000096D 00FC003F00CF00F300-
  2409 00000976 FC003F00CF00F300FC-
  2409 0000097F 00                 
  2410 00000980 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2410 00000989 00CF00F300FC003F00-
  2410 00000992 CF00F300FC003F00CF-
  2410 0000099B 00F300FC003F00CF00-
  2410 000009A4 F300FC003F00CF00F3-
  2410 000009AD 00FC003F00CF00F300-
  2410 000009B6 FC003F00CF00F300FC-
  2410 000009BF 00                 
  2411 000009C0 3F00CF00F300FC003F-     	dw	255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3,255-192,255-48,255-12,255-3
  2411 000009C9 00CF00F300FC003F00-
  2411 000009D2 CF00F300FC003F00CF-
  2411 000009DB 00F300FC003F00CF00-
  2411 000009E4 F300FC003F00CF00F3-
  2411 000009ED 00FC003F00CF00F300-
  2411 000009F6 FC003F00CF00F300FC-
  2411 000009FF 00                 
  2412                                  	
  2413                                  HorPosTable:
  2414 00000A00 0000000000000000        	dw	0,0,0,0
  2415 00000A08 0100010001000100        	dw	1,1,1,1
  2416 00000A10 0200020002000200        	dw	2,2,2,2
  2417 00000A18 0300030003000300        	dw	3,3,3,3
  2418 00000A20 0400040004000400        	dw	4,4,4,4
  2419 00000A28 0500050005000500        	dw	5,5,5,5
  2420 00000A30 0600060006000600        	dw	6,6,6,6
  2421 00000A38 0700070007000700        	dw	7,7,7,7
  2422 00000A40 0800080008000800        	dw	8,8,8,8
  2423 00000A48 0900090009000900        	dw	9,9,9,9
  2424                                  	
  2425 00000A50 0A000A000A000A00        	dw	10,10,10,10
  2426 00000A58 0B000B000B000B00        	dw	11,11,11,11
  2427 00000A60 0C000C000C000C00        	dw	12,12,12,12
  2428 00000A68 0D000D000D000D00        	dw	13,13,13,13
  2429 00000A70 0E000E000E000E00        	dw	14,14,14,14
  2430 00000A78 0F000F000F000F00        	dw	15,15,15,15
  2431 00000A80 1000100010001000        	dw	16,16,16,16
  2432 00000A88 1100110011001100        	dw	17,17,17,17
  2433 00000A90 1200120012001200        	dw	18,18,18,18
  2434 00000A98 1300130013001300        	dw	19,19,19,19
  2435                                  	
  2436 00000AA0 1400140014001400        	dw	20,20,20,20
  2437 00000AA8 1500150015001500        	dw	21,21,21,21
  2438 00000AB0 1600160016001600        	dw	22,22,22,22
  2439 00000AB8 1700170017001700        	dw	23,23,23,23
  2440 00000AC0 1800180018001800        	dw	24,24,24,24
  2441 00000AC8 1900190019001900        	dw	25,25,25,25
  2442 00000AD0 1A001A001A001A00        	dw	26,26,26,26
  2443 00000AD8 1B001B001B001B00        	dw	27,27,27,27
  2444 00000AE0 1C001C001C001C00        	dw	28,28,28,28
  2445 00000AE8 1D001D001D001D00        	dw	29,29,29,29
  2446                                  	
  2447 00000AF0 1E001E001E001E00        	dw	30,30,30,30
  2448 00000AF8 1F001F001F001F00        	dw	31,31,31,31
  2449 00000B00 2000200020002000        	dw	32,32,32,32
  2450 00000B08 2100210021002100        	dw	33,33,33,33
  2451 00000B10 2200220022002200        	dw	34,34,34,34
  2452 00000B18 2300230023002300        	dw	35,35,35,35
  2453 00000B20 2400240024002400        	dw	36,36,36,36
  2454 00000B28 2500250025002500        	dw	37,37,37,37
  2455 00000B30 2600260026002600        	dw	38,38,38,38
  2456 00000B38 2700270027002700        	dw	39,39,39,39
  2457                                  
  2458 00000B40 2800280028002800        	dw	40,40,40,40
  2459 00000B48 2900290029002900        	dw	41,41,41,41
  2460 00000B50 2A002A002A002A00        	dw	42,42,42,42
  2461 00000B58 2B002B002B002B00        	dw	43,43,43,43
  2462 00000B60 2C002C002C002C00        	dw	44,44,44,44
  2463 00000B68 2D002D002D002D00        	dw	45,45,45,45
  2464 00000B70 2E002E002E002E00        	dw	46,46,46,46
  2465 00000B78 2F002F002F002F00        	dw	47,47,47,47
  2466 00000B80 3000300030003000        	dw	48,48,48,48
  2467 00000B88 3100310031003100        	dw	49,49,49,49
  2468                                  
  2469 00000B90 3200320032003200        	dw	50,50,50,50
  2470 00000B98 3300330033003300        	dw	51,51,51,51
  2471 00000BA0 3400340034003400        	dw	52,52,52,52
  2472 00000BA8 3500350035003500        	dw	53,53,53,53
  2473 00000BB0 3600360036003600        	dw	54,54,54,54
  2474 00000BB8 3700370037003700        	dw	55,55,55,55
  2475 00000BC0 3800380038003800        	dw	56,56,56,56
  2476 00000BC8 3900390039003900        	dw	57,57,57,57
  2477 00000BD0 3A003A003A003A00        	dw	58,58,58,58
  2478 00000BD8 3B003B003B003B00        	dw	59,59,59,59
  2479                                  
  2480 00000BE0 3C003C003C003C00        	dw	60,60,60,60
  2481 00000BE8 3D003D003D003D00        	dw	61,61,61,61
  2482 00000BF0 3E003E003E003E00        	dw	62,62,62,62
  2483 00000BF8 3F003F003F003F00        	dw	63,63,63,63
  2484 00000C00 4000400040004000        	dw	64,64,64,64
  2485 00000C08 4100410041004100        	dw	65,65,65,65
  2486 00000C10 4200420042004200        	dw	66,66,66,66
  2487 00000C18 4300430043004300        	dw	67,67,67,67
  2488 00000C20 4400440044004400        	dw	68,68,68,68
  2489 00000C28 4500450045004500        	dw	69,69,69,69
  2490                                  
  2491 00000C30 4600460046004600        	dw	70,70,70,70
  2492 00000C38 4700470047004700        	dw	71,71,71,71
  2493 00000C40 4800480048004800        	dw	72,72,72,72
  2494 00000C48 4900490049004900        	dw	73,73,73,73
  2495 00000C50 4A004A004A004A00        	dw	74,74,74,74
  2496 00000C58 4B004B004B004B00        	dw	75,75,75,75
  2497 00000C60 4C004C004C004C00        	dw	76,76,76,76
  2498 00000C68 4D004D004D004D00        	dw	77,77,77,77
  2499 00000C70 4E004E004E004E00        	dw	78,78,78,78
  2500 00000C78 4F004F004F004F00        	dw	79,79,79,79
  2501                                  
  2502                                  HorPosTab32:
  2503 00000C80 00000000<rep 10h>        times 16 dd 0*4
  2504 00000CC0 04000000<rep 10h>        times 16 dd 1*4
  2505 00000D00 08000000<rep 10h>        times 16 dd 2*4
  2506 00000D40 0C000000<rep 10h>        times 16 dd 3*4
  2507 00000D80 10000000<rep 10h>        times 16 dd 4*4
  2508 00000DC0 14000000<rep 10h>        times 16 dd 5*4
  2509 00000E00 18000000<rep 10h>        times 16 dd 6*4
  2510 00000E40 1C000000<rep 10h>        times 16 dd 7*4
  2511 00000E80 20000000<rep 10h>        times 16 dd 8*4
  2512 00000EC0 24000000<rep 10h>        times 16 dd 9*4
  2513 00000F00 28000000<rep 10h>        times 16 dd 10*4
  2514 00000F40 2C000000<rep 10h>        times 16 dd 11*4
  2515 00000F80 30000000<rep 10h>        times 16 dd 12*4
  2516 00000FC0 34000000<rep 10h>        times 16 dd 13*4
  2517 00001000 38000000<rep 10h>        times 16 dd 14*4
  2518 00001040 3C000000<rep 10h>        times 16 dd 15*4
  2519 00001080 40000000<rep 10h>        times 16 dd 16*4
  2520 000010C0 44000000<rep 10h>        times 16 dd 17*4
  2521 00001100 48000000<rep 10h>        times 16 dd 18*4
  2522 00001140 4C000000<rep 10h>        times 16 dd 19*4
  2523                                  
  2524 00001180 FFFFFFFF3FFFFFFF0F-     FillLeftTab32: times 320/16 	dd 	11111111111111111111111111111111b,11111111111111111111111100111111b,11111111111111111111111100001111b,11111111111111111111111100000011b,11111111111111111111111100000000b,11111111111111110011111100000000b,11111111111111110000111100000000b,11111111111111110000001100000000b,11111111111111110000000000000000b,11111111001111110000000000000000b,11111111000011110000000000000000b,11111111000000110000000000000000b,11111111000000000000000000000000b,00111111000000000000000000000000b,00001111000000000000000000000000b,00000011000000000000000000000000b
  2524 00001189 FFFFFF03FFFFFF00FF-
  2524 00001192 FFFF003FFFFF000FFF-
  2524 0000119B FF0003FFFF0000FFFF-
  2524 000011A4 00003FFF00000FFF00-
  2524 000011AD 0003FF000000FF0000-
  2524 000011B6 003F0000000F000000-
  2524 000011BF 03<rep 14h>        
  2525 00001680 C0000000F0000000FC-     FillRightTab32: times 320/16 	dd 	00000000000000000000000011000000b,00000000000000000000000011110000b,00000000000000000000000011111100b,00000000000000000000000011111111b,00000000000000001100000011111111b,00000000000000001111000011111111b,00000000000000001111110011111111b,00000000000000001111111111111111b,00000000110000001111111111111111b,00000000111100001111111111111111b,00000000111111001111111111111111b,00000000111111111111111111111111b,11000000111111111111111111111111b,11110000111111111111111111111111b,11111100111111111111111111111111b,11111111111111111111111111111111b
  2525 00001689 000000FF000000FFC0-
  2525 00001692 0000FFF00000FFFC00-
  2525 0000169B 00FFFF0000FFFFC000-
  2525 000016A4 FFFFF000FFFFFC00FF-
  2525 000016AD FFFF00FFFFFFC0FFFF-
  2525 000016B6 FFF0FFFFFFFCFFFFFF-
  2525 000016BF FF<rep 14h>        
  2526                                  
  2527 00001B80 00000000C0000000F0-     FillLeftTab32V2: times 320/16	dd	00000000000000000000000000000000b,00000000000000000000000011000000b,00000000000000000000000011110000b,00000000000000000000000011111100b,00000000000000000000000011111111b,00000000000000001100000011111111b,00000000000000001111000011111111b,00000000000000001111110011111111b,00000000000000001111111111111111b,00000000110000001111111111111111b,00000000111100001111111111111111b,00000000111111001111111111111111b,00000000111111111111111111111111b,11000000111111111111111111111111b,11110000111111111111111111111111b,11111100111111111111111111111111b
  2527 00001B89 000000FC000000FF00-
  2527 00001B92 0000FFC00000FFF000-
  2527 00001B9B 00FFFC0000FFFF0000-
  2527 00001BA4 FFFFC000FFFFF000FF-
  2527 00001BAD FFFC00FFFFFF00FFFF-
  2527 00001BB6 FFC0FFFFFFF0FFFFFF-
  2527 00001BBF FC<rep 14h>        
  2528 00002080 3FFFFFFF0FFFFFFF03-     FillRightTab32V2: times 320/16 	dd	11111111111111111111111100111111b,11111111111111111111111100001111b,11111111111111111111111100000011b,11111111111111111111111100000000b,11111111111111110011111100000000b,11111111111111110000111100000000b,11111111111111110000001100000000b,11111111111111110000000000000000b,11111111001111110000000000000000b,11111111000011110000000000000000b,11111111000000110000000000000000b,11111111000000000000000000000000b,00111111000000000000000000000000b,00001111000000000000000000000000b,00000011000000000000000000000000b,00000000000000000000000000000000b
  2528 00002089 FFFFFF00FFFFFF003F-
  2528 00002092 FFFF000FFFFF0003FF-
  2528 0000209B FF0000FFFF00003FFF-
  2528 000020A4 00000FFF000003FF00-
  2528 000020AD 0000FF0000003F0000-
  2528 000020B6 000F00000003000000-
  2528 000020BF 00<rep 14h>        
  2529                                  
  2530 00002580 [9706][A806][F406]-     FillTable:	dw	Fill000,Fill004,Fill008,Fill012,Fill016,Fill020,Fill024,Fill028,Fill032,Fill036,Fill040,Fill044,Fill048,Fill052,Fill056,Fill060,Fill064,Fill068,Fill072,Fill076,Fill080,Fill084
  2530 00002586 [4207][9407][E607]-
  2530 0000258C [3808][8A08][DC08]-
  2530 00002592 [2E09][8009][D209]-
  2530 00002598 [240A][760A][C80A]-
  2530 0000259E [1A0B][6C0B][BE0B]-
  2530 000025A4 [100C][620C][B40C]-
  2530 000025AA [060D]             
  2531                                  		
  2532 000025AC FC30FCFCCCFCFCFCFC-     Hex0	db 11111100b,00110000b,11111100b,11111100b,11001100b,11111100b,11111100b,11111100b,11111100b,11111100b,11111100b,11111100b,11111100b,11110000b,11111100b,11111100b
  2532 000025B5 FCFCFCFCF0FCFC     
  2533 000025BC CCF00C0CCCC0C00CCC-     Hex1	db 11001100b,11110000b,00001100b,00001100b,11001100b,11000000b,11000000b,00001100b,11001100b,11001100b,11001100b,11001100b,11000000b,11001100b,11000000b,11000000b
  2533 000025C5 CCCCCCC0CCC0C0     
  2534 000025CC CC30FCFCFCFCFC0CFC-     Hex2	db 11001100b,00110000b,11111100b,11111100b,11111100b,11111100b,11111100b,00001100b,11111100b,11111100b,11111100b,11110000b,11000000b,11001100b,11111100b,11111100b
  2534 000025D5 FCFCF0C0CCFCFC     
  2535 000025DC CC30C00C0C0CCC0CCC-     Hex3	db 11001100b,00110000b,11000000b,00001100b,00001100b,00001100b,11001100b,00001100b,11001100b,00001100b,11001100b,11001100b,11000000b,11001100b,11000000b,11000000b
  2535 000025E5 0CCCCCC0CCC0C0     
  2536 000025EC FCFCFCFC0CFCFC0CFC-     Hex4	db 11111100b,11111100b,11111100b,11111100b,00001100b,11111100b,11111100b,00001100b,11111100b,11111100b,11001100b,11111100b,11111100b,11110000b,11111100b,11000000b
  2536 000025F5 FCCCFCFCF0FCC0     
  2537                                    
  2538                                  ObjectPoints00:
  2539 000025FC E2FFE2FFE2FF            	dw	-30,-30,-30 		;+150
  2540 00002602 E2FFE2FF1E00            	dw	-30,-30,+30		;+150
  2541 00002608 E2FF1E00E2FF            	dw	-30,+30,-30		;+150
  2542 0000260E E2FF1E001E00            	dw	-30,+30,+30		;+150
  2543 00002614 1E00E2FFE2FF            	dw	+30,-30,-30 		;+150
  2544 0000261A 1E00E2FF1E00            	dw	+30,-30,+30 		;+150
  2545 00002620 1E001E00E2FF            	dw	+30,+30,-30		;+150
  2546 00002626 1E001E001E00            	dw	+30,+30,+30		;+150
  2547                                  
  2548 0000262C D4FED4FED4FE            	dw	-300,-300,-300 		;+150
  2549 00002632 D4FED4FE2C01            	dw	-300,-300,+300		;+150
  2550 00002638 D4FE2C01D4FE            	dw	-300,+300,-300		;+150
  2551 0000263E D4FE2C012C01            	dw	-300,+300,+300		;+150
  2552 00002644 2C01D4FED4FE            	dw	+300,-300,-300 		;+150
  2553 0000264A 2C01D4FE2C01            	dw	+300,-300,+300 		;+150
  2554 00002650 2C012C01D4FE            	dw	+300,+300,-300		;+150
  2555 00002656 2C012C012C01            	dw	+300,+300,+300		;+150
  2556                                  
  2557 0000265C 48F460F078EC            	dw	-3000,-4000,-5000 ;+150
  2558 00002662 48F460F08813            	dw	-3000,-4000,+5000 ;+150
  2559 00002668 48F4A00F78EC            	dw	-3000,+4000,-5000 ;+150
  2560 0000266E 48F4A00F8813            	dw	-3000,+4000,+5000 ;+150
  2561 00002674 B80B60F078EC            	dw	+3000,-4000,-5000 ;+150
  2562 0000267A B80B60F08813            	dw	+3000,-4000,+5000 ;+150
  2563 00002680 B80BA00F78EC            	dw	+3000,+4000,-5000;+150
  2564 00002686 B80BA00F8813            	dw	+3000,+4000,+5000 ;+150
  2565                                  	
  2566                                  ObjectLines00:
  2567 0000268C 0001                    	db	0,1
  2568 0000268E 0103                    	db	1,3
  2569 00002690 0302                    	db	3,2
  2570 00002692 0200                    	db	2,0
  2571 00002694 0405                    	db	4,5
  2572 00002696 0507                    	db	5,7
  2573 00002698 0706                    	db	7,6
  2574 0000269A 0604                    	db	6,4
  2575 0000269C 0004                    	db	0,4
  2576 0000269E 0105                    	db	1,5
  2577 000026A0 0206                    	db	2,6
  2578 000026A2 0307                    	db	3,7
  2579                                  
  2580 000026A4 C800                    HOffset:	dw	200
  2581 000026A6 C800                    VOffset:	dw	200
  2582                                  
  2583 000026A8 0CFE                    XOffset:	dw	-500
  2584 000026AA 0CFE                    YOffset:	dw	-500
  2585 000026AC C800                    ZOffset:	dw	200 ; 2500	
  2586                                  
  2587                                  pershtab8:
  2588 000026AE 9F                       db 159
  2589 000026AF 9F                       db 159
  2590 000026B0 9F                       db 159
  2591 000026B1 9F                       db 159
  2592 000026B2 9E                       db 158
  2593 000026B3 9E                       db 158
  2594 000026B4 9E                       db 158
  2595 000026B5 9E                       db 158
  2596 000026B6 9E                       db 158
  2597 000026B7 9D                       db 157
  2598 000026B8 9D                       db 157
  2599 000026B9 9D                       db 157
  2600 000026BA 9D                       db 157
  2601 000026BB 9C                       db 156
  2602 000026BC 9C                       db 156
  2603 000026BD 9C                       db 156
  2604 000026BE 9C                       db 156
  2605 000026BF 9C                       db 156
  2606 000026C0 9B                       db 155
  2607 000026C1 9B                       db 155
  2608 000026C2 9B                       db 155
  2609 000026C3 9B                       db 155
  2610 000026C4 9B                       db 155
  2611 000026C5 9A                       db 154
  2612 000026C6 9A                       db 154
  2613 000026C7 9A                       db 154
  2614 000026C8 9A                       db 154
  2615 000026C9 99                       db 153
  2616 000026CA 99                       db 153
  2617 000026CB 99                       db 153
  2618 000026CC 99                       db 153
  2619 000026CD 99                       db 153
  2620 000026CE 98                       db 152
  2621 000026CF 98                       db 152
  2622 000026D0 98                       db 152
  2623 000026D1 98                       db 152
  2624 000026D2 98                       db 152
  2625 000026D3 97                       db 151
  2626 000026D4 97                       db 151
  2627 000026D5 97                       db 151
  2628 000026D6 97                       db 151
  2629 000026D7 96                       db 150
  2630 000026D8 96                       db 150
  2631 000026D9 96                       db 150
  2632 000026DA 96                       db 150
  2633 000026DB 96                       db 150
  2634 000026DC 95                       db 149
  2635 000026DD 95                       db 149
  2636 000026DE 95                       db 149
  2637 000026DF 95                       db 149
  2638 000026E0 95                       db 149
  2639 000026E1 94                       db 148
  2640 000026E2 94                       db 148
  2641 000026E3 94                       db 148
  2642 000026E4 94                       db 148
  2643 000026E5 93                       db 147
  2644 000026E6 93                       db 147
  2645 000026E7 93                       db 147
  2646 000026E8 93                       db 147
  2647 000026E9 93                       db 147
  2648 000026EA 92                       db 146
  2649 000026EB 92                       db 146
  2650 000026EC 92                       db 146
  2651 000026ED 92                       db 146
  2652 000026EE 92                       db 146
  2653 000026EF 91                       db 145
  2654 000026F0 91                       db 145
  2655 000026F1 91                       db 145
  2656 000026F2 91                       db 145
  2657 000026F3 90                       db 144
  2658 000026F4 90                       db 144
  2659 000026F5 90                       db 144
  2660 000026F6 90                       db 144
  2661 000026F7 90                       db 144
  2662 000026F8 8F                       db 143
  2663 000026F9 8F                       db 143
  2664 000026FA 8F                       db 143
  2665 000026FB 8F                       db 143
  2666 000026FC 8F                       db 143
  2667 000026FD 8E                       db 142
  2668 000026FE 8E                       db 142
  2669 000026FF 8E                       db 142
  2670 00002700 8E                       db 142
  2671 00002701 8D                       db 141
  2672 00002702 8D                       db 141
  2673 00002703 8D                       db 141
  2674 00002704 8D                       db 141
  2675 00002705 8D                       db 141
  2676 00002706 8C                       db 140
  2677 00002707 8C                       db 140
  2678 00002708 8C                       db 140
  2679 00002709 8C                       db 140
  2680 0000270A 8C                       db 140
  2681 0000270B 8B                       db 139
  2682 0000270C 8B                       db 139
  2683 0000270D 8B                       db 139
  2684 0000270E 8B                       db 139
  2685 0000270F 8A                       db 138
  2686 00002710 8A                       db 138
  2687 00002711 8A                       db 138
  2688 00002712 8A                       db 138
  2689 00002713 8A                       db 138
  2690 00002714 89                       db 137
  2691 00002715 89                       db 137
  2692 00002716 89                       db 137
  2693 00002717 89                       db 137
  2694 00002718 89                       db 137
  2695 00002719 88                       db 136
  2696 0000271A 88                       db 136
  2697 0000271B 88                       db 136
  2698 0000271C 88                       db 136
  2699 0000271D 87                       db 135
  2700 0000271E 87                       db 135
  2701 0000271F 87                       db 135
  2702 00002720 87                       db 135
  2703 00002721 87                       db 135
  2704 00002722 86                       db 134
  2705 00002723 86                       db 134
  2706 00002724 86                       db 134
  2707 00002725 86                       db 134
  2708 00002726 86                       db 134
  2709 00002727 85                       db 133
  2710 00002728 85                       db 133
  2711 00002729 85                       db 133
  2712 0000272A 85                       db 133
  2713 0000272B 84                       db 132
  2714 0000272C 84                       db 132
  2715 0000272D 84                       db 132
  2716 0000272E 84                       db 132
  2717 0000272F 84                       db 132
  2718 00002730 83                       db 131
  2719 00002731 83                       db 131
  2720 00002732 83                       db 131
  2721 00002733 83                       db 131
  2722 00002734 82                       db 130
  2723 00002735 82                       db 130
  2724 00002736 82                       db 130
  2725 00002737 82                       db 130
  2726 00002738 82                       db 130
  2727 00002739 81                       db 129
  2728 0000273A 81                       db 129
  2729 0000273B 81                       db 129
  2730 0000273C 81                       db 129
  2731 0000273D 81                       db 129
  2732 0000273E 80                       db 128
  2733 0000273F 80                       db 128
  2734 00002740 80                       db 128
  2735 00002741 80                       db 128
  2736 00002742 7F                       db 127
  2737 00002743 7F                       db 127
  2738 00002744 7F                       db 127
  2739 00002745 7F                       db 127
  2740 00002746 7F                       db 127
  2741 00002747 7E                       db 126
  2742 00002748 7E                       db 126
  2743 00002749 7E                       db 126
  2744 0000274A 7E                       db 126
  2745 0000274B 7E                       db 126
  2746 0000274C 7D                       db 125
  2747 0000274D 7D                       db 125
  2748 0000274E 7D                       db 125
  2749 0000274F 7D                       db 125
  2750 00002750 7C                       db 124
  2751 00002751 7C                       db 124
  2752 00002752 7C                       db 124
  2753 00002753 7C                       db 124
  2754 00002754 7C                       db 124
  2755 00002755 7B                       db 123
  2756 00002756 7B                       db 123
  2757 00002757 7B                       db 123
  2758 00002758 7B                       db 123
  2759 00002759 7B                       db 123
  2760 0000275A 7A                       db 122
  2761 0000275B 7A                       db 122
  2762 0000275C 7A                       db 122
  2763 0000275D 7A                       db 122
  2764 0000275E 79                       db 121
  2765 0000275F 79                       db 121
  2766 00002760 79                       db 121
  2767 00002761 79                       db 121
  2768 00002762 79                       db 121
  2769 00002763 78                       db 120
  2770 00002764 78                       db 120
  2771 00002765 78                       db 120
  2772 00002766 78                       db 120
  2773 00002767 78                       db 120
  2774 00002768 77                       db 119
  2775 00002769 77                       db 119
  2776 0000276A 77                       db 119
  2777 0000276B 77                       db 119
  2778 0000276C 76                       db 118
  2779 0000276D 76                       db 118
  2780 0000276E 76                       db 118
  2781 0000276F 76                       db 118
  2782 00002770 76                       db 118
  2783 00002771 75                       db 117
  2784 00002772 75                       db 117
  2785 00002773 75                       db 117
  2786 00002774 75                       db 117
  2787 00002775 75                       db 117
  2788 00002776 74                       db 116
  2789 00002777 74                       db 116
  2790 00002778 74                       db 116
  2791 00002779 74                       db 116
  2792 0000277A 73                       db 115
  2793 0000277B 73                       db 115
  2794 0000277C 73                       db 115
  2795 0000277D 73                       db 115
  2796 0000277E 73                       db 115
  2797 0000277F 72                       db 114
  2798 00002780 72                       db 114
  2799 00002781 72                       db 114
  2800 00002782 72                       db 114
  2801 00002783 72                       db 114
  2802 00002784 71                       db 113
  2803 00002785 71                       db 113
  2804 00002786 71                       db 113
  2805 00002787 71                       db 113
  2806 00002788 70                       db 112
  2807 00002789 70                       db 112
  2808 0000278A 70                       db 112
  2809 0000278B 70                       db 112
  2810 0000278C 70                       db 112
  2811 0000278D 6F                       db 111
  2812 0000278E 6F                       db 111
  2813 0000278F 6F                       db 111
  2814 00002790 6F                       db 111
  2815 00002791 6F                       db 111
  2816 00002792 6E                       db 110
  2817 00002793 6E                       db 110
  2818 00002794 6E                       db 110
  2819 00002795 6E                       db 110
  2820 00002796 6D                       db 109
  2821 00002797 6D                       db 109
  2822 00002798 6D                       db 109
  2823 00002799 6D                       db 109
  2824 0000279A 6D                       db 109
  2825 0000279B 6C                       db 108
  2826 0000279C 6C                       db 108
  2827 0000279D 6C                       db 108
  2828 0000279E 6C                       db 108
  2829 0000279F 6C                       db 108
  2830 000027A0 6B                       db 107
  2831 000027A1 6B                       db 107
  2832 000027A2 6B                       db 107
  2833 000027A3 6B                       db 107
  2834 000027A4 6A                       db 106
  2835 000027A5 6A                       db 106
  2836 000027A6 6A                       db 106
  2837 000027A7 6A                       db 106
  2838 000027A8 6A                       db 106
  2839 000027A9 69                       db 105
  2840 000027AA 69                       db 105
  2841 000027AB 69                       db 105
  2842 000027AC 69                       db 105
  2843 000027AD 69                       db 105
  2844                                  
  2845                                  persvtab8:
  2846 000027AE C7                       db 199
  2847 000027AF C7                       db 199
  2848 000027B0 C7                       db 199
  2849 000027B1 C6                       db 198
  2850 000027B2 C6                       db 198
  2851 000027B3 C6                       db 198
  2852 000027B4 C6                       db 198
  2853 000027B5 C5                       db 197
  2854 000027B6 C5                       db 197
  2855 000027B7 C5                       db 197
  2856 000027B8 C5                       db 197
  2857 000027B9 C4                       db 196
  2858 000027BA C4                       db 196
  2859 000027BB C4                       db 196
  2860 000027BC C3                       db 195
  2861 000027BD C3                       db 195
  2862 000027BE C3                       db 195
  2863 000027BF C3                       db 195
  2864 000027C0 C2                       db 194
  2865 000027C1 C2                       db 194
  2866 000027C2 C2                       db 194
  2867 000027C3 C2                       db 194
  2868 000027C4 C1                       db 193
  2869 000027C5 C1                       db 193
  2870 000027C6 C1                       db 193
  2871 000027C7 C0                       db 192
  2872 000027C8 C0                       db 192
  2873 000027C9 C0                       db 192
  2874 000027CA C0                       db 192
  2875 000027CB BF                       db 191
  2876 000027CC BF                       db 191
  2877 000027CD BF                       db 191
  2878 000027CE BF                       db 191
  2879 000027CF BE                       db 190
  2880 000027D0 BE                       db 190
  2881 000027D1 BE                       db 190
  2882 000027D2 BE                       db 190
  2883 000027D3 BD                       db 189
  2884 000027D4 BD                       db 189
  2885 000027D5 BD                       db 189
  2886 000027D6 BC                       db 188
  2887 000027D7 BC                       db 188
  2888 000027D8 BC                       db 188
  2889 000027D9 BC                       db 188
  2890 000027DA BB                       db 187
  2891 000027DB BB                       db 187
  2892 000027DC BB                       db 187
  2893 000027DD BB                       db 187
  2894 000027DE BA                       db 186
  2895 000027DF BA                       db 186
  2896 000027E0 BA                       db 186
  2897 000027E1 B9                       db 185
  2898 000027E2 B9                       db 185
  2899 000027E3 B9                       db 185
  2900 000027E4 B9                       db 185
  2901 000027E5 B8                       db 184
  2902 000027E6 B8                       db 184
  2903 000027E7 B8                       db 184
  2904 000027E8 B8                       db 184
  2905 000027E9 B7                       db 183
  2906 000027EA B7                       db 183
  2907 000027EB B7                       db 183
  2908 000027EC B7                       db 183
  2909 000027ED B6                       db 182
  2910 000027EE B6                       db 182
  2911 000027EF B6                       db 182
  2912 000027F0 B5                       db 181
  2913 000027F1 B5                       db 181
  2914 000027F2 B5                       db 181
  2915 000027F3 B5                       db 181
  2916 000027F4 B4                       db 180
  2917 000027F5 B4                       db 180
  2918 000027F6 B4                       db 180
  2919 000027F7 B4                       db 180
  2920 000027F8 B3                       db 179
  2921 000027F9 B3                       db 179
  2922 000027FA B3                       db 179
  2923 000027FB B2                       db 178
  2924 000027FC B2                       db 178
  2925 000027FD B2                       db 178
  2926 000027FE B2                       db 178
  2927 000027FF B1                       db 177
  2928 00002800 B1                       db 177
  2929 00002801 B1                       db 177
  2930 00002802 B1                       db 177
  2931 00002803 B0                       db 176
  2932 00002804 B0                       db 176
  2933 00002805 B0                       db 176
  2934 00002806 B0                       db 176
  2935 00002807 AF                       db 175
  2936 00002808 AF                       db 175
  2937 00002809 AF                       db 175
  2938 0000280A AE                       db 174
  2939 0000280B AE                       db 174
  2940 0000280C AE                       db 174
  2941 0000280D AE                       db 174
  2942 0000280E AD                       db 173
  2943 0000280F AD                       db 173
  2944 00002810 AD                       db 173
  2945 00002811 AD                       db 173
  2946 00002812 AC                       db 172
  2947 00002813 AC                       db 172
  2948 00002814 AC                       db 172
  2949 00002815 AB                       db 171
  2950 00002816 AB                       db 171
  2951 00002817 AB                       db 171
  2952 00002818 AB                       db 171
  2953 00002819 AA                       db 170
  2954 0000281A AA                       db 170
  2955 0000281B AA                       db 170
  2956 0000281C AA                       db 170
  2957 0000281D A9                       db 169
  2958 0000281E A9                       db 169
  2959 0000281F A9                       db 169
  2960 00002820 A9                       db 169
  2961 00002821 A8                       db 168
  2962 00002822 A8                       db 168
  2963 00002823 A8                       db 168
  2964 00002824 A7                       db 167
  2965 00002825 A7                       db 167
  2966 00002826 A7                       db 167
  2967 00002827 A7                       db 167
  2968 00002828 A6                       db 166
  2969 00002829 A6                       db 166
  2970 0000282A A6                       db 166
  2971 0000282B A6                       db 166
  2972 0000282C A5                       db 165
  2973 0000282D A5                       db 165
  2974 0000282E A5                       db 165
  2975 0000282F A4                       db 164
  2976 00002830 A4                       db 164
  2977 00002831 A4                       db 164
  2978 00002832 A4                       db 164
  2979 00002833 A3                       db 163
  2980 00002834 A3                       db 163
  2981 00002835 A3                       db 163
  2982 00002836 A3                       db 163
  2983 00002837 A2                       db 162
  2984 00002838 A2                       db 162
  2985 00002839 A2                       db 162
  2986 0000283A A1                       db 161
  2987 0000283B A1                       db 161
  2988 0000283C A1                       db 161
  2989 0000283D A1                       db 161
  2990 0000283E A0                       db 160
  2991 0000283F A0                       db 160
  2992 00002840 A0                       db 160
  2993 00002841 A0                       db 160
  2994 00002842 9F                       db 159
  2995 00002843 9F                       db 159
  2996 00002844 9F                       db 159
  2997 00002845 9F                       db 159
  2998 00002846 9E                       db 158
  2999 00002847 9E                       db 158
  3000 00002848 9E                       db 158
  3001 00002849 9D                       db 157
  3002 0000284A 9D                       db 157
  3003 0000284B 9D                       db 157
  3004 0000284C 9D                       db 157
  3005 0000284D 9C                       db 156
  3006 0000284E 9C                       db 156
  3007 0000284F 9C                       db 156
  3008 00002850 9C                       db 156
  3009 00002851 9B                       db 155
  3010 00002852 9B                       db 155
  3011 00002853 9B                       db 155
  3012 00002854 9A                       db 154
  3013 00002855 9A                       db 154
  3014 00002856 9A                       db 154
  3015 00002857 9A                       db 154
  3016 00002858 99                       db 153
  3017 00002859 99                       db 153
  3018 0000285A 99                       db 153
  3019 0000285B 99                       db 153
  3020 0000285C 98                       db 152
  3021 0000285D 98                       db 152
  3022 0000285E 98                       db 152
  3023 0000285F 98                       db 152
  3024 00002860 97                       db 151
  3025 00002861 97                       db 151
  3026 00002862 97                       db 151
  3027 00002863 96                       db 150
  3028 00002864 96                       db 150
  3029 00002865 96                       db 150
  3030 00002866 96                       db 150
  3031 00002867 95                       db 149
  3032 00002868 95                       db 149
  3033 00002869 95                       db 149
  3034 0000286A 95                       db 149
  3035 0000286B 94                       db 148
  3036 0000286C 94                       db 148
  3037 0000286D 94                       db 148
  3038 0000286E 93                       db 147
  3039 0000286F 93                       db 147
  3040 00002870 93                       db 147
  3041 00002871 93                       db 147
  3042 00002872 92                       db 146
  3043 00002873 92                       db 146
  3044 00002874 92                       db 146
  3045 00002875 92                       db 146
  3046 00002876 91                       db 145
  3047 00002877 91                       db 145
  3048 00002878 91                       db 145
  3049 00002879 91                       db 145
  3050 0000287A 90                       db 144
  3051 0000287B 90                       db 144
  3052 0000287C 90                       db 144
  3053 0000287D 8F                       db 143
  3054 0000287E 8F                       db 143
  3055 0000287F 8F                       db 143
  3056 00002880 8F                       db 143
  3057 00002881 8E                       db 142
  3058 00002882 8E                       db 142
  3059 00002883 8E                       db 142
  3060 00002884 8E                       db 142
  3061 00002885 8D                       db 141
  3062 00002886 8D                       db 141
  3063 00002887 8D                       db 141
  3064 00002888 8C                       db 140
  3065 00002889 8C                       db 140
  3066 0000288A 8C                       db 140
  3067 0000288B 8C                       db 140
  3068 0000288C 8B                       db 139
  3069 0000288D 8B                       db 139
  3070 0000288E 8B                       db 139
  3071 0000288F 8B                       db 139
  3072 00002890 8A                       db 138
  3073 00002891 8A                       db 138
  3074 00002892 8A                       db 138
  3075 00002893 8A                       db 138
  3076 00002894 89                       db 137
  3077 00002895 89                       db 137
  3078 00002896 89                       db 137
  3079 00002897 88                       db 136
  3080 00002898 88                       db 136
  3081 00002899 88                       db 136
  3082 0000289A 88                       db 136
  3083 0000289B 87                       db 135
  3084 0000289C 87                       db 135
  3085 0000289D 87                       db 135
  3086 0000289E 87                       db 135
  3087 0000289F 86                       db 134
  3088 000028A0 86                       db 134
  3089 000028A1 86                       db 134
  3090 000028A2 85                       db 133
  3091 000028A3 85                       db 133
  3092 000028A4 85                       db 133
  3093 000028A5 85                       db 133
  3094 000028A6 84                       db 132
  3095 000028A7 84                       db 132
  3096 000028A8 84                       db 132
  3097 000028A9 84                       db 132
  3098 000028AA 83                       db 131
  3099 000028AB 83                       db 131
  3100 000028AC 83                       db 131
  3101 000028AD 83                       db 131
  3102                                  
  3103 000028AE 0000                    testx dw 0
  3104 000028B0 0000                    testy dw 0
  3105 000028B2 0000                    testz dw 0
  3106                                  	
  3107                                  %include  'sin256.inc'
     1                              <1> sintab:
     2 000028B4 000001020303040506- <1>  db     0,    0,    1,    2,    3,    3,    4,    5,    6,    7,    7,    8,    9,   10,   10,   11 ; 16
     2 000028BD 070708090A0A0B      <1>
     3 000028C4 0C0D0E0E0F10111112- <1>  db    12,   13,   14,   14,   15,   16,   17,   17,   18,   19,   20,   21,   21,   22,   23,   24 ; 32
     3 000028CD 13141515161718      <1>
     4 000028D4 18191A1B1B1C1D1E1E- <1>  db    24,   25,   26,   27,   27,   28,   29,   30,   30,   31,   32,   33,   34,   34,   35,   36 ; 48
     4 000028DD 1F202122222324      <1>
     5 000028E4 252526272828292A2A- <1>  db    37,   37,   38,   39,   40,   40,   41,   42,   42,   43,   44,   45,   45,   46,   47,   48 ; 64
     5 000028ED 2B2C2D2D2E2F30      <1>
     6 000028F4 303132323334353536- <1>  db    48,   49,   50,   50,   51,   52,   53,   53,   54,   55,   55,   56,   57,   58,   58,   59 ; 80
     6 000028FD 373738393A3A3B      <1>
     7 00002904 3C3C3D3E3E3F404041- <1>  db    60,   60,   61,   62,   62,   63,   64,   64,   65,   66,   66,   67,   68,   68,   69,   70 ; 96
     7 0000290D 42424344444546      <1>
     8 00002914 46474848494A4A4B4B- <1>  db    70,   71,   72,   72,   73,   74,   74,   75,   75,   76,   77,   77,   78,   79,   79,   80 ; 112
     8 0000291D 4C4D4D4E4F4F50      <1>
     9 00002924 505152525353545555- <1>  db    80,   81,   82,   82,   83,   83,   84,   85,   85,   86,   86,   87,   87,   88,   89,   89 ; 128
     9 0000292D 56565757585959      <1>
    10 00002934 5A5A5B5B5C5C5D5D5E- <1>  db    90,   90,   91,   91,   92,   92,   93,   93,   94,   95,   95,   96,   96,   97,   97,   98 ; 144
    10 0000293D 5F5F6060616162      <1>
    11 00002944 626363646465656566- <1>  db    98,   99,   99,  100,  100,  101,  101,  101,  102,  102,  103,  103,  104,  104,  105,  105 ; 160
    11 0000294D 66676768686969      <1>
    12 00002954 6A6A6A6B6B6C6C6C6D- <1>  db   106,  106,  106,  107,  107,  108,  108,  108,  109,  109,  110,  110,  110,  111,  111,  112 ; 176
    12 0000295D 6D6E6E6E6F6F70      <1>
    13 00002964 707071717172727273- <1>  db   112,  112,  113,  113,  113,  114,  114,  114,  115,  115,  115,  116,  116,  116,  117,  117 ; 192
    13 0000296D 73737474747575      <1>
    14 00002974 757676767677777778- <1>  db   117,  118,  118,  118,  118,  119,  119,  119,  120,  120,  120,  120,  121,  121,  121,  121 ; 208
    14 0000297D 78787879797979      <1>
    15 00002984 7A7A7A7A7A7B7B7B7B- <1>  db   122,  122,  122,  122,  122,  123,  123,  123,  123,  123,  124,  124,  124,  124,  124,  124 ; 224
    15 0000298D 7B7C7C7C7C7C7C      <1>
    16 00002994 7D7D7D7D7D7D7D7E7E- <1>  db   125,  125,  125,  125,  125,  125,  125,  126,  126,  126,  126,  126,  126,  126,  126,  126 ; 240
    16 0000299D 7E7E7E7E7E7E7E      <1>
    17 000029A4 7E7E7F7F7F7F7F7F7F- <1>  db   126,  126,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127 ; 256
    17 000029AD 7F7F7F7F7F7F7F      <1>
    18                              <1> 
    19 000029B4 7F7F7F7F7F7F7F7F7F- <1>  db   127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  127,  126,  126 ; 272
    19 000029BD 7F7F7F7F7F7E7E      <1>
    20 000029C4 7E7E7E7E7E7E7E7E7E- <1>  db   126,  126,  126,  126,  126,  126,  126,  126,  126,  125,  125,  125,  125,  125,  125,  125 ; 288
    20 000029CD 7D7D7D7D7D7D7D      <1>
    21 000029D4 7C7C7C7C7C7C7B7B7B- <1>  db   124,  124,  124,  124,  124,  124,  123,  123,  123,  123,  123,  122,  122,  122,  122,  122 ; 304
    21 000029DD 7B7B7A7A7A7A7A      <1>
    22 000029E4 797979797878787877- <1>  db   121,  121,  121,  121,  120,  120,  120,  120,  119,  119,  119,  118,  118,  118,  118,  117 ; 320
    22 000029ED 77777676767675      <1>
    23 000029F4 757574747473737372- <1>  db   117,  117,  116,  116,  116,  115,  115,  115,  114,  114,  114,  113,  113,  113,  112,  112 ; 336
    23 000029FD 72727171717070      <1>
    24 00002A04 706F6F6E6E6E6D6D6C- <1>  db   112,  111,  111,  110,  110,  110,  109,  109,  108,  108,  108,  107,  107,  106,  106,  106 ; 352
    24 00002A0D 6C6C6B6B6A6A6A      <1>
    25 00002A14 696968686767666665- <1>  db   105,  105,  104,  104,  103,  103,  102,  102,  101,  101,  101,  100,  100,   99,   99,   98 ; 368
    25 00002A1D 65656464636362      <1>
    26 00002A24 62616160605F5F5E5D- <1>  db    98,   97,   97,   96,   96,   95,   95,   94,   93,   93,   92,   92,   91,   91,   90,   90 ; 384
    26 00002A2D 5D5C5C5B5B5A5A      <1>
    27 00002A34 595958575756565555- <1>  db    89,   89,   88,   87,   87,   86,   86,   85,   85,   84,   83,   83,   82,   82,   81,   80 ; 400
    27 00002A3D 54535352525150      <1>
    28 00002A44 504F4F4E4D4D4C4B4B- <1>  db    80,   79,   79,   78,   77,   77,   76,   75,   75,   74,   74,   73,   72,   72,   71,   70 ; 416
    28 00002A4D 4A4A4948484746      <1>
    29 00002A54 464544444342424140- <1>  db    70,   69,   68,   68,   67,   66,   66,   65,   64,   64,   63,   62,   62,   61,   60,   60 ; 432
    29 00002A5D 403F3E3E3D3C3C      <1>
    30 00002A64 3B3A3A393837373635- <1>  db    59,   58,   58,   57,   56,   55,   55,   54,   53,   53,   52,   51,   50,   50,   49,   48 ; 448
    30 00002A6D 35343332323130      <1>
    31 00002A74 302F2E2D2D2C2B2A2A- <1>  db    48,   47,   46,   45,   45,   44,   43,   42,   42,   41,   40,   40,   39,   38,   37,   37 ; 464
    31 00002A7D 29282827262525      <1>
    32 00002A84 2423222221201F1E1E- <1>  db    36,   35,   34,   34,   33,   32,   31,   30,   30,   29,   28,   27,   27,   26,   25,   24 ; 480
    32 00002A8D 1D1C1B1B1A1918      <1>
    33 00002A94 181716151514131211- <1>  db    24,   23,   22,   21,   21,   20,   19,   18,   17,   17,   16,   15,   14,   14,   13,   12 ; 496
    33 00002A9D 11100F0E0E0D0C      <1>
    34 00002AA4 0B0A0A090807070605- <1>  db    11,   10,   10,    9,    8,    7,    7,    6,    5,    4,    3,    3,    2,    1,    0,    0 ; 512
    34 00002AAD 04030302010000      <1>
    35                              <1>  
    36 00002AB4 0000FFFEFDFDFCFBFA- <1>  db     0,    0,   -1,   -2,   -3,   -3,   -4,   -5,   -6,   -7,   -7,   -8,   -9,  -10,  -10,  -11 ; 528
    36 00002ABD F9F9F8F7F6F6F5      <1>
    37 00002AC4 F4F3F2F2F1F0EFEFEE- <1>  db   -12,  -13,  -14,  -14,  -15,  -16,  -17,  -17,  -18,  -19,  -20,  -21,  -21,  -22,  -23,  -24 ; 544
    37 00002ACD EDECEBEBEAE9E8      <1>
    38 00002AD4 E8E7E6E5E5E4E3E2E2- <1>  db   -24,  -25,  -26,  -27,  -27,  -28,  -29,  -30,  -30,  -31,  -32,  -33,  -34,  -34,  -35,  -36 ; 560
    38 00002ADD E1E0DFDEDEDDDC      <1>
    39 00002AE4 DBDBDAD9D8D8D7D6D6- <1>  db   -37,  -37,  -38,  -39,  -40,  -40,  -41,  -42,  -42,  -43,  -44,  -45,  -45,  -46,  -47,  -48 ; 576
    39 00002AED D5D4D3D3D2D1D0      <1>
    40 00002AF4 D0CFCECECDCCCBCBCA- <1>  db   -48,  -49,  -50,  -50,  -51,  -52,  -53,  -53,  -54,  -55,  -55,  -56,  -57,  -58,  -58,  -59 ; 592
    40 00002AFD C9C9C8C7C6C6C5      <1>
    41 00002B04 C4C4C3C2C2C1C0C0BF- <1>  db   -60,  -60,  -61,  -62,  -62,  -63,  -64,  -64,  -65,  -66,  -66,  -67,  -68,  -68,  -69,  -70 ; 608
    41 00002B0D BEBEBDBCBCBBBA      <1>
    42 00002B14 BAB9B8B8B7B6B6B5B5- <1>  db   -70,  -71,  -72,  -72,  -73,  -74,  -74,  -75,  -75,  -76,  -77,  -77,  -78,  -79,  -79,  -80 ; 624
    42 00002B1D B4B3B3B2B1B1B0      <1>
    43 00002B24 B0AFAEAEADADACABAB- <1>  db   -80,  -81,  -82,  -82,  -83,  -83,  -84,  -85,  -85,  -86,  -86,  -87,  -87,  -88,  -89,  -89 ; 640
    43 00002B2D AAAAA9A9A8A7A7      <1>
    44 00002B34 A6A6A5A5A4A4A3A3A2- <1>  db   -90,  -90,  -91,  -91,  -92,  -92,  -93,  -93,  -94,  -95,  -95,  -96,  -96,  -97,  -97,  -98 ; 656
    44 00002B3D A1A1A0A09F9F9E      <1>
    45 00002B44 9E9D9D9C9C9B9B9B9A- <1>  db   -98,  -99,  -99, -100, -100, -101, -101, -101, -102, -102, -103, -103, -104, -104, -105, -105 ; 672
    45 00002B4D 9A999998989797      <1>
    46 00002B54 969696959594949493- <1>  db  -106, -106, -106, -107, -107, -108, -108, -108, -109, -109, -110, -110, -110, -111, -111, -112 ; 688
    46 00002B5D 93929292919190      <1>
    47 00002B64 90908F8F8F8E8E8E8D- <1>  db  -112, -112, -113, -113, -113, -114, -114, -114, -115, -115, -115, -116, -116, -116, -117, -117 ; 704
    47 00002B6D 8D8D8C8C8C8B8B      <1>
    48 00002B74 8B8A8A8A8A89898988- <1>  db  -117, -118, -118, -118, -118, -119, -119, -119, -120, -120, -120, -120, -121, -121, -121, -121 ; 720
    48 00002B7D 88888887878787      <1>
    49 00002B84 868686868685858585- <1>  db  -122, -122, -122, -122, -122, -123, -123, -123, -123, -123, -124, -124, -124, -124, -124, -124 ; 736
    49 00002B8D 85848484848484      <1>
    50 00002B94 838383838383838282- <1>  db  -125, -125, -125, -125, -125, -125, -125, -126, -126, -126, -126, -126, -126, -126, -126, -126 ; 752
    50 00002B9D 82828282828282      <1>
    51 00002BA4 828281818181818181- <1>  db  -126, -126, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127 ; 768
    51 00002BAD 81818181818181      <1>
    52                              <1>  
    53 00002BB4 818181818181818181- <1>  db  -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -126, -126 ; 784
    53 00002BBD 81818181818282      <1>
    54 00002BC4 828282828282828282- <1>  db  -126, -126, -126, -126, -126, -126, -126, -126, -126, -125, -125, -125, -125, -125, -125, -125 ; 800
    54 00002BCD 83838383838383      <1>
    55 00002BD4 848484848484858585- <1>  db  -124, -124, -124, -124, -124, -124, -123, -123, -123, -123, -123, -122, -122, -122, -122, -122 ; 816
    55 00002BDD 85858686868686      <1>
    56 00002BE4 878787878888888889- <1>  db  -121, -121, -121, -121, -120, -120, -120, -120, -119, -119, -119, -118, -118, -118, -118, -117 ; 832
    56 00002BED 89898A8A8A8A8B      <1>
    57 00002BF4 8B8B8C8C8C8D8D8D8E- <1>  db  -117, -117, -116, -116, -116, -115, -115, -115, -114, -114, -114, -113, -113, -113, -112, -112 ; 848
    57 00002BFD 8E8E8F8F8F9090      <1>
    58 00002C04 909191929292939394- <1>  db  -112, -111, -111, -110, -110, -110, -109, -109, -108, -108, -108, -107, -107, -106, -106, -106 ; 864
    58 00002C0D 94949595969696      <1>
    59 00002C14 9797989899999A9A9B- <1>  db  -105, -105, -104, -104, -103, -103, -102, -102, -101, -101, -101, -100, -100,  -99,  -99,  -98 ; 880
    59 00002C1D 9B9B9C9C9D9D9E      <1>
    60 00002C24 9E9F9FA0A0A1A1A2A3- <1>  db   -98,  -97,  -97,  -96,  -96,  -95,  -95,  -94,  -93,  -93,  -92,  -92,  -91,  -91,  -90,  -90 ; 896
    60 00002C2D A3A4A4A5A5A6A6      <1>
    61 00002C34 A7A7A8A9A9AAAAABAB- <1>  db   -89,  -89,  -88,  -87,  -87,  -86,  -86,  -85,  -85,  -84,  -83,  -83,  -82,  -82,  -81,  -80 ; 912
    61 00002C3D ACADADAEAEAFB0      <1>
    62 00002C44 B0B1B1B2B3B3B4B5B5- <1>  db   -80,  -79,  -79,  -78,  -77,  -77,  -76,  -75,  -75,  -74,  -74,  -73,  -72,  -72,  -71,  -70 ; 928
    62 00002C4D B6B6B7B8B8B9BA      <1>
    63 00002C54 BABBBCBCBDBEBEBFC0- <1>  db   -70,  -69,  -68,  -68,  -67,  -66,  -66,  -65,  -64,  -64,  -63,  -62,  -62,  -61,  -60,  -60 ; 944
    63 00002C5D C0C1C2C2C3C4C4      <1>
    64 00002C64 C5C6C6C7C8C9C9CACB- <1>  db   -59,  -58,  -58,  -57,  -56,  -55,  -55,  -54,  -53,  -53,  -52,  -51,  -50,  -50,  -49,  -48 ; 960
    64 00002C6D CBCCCDCECECFD0      <1>
    65 00002C74 D0D1D2D3D3D4D5D6D6- <1>  db   -48,  -47,  -46,  -45,  -45,  -44,  -43,  -42,  -42,  -41,  -40,  -40,  -39,  -38,  -37,  -37 ; 976
    65 00002C7D D7D8D8D9DADBDB      <1>
    66 00002C84 DCDDDEDEDFE0E1E2E2- <1>  db   -36,  -35,  -34,  -34,  -33,  -32,  -31,  -30,  -30,  -29,  -28,  -27,  -27,  -26,  -25,  -24 ; 992
    66 00002C8D E3E4E5E5E6E7E8      <1>
    67 00002C94 E8E9EAEBEBECEDEEEF- <1>  db   -24,  -23,  -22,  -21,  -21,  -20,  -19,  -18,  -17,  -17,  -16,  -15,  -14,  -14,  -13,  -12 ; 1008
    67 00002C9D EFF0F1F2F2F3F4      <1>
    68 00002CA4 F5F6F6F7F8F9F9FAFB- <1>  db   -11,  -10,  -10,   -9,   -8,   -7,   -7,   -6,   -5,   -4,   -3,   -3,   -2,   -1,    0,    0 ; 1024
    68 00002CAD FCFDFDFEFF0000      <1>
  3108                                  
  3109 00002CB4 B8003C012200EB00C2-     PointList: dw 0b8h, 13ch, 22h, 0ebh, 0c2h, 016h, 0, 0
  3109 00002CBD 00160000000000     
  3110                                  
  3111 00002CC4 0000000007003F01C7-     PointList2: dw 0, 0, 7, 319, 199, 315, 0, 0
  3111 00002CCD 003B0100000000     
  3112                                  
  3113 00002CD4 00000000C7003F0132-     PointList3: dw 0,0, 199,319, 50,40, 0, 0 
  3113 00002CDD 00280000000000     
  3114                                  
  3115 00002CE4 05000A0000003F010A-     PointList4: dw 5,10, 0,319, 10,159, 0,0
  3115 00002CED 009F0000000000     
  3116 00002CF4 11000A000C003F0116-     PointList5: dw 17,10, 12,319, 22,159, 0,0
  3116 00002CFD 009F0000000000     
  3117 00002D04 1D000A0018003F0122-     PointList6: dw 29,10, 24,319, 34,159, 0,0
  3117 00002D0D 009F0000000000     
  3118 00002D14 29000A0024003F012E-     PointList7: dw 41,10, 36,319, 46,159, 0,0
  3118 00002D1D 009F0000000000     
  3119 00002D24 35000A0030003F013A-     PointList8: dw 53,10, 48,319, 58,159, 0,0
  3119 00002D2D 009F0000000000     
  3120 00002D34 41000A003C003F0146-     PointList9: dw 65,10, 60,319, 70,159, 0,0
  3120 00002D3D 009F0000000000     
  3121 00002D44 4D000A0048003F0152-     PointList10: dw 77,10, 72,319, 82,159, 0,0
  3121 00002D4D 009F0000000000     
  3122 00002D54 59000A0054003F015E-     PointList11: dw 89,10, 84,319, 94,159, 0,0
  3122 00002D5D 009F0000000000     
  3123 00002D64 65000A0060003F016A-     PointList12: dw 101,10, 96,319, 106,159, 0,0
  3123 00002D6D 009F0000000000     
  3124 00002D74 71000A006C003F0176-     PointList13: dw 113,10, 108,319, 118,159, 0,0
  3124 00002D7D 009F0000000000     
  3125 00002D84 7D000A0078003F0182-     PointList14: dw 125,10, 120,319, 130,159, 0,0
  3125 00002D8D 009F0000000000     
  3126 00002D94 89000A0084003F018E-     PointList15: dw 137,10, 132,319, 142,159, 0,0
  3126 00002D9D 009F0000000000     
  3127 00002DA4 95000A0090003F019A-     PointList16: dw 149,10, 144,319, 154,159, 0,0
  3127 00002DAD 009F0000000000     
  3128 00002DB4 A1000A009C003F01A6-     PointList17: dw 161,10, 156,319, 166,159, 0,0
  3128 00002DBD 009F0000000000     
  3129 00002DC4 AD000A00A8003F01B2-     PointList18: dw 173,10, 168,319, 178,159, 0,0
  3129 00002DCD 009F0000000000     
  3130 00002DD4 B5000A00B4003F01BE-     PointList19: dw 181,10, 180,319, 190,159, 0,0
  3130 00002DDD 009F0000000000     
  3131                                   
  3132 00002DE4 0100FFFFFFFF0100FF-     DirList:	dw 1,-1,-1,1,-1,1 
  3132 00002DED FF0100             
  3133 00002DF0 01000100                 dw	1,1
  3134 00002DF4 FFFF0100                 dw	-1,1
  3135 00002DF8 0100FFFF                 dw	1,-1
  3136 00002DFC 0100FFFF0100FFFF01-      dw 	+1,-1,+1,-1,+1,-1,+1,-1,+1,-1,+1,-1
  3136 00002E05 00FFFF0100FFFF0100-
  3136 00002E0E FFFF0100FFFF       
  3137                                  
  3138                                  ;FillJumpTable:	dw	0
  3139                                  
  3140                                  section .bss 	; put uninitialized data here
  3141 00000000 <res 194h>              BackBufferTable: 	resw 202 	; 200 screen lines as words
  3142 00000194 <res 8000h>             BackBuffer: 		resw 16384	; 2 screen buffers
  3143                                  
  3144 00008194 <res C80h>              EdgeTable	resd	800
  3145                                  
  3146                                  
  3147                                  
  3148                                  ObjectPointsResults:
  3149 00008E14 <res 100h>              ObjectYPos:	resw	128 ; 128 words - xpos
  3150 00008F14 <res 100h>              ObjectXPos:	resw	128 ; 128 words - ypos
  3151 00009014 <res 100h>              ObjectClipCode:	resw	128 ; 128 words - clip codes
  3152 00009114 <res 100h>              ObjectXRot:	resw	128 ; 128 words - x rotated points
  3153 00009214 <res 100h>              ObjectYRot:	resw	128 ; 128 words - y rotated points
  3154 00009314 <res 100h>              ObjectZRot:	resw	128 ; 128 words - z rotated points
  3155                                  
  3156 00009414 ????                    SinX:		resw	1
  3157 00009416 ????                    CosX:	resw	1
  3158 00009418 ????                    SinY:		resw	1
  3159 0000941A ????                    CosY:	resw	1
  3160 0000941C ????                    SinZ:		resw	1
  3161 0000941E ????                    CosZ:	resw	1
  3162                                  
  3163 00009420 ????                    XST		resw	1
  3164 00009422 ????                    YST		resw	1
  3165 00009424 ????                    XEN		resw	1
  3166 00009426 ????                    YEN		resw	1
  3167 00009428 ??                      CCST	resb	1
  3168 00009429 ??                      CCEN	resb	1
  3169                                  
  3170 0000942A ????                    XAngle:	resw	1
  3171 0000942C ????                    YAngle:	resw	1
  3172 0000942E ????                    ZAngle:	resw	1
  3173                                  
  3174 00009430 ??                      Exit:	resb	1
  3175                                  
  3176 00009431 ????                    STX:		resw	1
  3177 00009433 ????                    STY:		resw	1
  3178 00009435 ????                    STZ:		resw	1
  3179 00009437 ????                    ENX:		resw	1
  3180 00009439 ????                    ENY:		resw	1
  3181 0000943B ????                    ENZ:		resw	1
  3182                                  
  3183 0000943D ????                    Test0: 	resw	1
  3184 0000943F ????                    Test1: 	resw	1
  3185 00009441 ????                    Test2: 	resw	1
  3186 00009443 ????                    Test3: 	resw	1
  3187 00009445 ????                    Test4: 	resw	1
  3188 00009447 ????                    Test5: 	resw	1
  3189 00009449 ????                    Test6: 	resw	1
  3190 0000944B ????                    Test7: 	resw	1
  3191 0000944D ????                    Test8: 	resw	1
  3192 0000944F ????                    Test9: 	resw	1
  3193                                  
  3194 00009451 ????                    BackBufferSeg	resw	1	; pointer to the segment containing the back buffer
  3195                                  
  3196 00009453 ??                      Colour resb 1
